/*! jQuery v3.7.1 | (c) OpenJS Foundation and other contributors | jquery.org/license */(function(ct,ni){"use strict";typeof module=="object"&&typeof module.exports=="object"?module.exports=ct.document?ni(ct,!0):function(Xt){if(!Xt.document)throw new Error("jQuery requires a window with a document");return ni(Xt)}:ni(ct)})(typeof window<"u"?window:this,function(ct,ni){"use strict";var Xt=[],En=Object.getPrototypeOf,ge=Xt.slice,Jr=Xt.flat?function(s){return Xt.flat.call(s)}:function(s){return Xt.concat.apply([],s)},rn=Xt.push,qe=Xt.indexOf,Cn={},Kr=Cn.toString,sn=Cn.hasOwnProperty,Sn=sn.toString,on=Sn.call(Object),dt={},ft=function(s){return typeof s=="function"&&typeof s.nodeType!="number"&&typeof s.item!="function"},ri=function(s){return s!=null&&s===s.window},ut=ct.document,tr={type:!0,src:!0,nonce:!0,noModule:!0};function er(s,a,c){var f,m,v=(c=c||ut).createElement("script");if(v.text=s,a)for(f in tr)(m=a[f]||a.getAttribute&&a.getAttribute(f))&&v.setAttribute(f,m);c.head.appendChild(v).parentNode.removeChild(v)}function si(s){return s==null?s+"":typeof s=="object"||typeof s=="function"?Cn[Kr.call(s)]||"object":typeof s}var ir="3.7.1",Qs=/HTML$/i,p=function(s,a){return new p.fn.init(s,a)};function nr(s){var a=!!s&&"length"in s&&s.length,c=si(s);return!ft(s)&&!ri(s)&&(c==="array"||a===0||typeof a=="number"&&0<a&&a-1 in s)}function It(s,a){return s.nodeName&&s.nodeName.toLowerCase()===a.toLowerCase()}p.fn=p.prototype={jquery:ir,constructor:p,length:0,toArray:function(){return ge.call(this)},get:function(s){return s==null?ge.call(this):s<0?this[s+this.length]:this[s]},pushStack:function(s){var a=p.merge(this.constructor(),s);return a.prevObject=this,a},each:function(s){return p.each(this,s)},map:function(s){return this.pushStack(p.map(this,function(a,c){return s.call(a,c,a)}))},slice:function(){return this.pushStack(ge.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(p.grep(this,function(s,a){return(a+1)%2}))},odd:function(){return this.pushStack(p.grep(this,function(s,a){return a%2}))},eq:function(s){var a=this.length,c=+s+(s<0?a:0);return this.pushStack(0<=c&&c<a?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:rn,sort:Xt.sort,splice:Xt.splice},p.extend=p.fn.extend=function(){var s,a,c,f,m,v,x=arguments[0]||{},D=1,A=arguments.length,O=!1;for(typeof x=="boolean"&&(O=x,x=arguments[D]||{},D++),typeof x=="object"||ft(x)||(x={}),D===A&&(x=this,D--);D<A;D++)if((s=arguments[D])!=null)for(a in s)f=s[a],a!=="__proto__"&&x!==f&&(O&&f&&(p.isPlainObject(f)||(m=Array.isArray(f)))?(c=x[a],v=m&&!Array.isArray(c)?[]:m||p.isPlainObject(c)?c:{},m=!1,x[a]=p.extend(O,v,f)):f!==void 0&&(x[a]=f));return x},p.extend({expando:"jQuery"+(ir+Math.random()).replace(/\D/g,""),isReady:!0,error:function(s){throw new Error(s)},noop:function(){},isPlainObject:function(s){var a,c;return!(!s||Kr.call(s)!=="[object Object]")&&(!(a=En(s))||typeof(c=sn.call(a,"constructor")&&a.constructor)=="function"&&Sn.call(c)===on)},isEmptyObject:function(s){var a;for(a in s)return!1;return!0},globalEval:function(s,a,c){er(s,{nonce:a&&a.nonce},c)},each:function(s,a){var c,f=0;if(nr(s))for(c=s.length;f<c&&a.call(s[f],f,s[f])!==!1;f++);else for(f in s)if(a.call(s[f],f,s[f])===!1)break;return s},text:function(s){var a,c="",f=0,m=s.nodeType;if(!m)for(;a=s[f++];)c+=p.text(a);return m===1||m===11?s.textContent:m===9?s.documentElement.textContent:m===3||m===4?s.nodeValue:c},makeArray:function(s,a){var c=a||[];return s!=null&&(nr(Object(s))?p.merge(c,typeof s=="string"?[s]:s):rn.call(c,s)),c},inArray:function(s,a,c){return a==null?-1:qe.call(a,s,c)},isXMLDoc:function(s){var a=s&&s.namespaceURI,c=s&&(s.ownerDocument||s).documentElement;return!Qs.test(a||c&&c.nodeName||"HTML")},merge:function(s,a){for(var c=+a.length,f=0,m=s.length;f<c;f++)s[m++]=a[f];return s.length=m,s},grep:function(s,a,c){for(var f=[],m=0,v=s.length,x=!c;m<v;m++)!a(s[m],m)!==x&&f.push(s[m]);return f},map:function(s,a,c){var f,m,v=0,x=[];if(nr(s))for(f=s.length;v<f;v++)(m=a(s[v],v,c))!=null&&x.push(m);else for(v in s)(m=a(s[v],v,c))!=null&&x.push(m);return Jr(x)},guid:1,support:dt}),typeof Symbol=="function"&&(p.fn[Symbol.iterator]=Xt[Symbol.iterator]),p.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(s,a){Cn["[object "+a+"]"]=a.toLowerCase()});var Qr=Xt.pop,ts=Xt.sort,es=Xt.splice,_t="[\\x20\\t\\r\\n\\f]",Pi=new RegExp("^"+_t+"+|((?:^|[^\\\\])(?:\\\\.)*)"+_t+"+$","g");p.contains=function(s,a){var c=a&&a.parentNode;return s===c||!(!c||c.nodeType!==1||!(s.contains?s.contains(c):s.compareDocumentPosition&&16&s.compareDocumentPosition(c)))};var to=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function eo(s,a){return a?s==="\0"?"\uFFFD":s.slice(0,-1)+"\\"+s.charCodeAt(s.length-1).toString(16)+" ":"\\"+s}p.escapeSelector=function(s){return(s+"").replace(to,eo)};var We=ut,rr=rn;(function(){var s,a,c,f,m,v,x,D,A,O,M=rr,L=p.expando,E=0,z=0,Y=st(),tt=st(),nt=st(),Pt=st(),Gt=function(w,R){return w===R&&(m=!0),0},de="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",gt="(?:\\\\[\\da-fA-F]{1,6}"+_t+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",bt="\\["+_t+"*("+gt+")(?:"+_t+"*([*^$|!~]?=)"+_t+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+gt+"))|)"+_t+"*\\]",Te=":("+gt+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+bt+")*)|.*)\\)|)",Tt=new RegExp(_t+"+","g"),Mt=new RegExp("^"+_t+"*,"+_t+"*"),Ei=new RegExp("^"+_t+"*([>+~]|"+_t+")"+_t+"*"),Ln=new RegExp(_t+"|>"),De=new RegExp(Te),Fe=new RegExp("^"+gt+"$"),ue={ID:new RegExp("^#("+gt+")"),CLASS:new RegExp("^\\.("+gt+")"),TAG:new RegExp("^("+gt+"|[*])"),ATTR:new RegExp("^"+bt),PSEUDO:new RegExp("^"+Te),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+_t+"*(even|odd|(([+-]|)(\\d*)n|)"+_t+"*(?:([+-]|)"+_t+"*(\\d+)|))"+_t+"*\\)|)","i"),bool:new RegExp("^(?:"+de+")$","i"),needsContext:new RegExp("^"+_t+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+_t+"*((?:-\\d)?\\d*)"+_t+"*\\)|)(?=[^-]|$)","i")},ci=/^(?:input|select|textarea|button)$/i,Xi=/^h\d$/i,Ie=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rt=/[+~]/,Ot=new RegExp("\\\\[\\da-fA-F]{1,6}"+_t+"?|\\\\([^\\r\\n\\f])","g"),se=function(w,R){var B="0x"+w.slice(1)-65536;return R||(B<0?String.fromCharCode(B+65536):String.fromCharCode(B>>10|55296,1023&B|56320))},$t=function(){$e()},oe=Le(function(w){return w.disabled===!0&&It(w,"fieldset")},{dir:"parentNode",next:"legend"});try{M.apply(Xt=ge.call(We.childNodes),We.childNodes),Xt[We.childNodes.length].nodeType}catch{M={apply:function(R,B){rr.apply(R,ge.call(B))},call:function(R){rr.apply(R,ge.call(arguments,1))}}}function it(w,R,B,j){var q,Q,K,et,Z,Et,ht,lt=R&&R.ownerDocument,wt=R?R.nodeType:9;if(B=B||[],typeof w!="string"||!w||wt!==1&&wt!==9&&wt!==11)return B;if(!j&&($e(R),R=R||v,D)){if(wt!==11&&(Z=Ie.exec(w)))if(q=Z[1]){if(wt===9){if(!(K=R.getElementById(q)))return B;if(K.id===q)return M.call(B,K),B}else if(lt&&(K=lt.getElementById(q))&&it.contains(R,K)&&K.id===q)return M.call(B,K),B}else{if(Z[2])return M.apply(B,R.getElementsByTagName(w)),B;if((q=Z[3])&&R.getElementsByClassName)return M.apply(B,R.getElementsByClassName(q)),B}if(!(Pt[w+" "]||A&&A.test(w))){if(ht=w,lt=R,wt===1&&(Ln.test(w)||Ei.test(w))){for((lt=rt.test(w)&&Hn(R.parentNode)||R)==R&&dt.scope||((et=R.getAttribute("id"))?et=p.escapeSelector(et):R.setAttribute("id",et=L)),Q=(Et=mn(w)).length;Q--;)Et[Q]=(et?"#"+et:":scope")+" "+Si(Et[Q]);ht=Et.join(",")}try{return M.apply(B,lt.querySelectorAll(ht)),B}catch{Pt(w,!0)}finally{et===L&&R.removeAttribute("id")}}}return qn(w.replace(Pi,"$1"),R,B,j)}function st(){var w=[];return function R(B,j){return w.push(B+" ")>a.cacheLength&&delete R[w.shift()],R[B+" "]=j}}function xt(w){return w[L]=!0,w}function At(w){var R=v.createElement("fieldset");try{return!!w(R)}catch{return!1}finally{R.parentNode&&R.parentNode.removeChild(R),R=null}}function Oe(w){return function(R){return It(R,"input")&&R.type===w}}function Ci(w){return function(R){return(It(R,"input")||It(R,"button"))&&R.type===w}}function zn(w){return function(R){return"form"in R?R.parentNode&&R.disabled===!1?"label"in R?"label"in R.parentNode?R.parentNode.disabled===w:R.disabled===w:R.isDisabled===w||R.isDisabled!==!w&&oe(R)===w:R.disabled===w:"label"in R&&R.disabled===w}}function fe(w){return xt(function(R){return R=+R,xt(function(B,j){for(var q,Q=w([],B.length,R),K=Q.length;K--;)B[q=Q[K]]&&(B[q]=!(j[q]=B[q]))})})}function Hn(w){return w&&typeof w.getElementsByTagName<"u"&&w}function $e(w){var R,B=w?w.ownerDocument||w:We;return B!=v&&B.nodeType===9&&B.documentElement&&(x=(v=B).documentElement,D=!p.isXMLDoc(v),O=x.matches||x.webkitMatchesSelector||x.msMatchesSelector,x.msMatchesSelector&&We!=v&&(R=v.defaultView)&&R.top!==R&&R.addEventListener("unload",$t),dt.getById=At(function(j){return x.appendChild(j).id=p.expando,!v.getElementsByName||!v.getElementsByName(p.expando).length}),dt.disconnectedMatch=At(function(j){return O.call(j,"*")}),dt.scope=At(function(){return v.querySelectorAll(":scope")}),dt.cssHas=At(function(){try{return v.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),dt.getById?(a.filter.ID=function(j){var q=j.replace(Ot,se);return function(Q){return Q.getAttribute("id")===q}},a.find.ID=function(j,q){if(typeof q.getElementById<"u"&&D){var Q=q.getElementById(j);return Q?[Q]:[]}}):(a.filter.ID=function(j){var q=j.replace(Ot,se);return function(Q){var K=typeof Q.getAttributeNode<"u"&&Q.getAttributeNode("id");return K&&K.value===q}},a.find.ID=function(j,q){if(typeof q.getElementById<"u"&&D){var Q,K,et,Z=q.getElementById(j);if(Z){if((Q=Z.getAttributeNode("id"))&&Q.value===j)return[Z];for(et=q.getElementsByName(j),K=0;Z=et[K++];)if((Q=Z.getAttributeNode("id"))&&Q.value===j)return[Z]}return[]}}),a.find.TAG=function(j,q){return typeof q.getElementsByTagName<"u"?q.getElementsByTagName(j):q.querySelectorAll(j)},a.find.CLASS=function(j,q){if(typeof q.getElementsByClassName<"u"&&D)return q.getElementsByClassName(j)},A=[],At(function(j){var q;x.appendChild(j).innerHTML="<a id='"+L+"' href='' disabled='disabled'></a><select id='"+L+"-\r\\' disabled='disabled'><option selected=''></option></select>",j.querySelectorAll("[selected]").length||A.push("\\["+_t+"*(?:value|"+de+")"),j.querySelectorAll("[id~="+L+"-]").length||A.push("~="),j.querySelectorAll("a#"+L+"+*").length||A.push(".#.+[+~]"),j.querySelectorAll(":checked").length||A.push(":checked"),(q=v.createElement("input")).setAttribute("type","hidden"),j.appendChild(q).setAttribute("name","D"),x.appendChild(j).disabled=!0,j.querySelectorAll(":disabled").length!==2&&A.push(":enabled",":disabled"),(q=v.createElement("input")).setAttribute("name",""),j.appendChild(q),j.querySelectorAll("[name='']").length||A.push("\\["+_t+"*name"+_t+"*="+_t+`*(?:''|"")`)}),dt.cssHas||A.push(":has"),A=A.length&&new RegExp(A.join("|")),Gt=function(j,q){if(j===q)return m=!0,0;var Q=!j.compareDocumentPosition-!q.compareDocumentPosition;return Q||(1&(Q=(j.ownerDocument||j)==(q.ownerDocument||q)?j.compareDocumentPosition(q):1)||!dt.sortDetached&&q.compareDocumentPosition(j)===Q?j===v||j.ownerDocument==We&&it.contains(We,j)?-1:q===v||q.ownerDocument==We&&it.contains(We,q)?1:f?qe.call(f,j)-qe.call(f,q):0:4&Q?-1:1)}),v}for(s in it.matches=function(w,R){return it(w,null,null,R)},it.matchesSelector=function(w,R){if($e(w),D&&!Pt[R+" "]&&(!A||!A.test(R)))try{var B=O.call(w,R);if(B||dt.disconnectedMatch||w.document&&w.document.nodeType!==11)return B}catch{Pt(R,!0)}return 0<it(R,v,null,[w]).length},it.contains=function(w,R){return(w.ownerDocument||w)!=v&&$e(w),p.contains(w,R)},it.attr=function(w,R){(w.ownerDocument||w)!=v&&$e(w);var B=a.attrHandle[R.toLowerCase()],j=B&&sn.call(a.attrHandle,R.toLowerCase())?B(w,R,!D):void 0;return j!==void 0?j:w.getAttribute(R)},it.error=function(w){throw new Error("Syntax error, unrecognized expression: "+w)},p.uniqueSort=function(w){var R,B=[],j=0,q=0;if(m=!dt.sortStable,f=!dt.sortStable&&ge.call(w,0),ts.call(w,Gt),m){for(;R=w[q++];)R===w[q]&&(j=B.push(q));for(;j--;)es.call(w,B[j],1)}return f=null,w},p.fn.uniqueSort=function(){return this.pushStack(p.uniqueSort(ge.apply(this)))},(a=p.expr={cacheLength:50,createPseudo:xt,match:ue,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(w){return w[1]=w[1].replace(Ot,se),w[3]=(w[3]||w[4]||w[5]||"").replace(Ot,se),w[2]==="~="&&(w[3]=" "+w[3]+" "),w.slice(0,4)},CHILD:function(w){return w[1]=w[1].toLowerCase(),w[1].slice(0,3)==="nth"?(w[3]||it.error(w[0]),w[4]=+(w[4]?w[5]+(w[6]||1):2*(w[3]==="even"||w[3]==="odd")),w[5]=+(w[7]+w[8]||w[3]==="odd")):w[3]&&it.error(w[0]),w},PSEUDO:function(w){var R,B=!w[6]&&w[2];return ue.CHILD.test(w[0])?null:(w[3]?w[2]=w[4]||w[5]||"":B&&De.test(B)&&(R=mn(B,!0))&&(R=B.indexOf(")",B.length-R)-B.length)&&(w[0]=w[0].slice(0,R),w[2]=B.slice(0,R)),w.slice(0,3))}},filter:{TAG:function(w){var R=w.replace(Ot,se).toLowerCase();return w==="*"?function(){return!0}:function(B){return It(B,R)}},CLASS:function(w){var R=Y[w+" "];return R||(R=new RegExp("(^|"+_t+")"+w+"("+_t+"|$)"))&&Y(w,function(B){return R.test(typeof B.className=="string"&&B.className||typeof B.getAttribute<"u"&&B.getAttribute("class")||"")})},ATTR:function(w,R,B){return function(j){var q=it.attr(j,w);return q==null?R==="!=":!R||(q+="",R==="="?q===B:R==="!="?q!==B:R==="^="?B&&q.indexOf(B)===0:R==="*="?B&&-1<q.indexOf(B):R==="$="?B&&q.slice(-B.length)===B:R==="~="?-1<(" "+q.replace(Tt," ")+" ").indexOf(B):R==="|="&&(q===B||q.slice(0,B.length+1)===B+"-"))}},CHILD:function(w,R,B,j,q){var Q=w.slice(0,3)!=="nth",K=w.slice(-4)!=="last",et=R==="of-type";return j===1&&q===0?function(Z){return!!Z.parentNode}:function(Z,Et,ht){var lt,wt,ot,Zt,te,yt=Q!==K?"nextSibling":"previousSibling",mt=Z.parentNode,Jt=et&&Z.nodeName.toLowerCase(),pe=!ht&&!et,Nt=!1;if(mt){if(Q){for(;yt;){for(ot=Z;ot=ot[yt];)if(et?It(ot,Jt):ot.nodeType===1)return!1;te=yt=w==="only"&&!te&&"nextSibling"}return!0}if(te=[K?mt.firstChild:mt.lastChild],K&&pe){for(Nt=(Zt=(lt=(wt=mt[L]||(mt[L]={}))[w]||[])[0]===E&&lt[1])&&lt[2],ot=Zt&&mt.childNodes[Zt];ot=++Zt&&ot&&ot[yt]||(Nt=Zt=0)||te.pop();)if(ot.nodeType===1&&++Nt&&ot===Z){wt[w]=[E,Zt,Nt];break}}else if(pe&&(Nt=Zt=(lt=(wt=Z[L]||(Z[L]={}))[w]||[])[0]===E&&lt[1]),Nt===!1)for(;(ot=++Zt&&ot&&ot[yt]||(Nt=Zt=0)||te.pop())&&!((et?It(ot,Jt):ot.nodeType===1)&&++Nt&&(pe&&((wt=ot[L]||(ot[L]={}))[w]=[E,Nt]),ot===Z)););return(Nt-=q)===j||Nt%j==0&&0<=Nt/j}}},PSEUDO:function(w,R){var B,j=a.pseudos[w]||a.setFilters[w.toLowerCase()]||it.error("unsupported pseudo: "+w);return j[L]?j(R):1<j.length?(B=[w,w,"",R],a.setFilters.hasOwnProperty(w.toLowerCase())?xt(function(q,Q){for(var K,et=j(q,R),Z=et.length;Z--;)q[K=qe.call(q,et[Z])]=!(Q[K]=et[Z])}):function(q){return j(q,0,B)}):j}},pseudos:{not:xt(function(w){var R=[],B=[],j=Gn(w.replace(Pi,"$1"));return j[L]?xt(function(q,Q,K,et){for(var Z,Et=j(q,null,et,[]),ht=q.length;ht--;)(Z=Et[ht])&&(q[ht]=!(Q[ht]=Z))}):function(q,Q,K){return R[0]=q,j(R,null,K,B),R[0]=null,!B.pop()}}),has:xt(function(w){return function(R){return 0<it(w,R).length}}),contains:xt(function(w){return w=w.replace(Ot,se),function(R){return-1<(R.textContent||p.text(R)).indexOf(w)}}),lang:xt(function(w){return Fe.test(w||"")||it.error("unsupported lang: "+w),w=w.replace(Ot,se).toLowerCase(),function(R){var B;do if(B=D?R.lang:R.getAttribute("xml:lang")||R.getAttribute("lang"))return(B=B.toLowerCase())===w||B.indexOf(w+"-")===0;while((R=R.parentNode)&&R.nodeType===1);return!1}}),target:function(w){var R=ct.location&&ct.location.hash;return R&&R.slice(1)===w.id},root:function(w){return w===x},focus:function(w){return w===function(){try{return v.activeElement}catch{}}()&&v.hasFocus()&&!!(w.type||w.href||~w.tabIndex)},enabled:zn(!1),disabled:zn(!0),checked:function(w){return It(w,"input")&&!!w.checked||It(w,"option")&&!!w.selected},selected:function(w){return w.parentNode&&w.parentNode.selectedIndex,w.selected===!0},empty:function(w){for(w=w.firstChild;w;w=w.nextSibling)if(w.nodeType<6)return!1;return!0},parent:function(w){return!a.pseudos.empty(w)},header:function(w){return Xi.test(w.nodeName)},input:function(w){return ci.test(w.nodeName)},button:function(w){return It(w,"input")&&w.type==="button"||It(w,"button")},text:function(w){var R;return It(w,"input")&&w.type==="text"&&((R=w.getAttribute("type"))==null||R.toLowerCase()==="text")},first:fe(function(){return[0]}),last:fe(function(w,R){return[R-1]}),eq:fe(function(w,R,B){return[B<0?B+R:B]}),even:fe(function(w,R){for(var B=0;B<R;B+=2)w.push(B);return w}),odd:fe(function(w,R){for(var B=1;B<R;B+=2)w.push(B);return w}),lt:fe(function(w,R,B){var j;for(j=B<0?B+R:R<B?R:B;0<=--j;)w.push(j);return w}),gt:fe(function(w,R,B){for(var j=B<0?B+R:B;++j<R;)w.push(j);return w})}}).pseudos.nth=a.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})a.pseudos[s]=Oe(s);for(s in{submit:!0,reset:!0})a.pseudos[s]=Ci(s);function Ms(){}function mn(w,R){var B,j,q,Q,K,et,Z,Et=tt[w+" "];if(Et)return R?0:Et.slice(0);for(K=w,et=[],Z=a.preFilter;K;){for(Q in B&&!(j=Mt.exec(K))||(j&&(K=K.slice(j[0].length)||K),et.push(q=[])),B=!1,(j=Ei.exec(K))&&(B=j.shift(),q.push({value:B,type:j[0].replace(Pi," ")}),K=K.slice(B.length)),a.filter)!(j=ue[Q].exec(K))||Z[Q]&&!(j=Z[Q](j))||(B=j.shift(),q.push({value:B,type:Q,matches:j}),K=K.slice(B.length));if(!B)break}return R?K.length:K?it.error(w):tt(w,et).slice(0)}function Si(w){for(var R=0,B=w.length,j="";R<B;R++)j+=w[R].value;return j}function Le(w,R,B){var j=R.dir,q=R.next,Q=q||j,K=B&&Q==="parentNode",et=z++;return R.first?function(Z,Et,ht){for(;Z=Z[j];)if(Z.nodeType===1||K)return w(Z,Et,ht);return!1}:function(Z,Et,ht){var lt,wt,ot=[E,et];if(ht){for(;Z=Z[j];)if((Z.nodeType===1||K)&&w(Z,Et,ht))return!0}else for(;Z=Z[j];)if(Z.nodeType===1||K)if(wt=Z[L]||(Z[L]={}),q&&It(Z,q))Z=Z[j]||Z;else{if((lt=wt[Q])&&lt[0]===E&&lt[1]===et)return ot[2]=lt[2];if((wt[Q]=ot)[2]=w(Z,Et,ht))return!0}return!1}}function Mr(w){return 1<w.length?function(R,B,j){for(var q=w.length;q--;)if(!w[q](R,B,j))return!1;return!0}:w[0]}function Mi(w,R,B,j,q){for(var Q,K=[],et=0,Z=w.length,Et=R!=null;et<Z;et++)(Q=w[et])&&(B&&!B(Q,j,q)||(K.push(Q),Et&&R.push(et)));return K}function Bt(w,R,B,j,q,Q){return j&&!j[L]&&(j=Bt(j)),q&&!q[L]&&(q=Bt(q,Q)),xt(function(K,et,Z,Et){var ht,lt,wt,ot,Zt=[],te=[],yt=et.length,mt=K||function(pe,Nt,Je){for(var Ft=0,Kt=Nt.length;Ft<Kt;Ft++)it(pe,Nt[Ft],Je);return Je}(R||"*",Z.nodeType?[Z]:Z,[]),Jt=!w||!K&&R?mt:Mi(mt,Zt,w,Z,Et);if(B?B(Jt,ot=q||(K?w:yt||j)?[]:et,Z,Et):ot=Jt,j)for(ht=Mi(ot,te),j(ht,[],Z,Et),lt=ht.length;lt--;)(wt=ht[lt])&&(ot[te[lt]]=!(Jt[te[lt]]=wt));if(K){if(q||w){if(q){for(ht=[],lt=ot.length;lt--;)(wt=ot[lt])&&ht.push(Jt[lt]=wt);q(null,ot=[],ht,Et)}for(lt=ot.length;lt--;)(wt=ot[lt])&&-1<(ht=q?qe.call(K,wt):Zt[lt])&&(K[ht]=!(et[ht]=wt))}}else ot=Mi(ot===et?ot.splice(yt,ot.length):ot),q?q(null,et,ot,Et):M.apply(et,ot)})}function qt(w){for(var R,B,j,q=w.length,Q=a.relative[w[0].type],K=Q||a.relative[" "],et=Q?1:0,Z=Le(function(lt){return lt===R},K,!0),Et=Le(function(lt){return-1<qe.call(R,lt)},K,!0),ht=[function(lt,wt,ot){var Zt=!Q&&(ot||wt!=c)||((R=wt).nodeType?Z(lt,wt,ot):Et(lt,wt,ot));return R=null,Zt}];et<q;et++)if(B=a.relative[w[et].type])ht=[Le(Mr(ht),B)];else{if((B=a.filter[w[et].type].apply(null,w[et].matches))[L]){for(j=++et;j<q&&!a.relative[w[j].type];j++);return Bt(1<et&&Mr(ht),1<et&&Si(w.slice(0,et-1).concat({value:w[et-2].type===" "?"*":""})).replace(Pi,"$1"),B,et<j&&qt(w.slice(et,j)),j<q&&qt(w=w.slice(j)),j<q&&Si(w))}ht.push(B)}return Mr(ht)}function Gn(w,R){var B,j,q,Q,K,et,Z=[],Et=[],ht=nt[w+" "];if(!ht){for(R||(R=mn(w)),B=R.length;B--;)(ht=qt(R[B]))[L]?Z.push(ht):Et.push(ht);(ht=nt(w,(j=Et,Q=0<(q=Z).length,K=0<j.length,et=function(lt,wt,ot,Zt,te){var yt,mt,Jt,pe=0,Nt="0",Je=lt&&[],Ft=[],Kt=c,Ke=lt||K&&a.find.TAG("*",te),ae=E+=Kt==null?1:Math.random()||.1,Ao=Ke.length;for(te&&(c=wt==v||wt||te);Nt!==Ao&&(yt=Ke[Nt])!=null;Nt++){if(K&&yt){for(mt=0,wt||yt.ownerDocument==v||($e(yt),ot=!D);Jt=j[mt++];)if(Jt(yt,wt||v,ot)){M.call(Zt,yt);break}te&&(E=ae)}Q&&((yt=!Jt&&yt)&&pe--,lt&&Je.push(yt))}if(pe+=Nt,Q&&Nt!==pe){for(mt=0;Jt=q[mt++];)Jt(Je,Ft,wt,ot);if(lt){if(0<pe)for(;Nt--;)Je[Nt]||Ft[Nt]||(Ft[Nt]=Qr.call(Zt));Ft=Mi(Ft)}M.apply(Zt,Ft),te&&!lt&&0<Ft.length&&1<pe+q.length&&p.uniqueSort(Zt)}return te&&(E=ae,c=Kt),Je},Q?xt(et):et))).selector=w}return ht}function qn(w,R,B,j){var q,Q,K,et,Z,Et=typeof w=="function"&&w,ht=!j&&mn(w=Et.selector||w);if(B=B||[],ht.length===1){if(2<(Q=ht[0]=ht[0].slice(0)).length&&(K=Q[0]).type==="ID"&&R.nodeType===9&&D&&a.relative[Q[1].type]){if(!(R=(a.find.ID(K.matches[0].replace(Ot,se),R)||[])[0]))return B;Et&&(R=R.parentNode),w=w.slice(Q.shift().value.length)}for(q=ue.needsContext.test(w)?0:Q.length;q--&&(K=Q[q],!a.relative[et=K.type]);)if((Z=a.find[et])&&(j=Z(K.matches[0].replace(Ot,se),rt.test(Q[0].type)&&Hn(R.parentNode)||R))){if(Q.splice(q,1),!(w=j.length&&Si(Q)))return M.apply(B,j),B;break}}return(Et||Gn(w,ht))(j,R,!D,B,!R||rt.test(w)&&Hn(R.parentNode)||R),B}Ms.prototype=a.filters=a.pseudos,a.setFilters=new Ms,dt.sortStable=L.split("").sort(Gt).join("")===L,$e(),dt.sortDetached=At(function(w){return 1&w.compareDocumentPosition(v.createElement("fieldset"))}),p.find=it,p.expr[":"]=p.expr.pseudos,p.unique=p.uniqueSort,it.compile=Gn,it.select=qn,it.setDocument=$e,it.tokenize=mn,it.escape=p.escapeSelector,it.getText=p.text,it.isXML=p.isXMLDoc,it.selectors=p.expr,it.support=p.support,it.uniqueSort=p.uniqueSort})();var Bi=function(s,a,c){for(var f=[],m=c!==void 0;(s=s[a])&&s.nodeType!==9;)if(s.nodeType===1){if(m&&p(s).is(c))break;f.push(s)}return f},is=function(s,a){for(var c=[];s;s=s.nextSibling)s.nodeType===1&&s!==a&&c.push(s);return c},ns=p.expr.match.needsContext,sr=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Mn(s,a,c){return ft(a)?p.grep(s,function(f,m){return!!a.call(f,m,f)!==c}):a.nodeType?p.grep(s,function(f){return f===a!==c}):typeof a!="string"?p.grep(s,function(f){return-1<qe.call(a,f)!==c}):p.filter(a,s,c)}p.filter=function(s,a,c){var f=a[0];return c&&(s=":not("+s+")"),a.length===1&&f.nodeType===1?p.find.matchesSelector(f,s)?[f]:[]:p.find.matches(s,p.grep(a,function(m){return m.nodeType===1}))},p.fn.extend({find:function(s){var a,c,f=this.length,m=this;if(typeof s!="string")return this.pushStack(p(s).filter(function(){for(a=0;a<f;a++)if(p.contains(m[a],this))return!0}));for(c=this.pushStack([]),a=0;a<f;a++)p.find(s,m[a],c);return 1<f?p.uniqueSort(c):c},filter:function(s){return this.pushStack(Mn(this,s||[],!1))},not:function(s){return this.pushStack(Mn(this,s||[],!0))},is:function(s){return!!Mn(this,typeof s=="string"&&ns.test(s)?p(s):s||[],!1).length}});var rs,or=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(p.fn.init=function(s,a,c){var f,m;if(!s)return this;if(c=c||rs,typeof s=="string"){if(!(f=s[0]==="<"&&s[s.length-1]===">"&&3<=s.length?[null,s,null]:or.exec(s))||!f[1]&&a)return!a||a.jquery?(a||c).find(s):this.constructor(a).find(s);if(f[1]){if(a=a instanceof p?a[0]:a,p.merge(this,p.parseHTML(f[1],a&&a.nodeType?a.ownerDocument||a:ut,!0)),sr.test(f[1])&&p.isPlainObject(a))for(f in a)ft(this[f])?this[f](a[f]):this.attr(f,a[f]);return this}return(m=ut.getElementById(f[2]))&&(this[0]=m,this.length=1),this}return s.nodeType?(this[0]=s,this.length=1,this):ft(s)?c.ready!==void 0?c.ready(s):s(p):p.makeArray(s,this)}).prototype=p.fn,rs=p(ut);var ss=/^(?:parents|prev(?:Until|All))/,os={children:!0,contents:!0,next:!0,prev:!0};function as(s,a){for(;(s=s[a])&&s.nodeType!==1;);return s}p.fn.extend({has:function(s){var a=p(s,this),c=a.length;return this.filter(function(){for(var f=0;f<c;f++)if(p.contains(this,a[f]))return!0})},closest:function(s,a){var c,f=0,m=this.length,v=[],x=typeof s!="string"&&p(s);if(!ns.test(s)){for(;f<m;f++)for(c=this[f];c&&c!==a;c=c.parentNode)if(c.nodeType<11&&(x?-1<x.index(c):c.nodeType===1&&p.find.matchesSelector(c,s))){v.push(c);break}}return this.pushStack(1<v.length?p.uniqueSort(v):v)},index:function(s){return s?typeof s=="string"?qe.call(p(s),this[0]):qe.call(this,s.jquery?s[0]:s):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(s,a){return this.pushStack(p.uniqueSort(p.merge(this.get(),p(s,a))))},addBack:function(s){return this.add(s==null?this.prevObject:this.prevObject.filter(s))}}),p.each({parent:function(s){var a=s.parentNode;return a&&a.nodeType!==11?a:null},parents:function(s){return Bi(s,"parentNode")},parentsUntil:function(s,a,c){return Bi(s,"parentNode",c)},next:function(s){return as(s,"nextSibling")},prev:function(s){return as(s,"previousSibling")},nextAll:function(s){return Bi(s,"nextSibling")},prevAll:function(s){return Bi(s,"previousSibling")},nextUntil:function(s,a,c){return Bi(s,"nextSibling",c)},prevUntil:function(s,a,c){return Bi(s,"previousSibling",c)},siblings:function(s){return is((s.parentNode||{}).firstChild,s)},children:function(s){return is(s.firstChild)},contents:function(s){return s.contentDocument!=null&&En(s.contentDocument)?s.contentDocument:(It(s,"template")&&(s=s.content||s),p.merge([],s.childNodes))}},function(s,a){p.fn[s]=function(c,f){var m=p.map(this,a,c);return s.slice(-5)!=="Until"&&(f=c),f&&typeof f=="string"&&(m=p.filter(f,m)),1<this.length&&(os[s]||p.uniqueSort(m),ss.test(s)&&m.reverse()),this.pushStack(m)}});var Pe=/[^\x20\t\r\n\f]+/g;function _i(s){return s}function xi(s){throw s}function kn(s,a,c,f){var m;try{s&&ft(m=s.promise)?m.call(s).done(a).fail(c):s&&ft(m=s.then)?m.call(s,a,c):a.apply(void 0,[s].slice(f))}catch(v){c.apply(void 0,[v])}}p.Callbacks=function(s){var a,c;s=typeof s=="string"?(a=s,c={},p.each(a.match(Pe)||[],function(E,z){c[z]=!0}),c):p.extend({},s);var f,m,v,x,D=[],A=[],O=-1,M=function(){for(x=x||s.once,v=f=!0;A.length;O=-1)for(m=A.shift();++O<D.length;)D[O].apply(m[0],m[1])===!1&&s.stopOnFalse&&(O=D.length,m=!1);s.memory||(m=!1),f=!1,x&&(D=m?[]:"")},L={add:function(){return D&&(m&&!f&&(O=D.length-1,A.push(m)),function E(z){p.each(z,function(Y,tt){ft(tt)?s.unique&&L.has(tt)||D.push(tt):tt&&tt.length&&si(tt)!=="string"&&E(tt)})}(arguments),m&&!f&&M()),this},remove:function(){return p.each(arguments,function(E,z){for(var Y;-1<(Y=p.inArray(z,D,Y));)D.splice(Y,1),Y<=O&&O--}),this},has:function(E){return E?-1<p.inArray(E,D):0<D.length},empty:function(){return D&&(D=[]),this},disable:function(){return x=A=[],D=m="",this},disabled:function(){return!D},lock:function(){return x=A=[],m||f||(D=m=""),this},locked:function(){return!!x},fireWith:function(E,z){return x||(z=[E,(z=z||[]).slice?z.slice():z],A.push(z),f||M()),this},fire:function(){return L.fireWith(this,arguments),this},fired:function(){return!!v}};return L},p.extend({Deferred:function(s){var a=[["notify","progress",p.Callbacks("memory"),p.Callbacks("memory"),2],["resolve","done",p.Callbacks("once memory"),p.Callbacks("once memory"),0,"resolved"],["reject","fail",p.Callbacks("once memory"),p.Callbacks("once memory"),1,"rejected"]],c="pending",f={state:function(){return c},always:function(){return m.done(arguments).fail(arguments),this},catch:function(v){return f.then(null,v)},pipe:function(){var v=arguments;return p.Deferred(function(x){p.each(a,function(D,A){var O=ft(v[A[4]])&&v[A[4]];m[A[1]](function(){var M=O&&O.apply(this,arguments);M&&ft(M.promise)?M.promise().progress(x.notify).done(x.resolve).fail(x.reject):x[A[0]+"With"](this,O?[M]:arguments)})}),v=null}).promise()},then:function(v,x,D){var A=0;function O(M,L,E,z){return function(){var Y=this,tt=arguments,nt=function(){var Gt,de;if(!(M<A)){if((Gt=E.apply(Y,tt))===L.promise())throw new TypeError("Thenable self-resolution");de=Gt&&(typeof Gt=="object"||typeof Gt=="function")&&Gt.then,ft(de)?z?de.call(Gt,O(A,L,_i,z),O(A,L,xi,z)):(A++,de.call(Gt,O(A,L,_i,z),O(A,L,xi,z),O(A,L,_i,L.notifyWith))):(E!==_i&&(Y=void 0,tt=[Gt]),(z||L.resolveWith)(Y,tt))}},Pt=z?nt:function(){try{nt()}catch(Gt){p.Deferred.exceptionHook&&p.Deferred.exceptionHook(Gt,Pt.error),A<=M+1&&(E!==xi&&(Y=void 0,tt=[Gt]),L.rejectWith(Y,tt))}};M?Pt():(p.Deferred.getErrorHook?Pt.error=p.Deferred.getErrorHook():p.Deferred.getStackHook&&(Pt.error=p.Deferred.getStackHook()),ct.setTimeout(Pt))}}return p.Deferred(function(M){a[0][3].add(O(0,M,ft(D)?D:_i,M.notifyWith)),a[1][3].add(O(0,M,ft(v)?v:_i)),a[2][3].add(O(0,M,ft(x)?x:xi))}).promise()},promise:function(v){return v!=null?p.extend(v,f):f}},m={};return p.each(a,function(v,x){var D=x[2],A=x[5];f[x[1]]=D.add,A&&D.add(function(){c=A},a[3-v][2].disable,a[3-v][3].disable,a[0][2].lock,a[0][3].lock),D.add(x[3].fire),m[x[0]]=function(){return m[x[0]+"With"](this===m?void 0:this,arguments),this},m[x[0]+"With"]=D.fireWith}),f.promise(m),s&&s.call(m,m),m},when:function(s){var a=arguments.length,c=a,f=Array(c),m=ge.call(arguments),v=p.Deferred(),x=function(D){return function(A){f[D]=this,m[D]=1<arguments.length?ge.call(arguments):A,--a||v.resolveWith(f,m)}};if(a<=1&&(kn(s,v.done(x(c)).resolve,v.reject,!a),v.state()==="pending"||ft(m[c]&&m[c].then)))return v.then();for(;c--;)kn(m[c],x(c),v.reject);return v.promise()}});var io=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;p.Deferred.exceptionHook=function(s,a){ct.console&&ct.console.warn&&s&&io.test(s.name)&&ct.console.warn("jQuery.Deferred exception: "+s.message,s.stack,a)},p.readyException=function(s){ct.setTimeout(function(){throw s})};var ar=p.Deferred();function Dn(){ut.removeEventListener("DOMContentLoaded",Dn),ct.removeEventListener("load",Dn),p.ready()}p.fn.ready=function(s){return ar.then(s).catch(function(a){p.readyException(a)}),this},p.extend({isReady:!1,readyWait:1,ready:function(s){(s===!0?--p.readyWait:p.isReady)||(p.isReady=!0)!==s&&0<--p.readyWait||ar.resolveWith(ut,[p])}}),p.ready.then=ar.then,ut.readyState==="complete"||ut.readyState!=="loading"&&!ut.documentElement.doScroll?ct.setTimeout(p.ready):(ut.addEventListener("DOMContentLoaded",Dn),ct.addEventListener("load",Dn));var Ve=function(s,a,c,f,m,v,x){var D=0,A=s.length,O=c==null;if(si(c)==="object")for(D in m=!0,c)Ve(s,a,D,c[D],!0,v,x);else if(f!==void 0&&(m=!0,ft(f)||(x=!0),O&&(x?(a.call(s,f),a=null):(O=a,a=function(M,L,E){return O.call(p(M),E)})),a))for(;D<A;D++)a(s[D],c,x?f:f.call(s[D],D,a(s[D],c)));return m?s:O?a.call(s):A?a(s[0],c):v},Ni=/^-ms-/,no=/-([a-z])/g;function ro(s,a){return a.toUpperCase()}function Be(s){return s.replace(Ni,"ms-").replace(no,ro)}var an=function(s){return s.nodeType===1||s.nodeType===9||!+s.nodeType};function hn(){this.expando=p.expando+hn.uid++}hn.uid=1,hn.prototype={cache:function(s){var a=s[this.expando];return a||(a={},an(s)&&(s.nodeType?s[this.expando]=a:Object.defineProperty(s,this.expando,{value:a,configurable:!0}))),a},set:function(s,a,c){var f,m=this.cache(s);if(typeof a=="string")m[Be(a)]=c;else for(f in a)m[Be(f)]=a[f];return m},get:function(s,a){return a===void 0?this.cache(s):s[this.expando]&&s[this.expando][Be(a)]},access:function(s,a,c){return a===void 0||a&&typeof a=="string"&&c===void 0?this.get(s,a):(this.set(s,a,c),c!==void 0?c:a)},remove:function(s,a){var c,f=s[this.expando];if(f!==void 0){if(a!==void 0)for(c=(a=Array.isArray(a)?a.map(Be):(a=Be(a))in f?[a]:a.match(Pe)||[]).length;c--;)delete f[a[c]];(a===void 0||p.isEmptyObject(f))&&(s.nodeType?s[this.expando]=void 0:delete s[this.expando])}},hasData:function(s){var a=s[this.expando];return a!==void 0&&!p.isEmptyObject(a)}};var X=new hn,ie=new hn,so=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,oo=/[A-Z]/g;function hs(s,a,c){var f,m;if(c===void 0&&s.nodeType===1)if(f="data-"+a.replace(oo,"-$&").toLowerCase(),typeof(c=s.getAttribute(f))=="string"){try{c=(m=c)==="true"||m!=="false"&&(m==="null"?null:m===+m+""?+m:so.test(m)?JSON.parse(m):m)}catch{}ie.set(s,a,c)}else c=void 0;return c}p.extend({hasData:function(s){return ie.hasData(s)||X.hasData(s)},data:function(s,a,c){return ie.access(s,a,c)},removeData:function(s,a){ie.remove(s,a)},_data:function(s,a,c){return X.access(s,a,c)},_removeData:function(s,a){X.remove(s,a)}}),p.fn.extend({data:function(s,a){var c,f,m,v=this[0],x=v&&v.attributes;if(s===void 0){if(this.length&&(m=ie.get(v),v.nodeType===1&&!X.get(v,"hasDataAttrs"))){for(c=x.length;c--;)x[c]&&(f=x[c].name).indexOf("data-")===0&&(f=Be(f.slice(5)),hs(v,f,m[f]));X.set(v,"hasDataAttrs",!0)}return m}return typeof s=="object"?this.each(function(){ie.set(this,s)}):Ve(this,function(D){var A;if(v&&D===void 0)return(A=ie.get(v,s))!==void 0||(A=hs(v,s))!==void 0?A:void 0;this.each(function(){ie.set(this,s,D)})},null,a,1<arguments.length,null,!0)},removeData:function(s){return this.each(function(){ie.remove(this,s)})}}),p.extend({queue:function(s,a,c){var f;if(s)return a=(a||"fx")+"queue",f=X.get(s,a),c&&(!f||Array.isArray(c)?f=X.access(s,a,p.makeArray(c)):f.push(c)),f||[]},dequeue:function(s,a){a=a||"fx";var c=p.queue(s,a),f=c.length,m=c.shift(),v=p._queueHooks(s,a);m==="inprogress"&&(m=c.shift(),f--),m&&(a==="fx"&&c.unshift("inprogress"),delete v.stop,m.call(s,function(){p.dequeue(s,a)},v)),!f&&v&&v.empty.fire()},_queueHooks:function(s,a){var c=a+"queueHooks";return X.get(s,c)||X.access(s,c,{empty:p.Callbacks("once memory").add(function(){X.remove(s,[a+"queue",c])})})}}),p.fn.extend({queue:function(s,a){var c=2;return typeof s!="string"&&(a=s,s="fx",c--),arguments.length<c?p.queue(this[0],s):a===void 0?this:this.each(function(){var f=p.queue(this,s,a);p._queueHooks(this,s),s==="fx"&&f[0]!=="inprogress"&&p.dequeue(this,s)})},dequeue:function(s){return this.each(function(){p.dequeue(this,s)})},clearQueue:function(s){return this.queue(s||"fx",[])},promise:function(s,a){var c,f=1,m=p.Deferred(),v=this,x=this.length,D=function(){--f||m.resolveWith(v,[v])};for(typeof s!="string"&&(a=s,s=void 0),s=s||"fx";x--;)(c=X.get(v[x],s+"queueHooks"))&&c.empty&&(f++,c.empty.add(D));return D(),m.promise(a)}});var ls=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ln=new RegExp("^(?:([+-])=|)("+ls+")([a-z%]*)$","i"),Ne=["Top","Right","Bottom","Left"],oi=ut.documentElement,yi=function(s){return p.contains(s.ownerDocument,s)},ao={composed:!0};oi.getRootNode&&(yi=function(s){return p.contains(s.ownerDocument,s)||s.getRootNode(ao)===s.ownerDocument});var un=function(s,a){return(s=a||s).style.display==="none"||s.style.display===""&&yi(s)&&p.css(s,"display")==="none"};function Fn(s,a,c,f){var m,v,x=20,D=f?function(){return f.cur()}:function(){return p.css(s,a,"")},A=D(),O=c&&c[3]||(p.cssNumber[a]?"":"px"),M=s.nodeType&&(p.cssNumber[a]||O!=="px"&&+A)&&ln.exec(p.css(s,a));if(M&&M[3]!==O){for(A/=2,O=O||M[3],M=+A||1;x--;)p.style(s,a,M+O),(1-v)*(1-(v=D()/A||.5))<=0&&(x=0),M/=v;M*=2,p.style(s,a,M+O),c=c||[]}return c&&(M=+M||+A||0,m=c[1]?M+(c[1]+1)*c[2]:+c[2],f&&(f.unit=O,f.start=M,f.end=m)),m}var hr={};function Ti(s,a){for(var c,f,m,v,x,D,A,O=[],M=0,L=s.length;M<L;M++)(f=s[M]).style&&(c=f.style.display,a?(c==="none"&&(O[M]=X.get(f,"display")||null,O[M]||(f.style.display="")),f.style.display===""&&un(f)&&(O[M]=(A=x=v=void 0,x=(m=f).ownerDocument,D=m.nodeName,(A=hr[D])||(v=x.body.appendChild(x.createElement(D)),A=p.css(v,"display"),v.parentNode.removeChild(v),A==="none"&&(A="block"),hr[D]=A)))):c!=="none"&&(O[M]="none",X.set(f,"display",c)));for(M=0;M<L;M++)O[M]!=null&&(s[M].style.display=O[M]);return s}p.fn.extend({show:function(){return Ti(this,!0)},hide:function(){return Ti(this)},toggle:function(s){return typeof s=="boolean"?s?this.show():this.hide():this.each(function(){un(this)?p(this).show():p(this).hide()})}});var ai,cn,ji=/^(?:checkbox|radio)$/i,lr=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Me=/^$|^module$|\/(?:java|ecma)script/i;ai=ut.createDocumentFragment().appendChild(ut.createElement("div")),(cn=ut.createElement("input")).setAttribute("type","radio"),cn.setAttribute("checked","checked"),cn.setAttribute("name","t"),ai.appendChild(cn),dt.checkClone=ai.cloneNode(!0).cloneNode(!0).lastChild.checked,ai.innerHTML="<textarea>x</textarea>",dt.noCloneChecked=!!ai.cloneNode(!0).lastChild.defaultValue,ai.innerHTML="<option></option>",dt.option=!!ai.lastChild;var Ht={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ne(s,a){var c;return c=typeof s.getElementsByTagName<"u"?s.getElementsByTagName(a||"*"):typeof s.querySelectorAll<"u"?s.querySelectorAll(a||"*"):[],a===void 0||a&&It(s,a)?p.merge([s],c):c}function ur(s,a){for(var c=0,f=s.length;c<f;c++)X.set(s[c],"globalEval",!a||X.get(a[c],"globalEval"))}Ht.tbody=Ht.tfoot=Ht.colgroup=Ht.caption=Ht.thead,Ht.th=Ht.td,dt.option||(Ht.optgroup=Ht.option=[1,"<select multiple='multiple'>","</select>"]);var ho=/<|&#?\w+;/;function cr(s,a,c,f,m){for(var v,x,D,A,O,M,L=a.createDocumentFragment(),E=[],z=0,Y=s.length;z<Y;z++)if((v=s[z])||v===0)if(si(v)==="object")p.merge(E,v.nodeType?[v]:v);else if(ho.test(v)){for(x=x||L.appendChild(a.createElement("div")),D=(lr.exec(v)||["",""])[1].toLowerCase(),A=Ht[D]||Ht._default,x.innerHTML=A[1]+p.htmlPrefilter(v)+A[2],M=A[0];M--;)x=x.lastChild;p.merge(E,x.childNodes),(x=L.firstChild).textContent=""}else E.push(a.createTextNode(v));for(L.textContent="",z=0;v=E[z++];)if(f&&-1<p.inArray(v,f))m&&m.push(v);else if(O=yi(v),x=ne(L.appendChild(v),"script"),O&&ur(x),c)for(M=0;v=x[M++];)Me.test(v.type||"")&&c.push(v);return L}var dr=/^([^.]*)(?:\.(.+)|)/;function Li(){return!0}function zi(){return!1}function fr(s,a,c,f,m,v){var x,D;if(typeof a=="object"){for(D in typeof c!="string"&&(f=f||c,c=void 0),a)fr(s,D,c,f,a[D],v);return s}if(f==null&&m==null?(m=c,f=c=void 0):m==null&&(typeof c=="string"?(m=f,f=void 0):(m=f,f=c,c=void 0)),m===!1)m=zi;else if(!m)return s;return v===1&&(x=m,(m=function(A){return p().off(A),x.apply(this,arguments)}).guid=x.guid||(x.guid=p.guid++)),s.each(function(){p.event.add(this,a,m,f,c)})}function In(s,a,c){c?(X.set(s,a,!1),p.event.add(s,a,{namespace:!1,handler:function(f){var m,v=X.get(this,a);if(1&f.isTrigger&&this[a]){if(v)(p.event.special[a]||{}).delegateType&&f.stopPropagation();else if(v=ge.call(arguments),X.set(this,a,v),this[a](),m=X.get(this,a),X.set(this,a,!1),v!==m)return f.stopImmediatePropagation(),f.preventDefault(),m}else v&&(X.set(this,a,p.event.trigger(v[0],v.slice(1),this)),f.stopPropagation(),f.isImmediatePropagationStopped=Li)}})):X.get(s,a)===void 0&&p.event.add(s,a,Li)}p.event={global:{},add:function(s,a,c,f,m){var v,x,D,A,O,M,L,E,z,Y,tt,nt=X.get(s);if(an(s))for(c.handler&&(c=(v=c).handler,m=v.selector),m&&p.find.matchesSelector(oi,m),c.guid||(c.guid=p.guid++),(A=nt.events)||(A=nt.events=Object.create(null)),(x=nt.handle)||(x=nt.handle=function(Pt){return typeof p<"u"&&p.event.triggered!==Pt.type?p.event.dispatch.apply(s,arguments):void 0}),O=(a=(a||"").match(Pe)||[""]).length;O--;)z=tt=(D=dr.exec(a[O])||[])[1],Y=(D[2]||"").split(".").sort(),z&&(L=p.event.special[z]||{},z=(m?L.delegateType:L.bindType)||z,L=p.event.special[z]||{},M=p.extend({type:z,origType:tt,data:f,handler:c,guid:c.guid,selector:m,needsContext:m&&p.expr.match.needsContext.test(m),namespace:Y.join(".")},v),(E=A[z])||((E=A[z]=[]).delegateCount=0,L.setup&&L.setup.call(s,f,Y,x)!==!1||s.addEventListener&&s.addEventListener(z,x)),L.add&&(L.add.call(s,M),M.handler.guid||(M.handler.guid=c.guid)),m?E.splice(E.delegateCount++,0,M):E.push(M),p.event.global[z]=!0)},remove:function(s,a,c,f,m){var v,x,D,A,O,M,L,E,z,Y,tt,nt=X.hasData(s)&&X.get(s);if(nt&&(A=nt.events)){for(O=(a=(a||"").match(Pe)||[""]).length;O--;)if(z=tt=(D=dr.exec(a[O])||[])[1],Y=(D[2]||"").split(".").sort(),z){for(L=p.event.special[z]||{},E=A[z=(f?L.delegateType:L.bindType)||z]||[],D=D[2]&&new RegExp("(^|\\.)"+Y.join("\\.(?:.*\\.|)")+"(\\.|$)"),x=v=E.length;v--;)M=E[v],!m&&tt!==M.origType||c&&c.guid!==M.guid||D&&!D.test(M.namespace)||f&&f!==M.selector&&(f!=="**"||!M.selector)||(E.splice(v,1),M.selector&&E.delegateCount--,L.remove&&L.remove.call(s,M));x&&!E.length&&(L.teardown&&L.teardown.call(s,Y,nt.handle)!==!1||p.removeEvent(s,z,nt.handle),delete A[z])}else for(z in A)p.event.remove(s,z+a[O],c,f,!0);p.isEmptyObject(A)&&X.remove(s,"handle events")}},dispatch:function(s){var a,c,f,m,v,x,D=new Array(arguments.length),A=p.event.fix(s),O=(X.get(this,"events")||Object.create(null))[A.type]||[],M=p.event.special[A.type]||{};for(D[0]=A,a=1;a<arguments.length;a++)D[a]=arguments[a];if(A.delegateTarget=this,!M.preDispatch||M.preDispatch.call(this,A)!==!1){for(x=p.event.handlers.call(this,A,O),a=0;(m=x[a++])&&!A.isPropagationStopped();)for(A.currentTarget=m.elem,c=0;(v=m.handlers[c++])&&!A.isImmediatePropagationStopped();)A.rnamespace&&v.namespace!==!1&&!A.rnamespace.test(v.namespace)||(A.handleObj=v,A.data=v.data,(f=((p.event.special[v.origType]||{}).handle||v.handler).apply(m.elem,D))!==void 0&&(A.result=f)===!1&&(A.preventDefault(),A.stopPropagation()));return M.postDispatch&&M.postDispatch.call(this,A),A.result}},handlers:function(s,a){var c,f,m,v,x,D=[],A=a.delegateCount,O=s.target;if(A&&O.nodeType&&!(s.type==="click"&&1<=s.button)){for(;O!==this;O=O.parentNode||this)if(O.nodeType===1&&(s.type!=="click"||O.disabled!==!0)){for(v=[],x={},c=0;c<A;c++)x[m=(f=a[c]).selector+" "]===void 0&&(x[m]=f.needsContext?-1<p(m,this).index(O):p.find(m,this,null,[O]).length),x[m]&&v.push(f);v.length&&D.push({elem:O,handlers:v})}}return O=this,A<a.length&&D.push({elem:O,handlers:a.slice(A)}),D},addProp:function(s,a){Object.defineProperty(p.Event.prototype,s,{enumerable:!0,configurable:!0,get:ft(a)?function(){if(this.originalEvent)return a(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[s]},set:function(c){Object.defineProperty(this,s,{enumerable:!0,configurable:!0,writable:!0,value:c})}})},fix:function(s){return s[p.expando]?s:new p.Event(s)},special:{load:{noBubble:!0},click:{setup:function(s){var a=this||s;return ji.test(a.type)&&a.click&&It(a,"input")&&In(a,"click",!0),!1},trigger:function(s){var a=this||s;return ji.test(a.type)&&a.click&&It(a,"input")&&In(a,"click"),!0},_default:function(s){var a=s.target;return ji.test(a.type)&&a.click&&It(a,"input")&&X.get(a,"click")||It(a,"a")}},beforeunload:{postDispatch:function(s){s.result!==void 0&&s.originalEvent&&(s.originalEvent.returnValue=s.result)}}}},p.removeEvent=function(s,a,c){s.removeEventListener&&s.removeEventListener(a,c)},p.Event=function(s,a){if(!(this instanceof p.Event))return new p.Event(s,a);s&&s.type?(this.originalEvent=s,this.type=s.type,this.isDefaultPrevented=s.defaultPrevented||s.defaultPrevented===void 0&&s.returnValue===!1?Li:zi,this.target=s.target&&s.target.nodeType===3?s.target.parentNode:s.target,this.currentTarget=s.currentTarget,this.relatedTarget=s.relatedTarget):this.type=s,a&&p.extend(this,a),this.timeStamp=s&&s.timeStamp||Date.now(),this[p.expando]=!0},p.Event.prototype={constructor:p.Event,isDefaultPrevented:zi,isPropagationStopped:zi,isImmediatePropagationStopped:zi,isSimulated:!1,preventDefault:function(){var s=this.originalEvent;this.isDefaultPrevented=Li,s&&!this.isSimulated&&s.preventDefault()},stopPropagation:function(){var s=this.originalEvent;this.isPropagationStopped=Li,s&&!this.isSimulated&&s.stopPropagation()},stopImmediatePropagation:function(){var s=this.originalEvent;this.isImmediatePropagationStopped=Li,s&&!this.isSimulated&&s.stopImmediatePropagation(),this.stopPropagation()}},p.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},p.event.addProp),p.each({focus:"focusin",blur:"focusout"},function(s,a){function c(f){if(ut.documentMode){var m=X.get(this,"handle"),v=p.event.fix(f);v.type=f.type==="focusin"?"focus":"blur",v.isSimulated=!0,m(f),v.target===v.currentTarget&&m(v)}else p.event.simulate(a,f.target,p.event.fix(f))}p.event.special[s]={setup:function(){var f;if(In(this,s,!0),!ut.documentMode)return!1;(f=X.get(this,a))||this.addEventListener(a,c),X.set(this,a,(f||0)+1)},trigger:function(){return In(this,s),!0},teardown:function(){var f;if(!ut.documentMode)return!1;(f=X.get(this,a)-1)?X.set(this,a,f):(this.removeEventListener(a,c),X.remove(this,a))},_default:function(f){return X.get(f.target,s)},delegateType:a},p.event.special[a]={setup:function(){var f=this.ownerDocument||this.document||this,m=ut.documentMode?this:f,v=X.get(m,a);v||(ut.documentMode?this.addEventListener(a,c):f.addEventListener(s,c,!0)),X.set(m,a,(v||0)+1)},teardown:function(){var f=this.ownerDocument||this.document||this,m=ut.documentMode?this:f,v=X.get(m,a)-1;v?X.set(m,a,v):(ut.documentMode?this.removeEventListener(a,c):f.removeEventListener(s,c,!0),X.remove(m,a))}}}),p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(s,a){p.event.special[s]={delegateType:a,bindType:a,handle:function(c){var f,m=c.relatedTarget,v=c.handleObj;return m&&(m===this||p.contains(this,m))||(c.type=v.origType,f=v.handler.apply(this,arguments),c.type=a),f}}}),p.fn.extend({on:function(s,a,c,f){return fr(this,s,a,c,f)},one:function(s,a,c,f){return fr(this,s,a,c,f,1)},off:function(s,a,c){var f,m;if(s&&s.preventDefault&&s.handleObj)return f=s.handleObj,p(s.delegateTarget).off(f.namespace?f.origType+"."+f.namespace:f.origType,f.selector,f.handler),this;if(typeof s=="object"){for(m in s)this.off(m,a,s[m]);return this}return a!==!1&&typeof a!="function"||(c=a,a=void 0),c===!1&&(c=zi),this.each(function(){p.event.remove(this,s,c,a)})}});var lo=/<script|<style|<link/i,uo=/checked\s*(?:[^=]|=\s*.checked.)/i,co=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function us(s,a){return It(s,"table")&&It(a.nodeType!==11?a:a.firstChild,"tr")&&p(s).children("tbody")[0]||s}function fo(s){return s.type=(s.getAttribute("type")!==null)+"/"+s.type,s}function po(s){return(s.type||"").slice(0,5)==="true/"?s.type=s.type.slice(5):s.removeAttribute("type"),s}function cs(s,a){var c,f,m,v,x,D;if(a.nodeType===1){if(X.hasData(s)&&(D=X.get(s).events))for(m in X.remove(a,"handle events"),D)for(c=0,f=D[m].length;c<f;c++)p.event.add(a,m,D[m][c]);ie.hasData(s)&&(v=ie.access(s),x=p.extend({},v),ie.set(a,x))}}function hi(s,a,c,f){a=Jr(a);var m,v,x,D,A,O,M=0,L=s.length,E=L-1,z=a[0],Y=ft(z);if(Y||1<L&&typeof z=="string"&&!dt.checkClone&&uo.test(z))return s.each(function(tt){var nt=s.eq(tt);Y&&(a[0]=z.call(this,tt,nt.html())),hi(nt,a,c,f)});if(L&&(v=(m=cr(a,s[0].ownerDocument,!1,s,f)).firstChild,m.childNodes.length===1&&(m=v),v||f)){for(D=(x=p.map(ne(m,"script"),fo)).length;M<L;M++)A=m,M!==E&&(A=p.clone(A,!0,!0),D&&p.merge(x,ne(A,"script"))),c.call(s[M],A,M);if(D)for(O=x[x.length-1].ownerDocument,p.map(x,po),M=0;M<D;M++)A=x[M],Me.test(A.type||"")&&!X.access(A,"globalEval")&&p.contains(O,A)&&(A.src&&(A.type||"").toLowerCase()!=="module"?p._evalUrl&&!A.noModule&&p._evalUrl(A.src,{nonce:A.nonce||A.getAttribute("nonce")},O):er(A.textContent.replace(co,""),A,O))}return s}function pr(s,a,c){for(var f,m=a?p.filter(a,s):s,v=0;(f=m[v])!=null;v++)c||f.nodeType!==1||p.cleanData(ne(f)),f.parentNode&&(c&&yi(f)&&ur(ne(f,"script")),f.parentNode.removeChild(f));return s}p.extend({htmlPrefilter:function(s){return s},clone:function(s,a,c){var f,m,v,x,D,A,O,M=s.cloneNode(!0),L=yi(s);if(!(dt.noCloneChecked||s.nodeType!==1&&s.nodeType!==11||p.isXMLDoc(s)))for(x=ne(M),f=0,m=(v=ne(s)).length;f<m;f++)D=v[f],A=x[f],(O=A.nodeName.toLowerCase())==="input"&&ji.test(D.type)?A.checked=D.checked:O!=="input"&&O!=="textarea"||(A.defaultValue=D.defaultValue);if(a)if(c)for(v=v||ne(s),x=x||ne(M),f=0,m=v.length;f<m;f++)cs(v[f],x[f]);else cs(s,M);return 0<(x=ne(M,"script")).length&&ur(x,!L&&ne(s,"script")),M},cleanData:function(s){for(var a,c,f,m=p.event.special,v=0;(c=s[v])!==void 0;v++)if(an(c)){if(a=c[X.expando]){if(a.events)for(f in a.events)m[f]?p.event.remove(c,f):p.removeEvent(c,f,a.handle);c[X.expando]=void 0}c[ie.expando]&&(c[ie.expando]=void 0)}}}),p.fn.extend({detach:function(s){return pr(this,s,!0)},remove:function(s){return pr(this,s)},text:function(s){return Ve(this,function(a){return a===void 0?p.text(this):this.empty().each(function(){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(this.textContent=a)})},null,s,arguments.length)},append:function(){return hi(this,arguments,function(s){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||us(this,s).appendChild(s)})},prepend:function(){return hi(this,arguments,function(s){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var a=us(this,s);a.insertBefore(s,a.firstChild)}})},before:function(){return hi(this,arguments,function(s){this.parentNode&&this.parentNode.insertBefore(s,this)})},after:function(){return hi(this,arguments,function(s){this.parentNode&&this.parentNode.insertBefore(s,this.nextSibling)})},empty:function(){for(var s,a=0;(s=this[a])!=null;a++)s.nodeType===1&&(p.cleanData(ne(s,!1)),s.textContent="");return this},clone:function(s,a){return s=s!=null&&s,a=a??s,this.map(function(){return p.clone(this,s,a)})},html:function(s){return Ve(this,function(a){var c=this[0]||{},f=0,m=this.length;if(a===void 0&&c.nodeType===1)return c.innerHTML;if(typeof a=="string"&&!lo.test(a)&&!Ht[(lr.exec(a)||["",""])[1].toLowerCase()]){a=p.htmlPrefilter(a);try{for(;f<m;f++)(c=this[f]||{}).nodeType===1&&(p.cleanData(ne(c,!1)),c.innerHTML=a);c=0}catch{}}c&&this.empty().append(a)},null,s,arguments.length)},replaceWith:function(){var s=[];return hi(this,arguments,function(a){var c=this.parentNode;p.inArray(this,s)<0&&(p.cleanData(ne(this)),c&&c.replaceChild(a,this))},s)}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(s,a){p.fn[s]=function(c){for(var f,m=[],v=p(c),x=v.length-1,D=0;D<=x;D++)f=D===x?this:this.clone(!0),p(v[D])[a](f),rn.apply(m,f.get());return this.pushStack(m)}});var Hi=new RegExp("^("+ls+")(?!px)[a-z%]+$","i"),Gi=/^--/,On=function(s){var a=s.ownerDocument.defaultView;return a&&a.opener||(a=ct),a.getComputedStyle(s)},ds=function(s,a,c){var f,m,v={};for(m in a)v[m]=s.style[m],s.style[m]=a[m];for(m in f=c.call(s),a)s.style[m]=v[m];return f},go=new RegExp(Ne.join("|"),"i");function dn(s,a,c){var f,m,v,x,D=Gi.test(a),A=s.style;return(c=c||On(s))&&(x=c.getPropertyValue(a)||c[a],D&&x&&(x=x.replace(Pi,"$1")||void 0),x!==""||yi(s)||(x=p.style(s,a)),!dt.pixelBoxStyles()&&Hi.test(x)&&go.test(a)&&(f=A.width,m=A.minWidth,v=A.maxWidth,A.minWidth=A.maxWidth=A.width=x,x=c.width,A.width=f,A.minWidth=m,A.maxWidth=v)),x!==void 0?x+"":x}function fs(s,a){return{get:function(){if(!s())return(this.get=a).apply(this,arguments);delete this.get}}}(function(){function s(){if(O){A.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",O.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",oi.appendChild(A).appendChild(O);var M=ct.getComputedStyle(O);c=M.top!=="1%",D=a(M.marginLeft)===12,O.style.right="60%",v=a(M.right)===36,f=a(M.width)===36,O.style.position="absolute",m=a(O.offsetWidth/3)===12,oi.removeChild(A),O=null}}function a(M){return Math.round(parseFloat(M))}var c,f,m,v,x,D,A=ut.createElement("div"),O=ut.createElement("div");O.style&&(O.style.backgroundClip="content-box",O.cloneNode(!0).style.backgroundClip="",dt.clearCloneStyle=O.style.backgroundClip==="content-box",p.extend(dt,{boxSizingReliable:function(){return s(),f},pixelBoxStyles:function(){return s(),v},pixelPosition:function(){return s(),c},reliableMarginLeft:function(){return s(),D},scrollboxSize:function(){return s(),m},reliableTrDimensions:function(){var M,L,E,z;return x==null&&(M=ut.createElement("table"),L=ut.createElement("tr"),E=ut.createElement("div"),M.style.cssText="position:absolute;left:-11111px;border-collapse:separate",L.style.cssText="box-sizing:content-box;border:1px solid",L.style.height="1px",E.style.height="9px",E.style.display="block",oi.appendChild(M).appendChild(L).appendChild(E),z=ct.getComputedStyle(L),x=parseInt(z.height,10)+parseInt(z.borderTopWidth,10)+parseInt(z.borderBottomWidth,10)===L.offsetHeight,oi.removeChild(M)),x}}))})();var gr=["Webkit","Moz","ms"],ps=ut.createElement("div").style,gs={};function mr(s){var a=p.cssProps[s]||gs[s];return a||(s in ps?s:gs[s]=function(c){for(var f=c[0].toUpperCase()+c.slice(1),m=gr.length;m--;)if((c=gr[m]+f)in ps)return c}(s)||s)}var mo=/^(none|table(?!-c[ea]).+)/,bo={position:"absolute",visibility:"hidden",display:"block"},ms={letterSpacing:"0",fontWeight:"400"};function bs(s,a,c){var f=ln.exec(a);return f?Math.max(0,f[2]-(c||0))+(f[3]||"px"):a}function Rn(s,a,c,f,m,v){var x=a==="width"?1:0,D=0,A=0,O=0;if(c===(f?"border":"content"))return 0;for(;x<4;x+=2)c==="margin"&&(O+=p.css(s,c+Ne[x],!0,m)),f?(c==="content"&&(A-=p.css(s,"padding"+Ne[x],!0,m)),c!=="margin"&&(A-=p.css(s,"border"+Ne[x]+"Width",!0,m))):(A+=p.css(s,"padding"+Ne[x],!0,m),c!=="padding"?A+=p.css(s,"border"+Ne[x]+"Width",!0,m):D+=p.css(s,"border"+Ne[x]+"Width",!0,m));return!f&&0<=v&&(A+=Math.max(0,Math.ceil(s["offset"+a[0].toUpperCase()+a.slice(1)]-v-A-D-.5))||0),A+O}function Un(s,a,c){var f=On(s),m=(!dt.boxSizingReliable()||c)&&p.css(s,"boxSizing",!1,f)==="border-box",v=m,x=dn(s,a,f),D="offset"+a[0].toUpperCase()+a.slice(1);if(Hi.test(x)){if(!c)return x;x="auto"}return(!dt.boxSizingReliable()&&m||!dt.reliableTrDimensions()&&It(s,"tr")||x==="auto"||!parseFloat(x)&&p.css(s,"display",!1,f)==="inline")&&s.getClientRects().length&&(m=p.css(s,"boxSizing",!1,f)==="border-box",(v=D in s)&&(x=s[D])),(x=parseFloat(x)||0)+Rn(s,a,c||(m?"border":"content"),v,f,x)+"px"}function ke(s,a,c,f,m){return new ke.prototype.init(s,a,c,f,m)}p.extend({cssHooks:{opacity:{get:function(s,a){if(a){var c=dn(s,"opacity");return c===""?"1":c}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(s,a,c,f){if(s&&s.nodeType!==3&&s.nodeType!==8&&s.style){var m,v,x,D=Be(a),A=Gi.test(a),O=s.style;if(A||(a=mr(D)),x=p.cssHooks[a]||p.cssHooks[D],c===void 0)return x&&"get"in x&&(m=x.get(s,!1,f))!==void 0?m:O[a];(v=typeof c)=="string"&&(m=ln.exec(c))&&m[1]&&(c=Fn(s,a,m),v="number"),c!=null&&c==c&&(v!=="number"||A||(c+=m&&m[3]||(p.cssNumber[D]?"":"px")),dt.clearCloneStyle||c!==""||a.indexOf("background")!==0||(O[a]="inherit"),x&&"set"in x&&(c=x.set(s,c,f))===void 0||(A?O.setProperty(a,c):O[a]=c))}},css:function(s,a,c,f){var m,v,x,D=Be(a);return Gi.test(a)||(a=mr(D)),(x=p.cssHooks[a]||p.cssHooks[D])&&"get"in x&&(m=x.get(s,!0,c)),m===void 0&&(m=dn(s,a,f)),m==="normal"&&a in ms&&(m=ms[a]),c===""||c?(v=parseFloat(m),c===!0||isFinite(v)?v||0:m):m}}),p.each(["height","width"],function(s,a){p.cssHooks[a]={get:function(c,f,m){if(f)return!mo.test(p.css(c,"display"))||c.getClientRects().length&&c.getBoundingClientRect().width?Un(c,a,m):ds(c,bo,function(){return Un(c,a,m)})},set:function(c,f,m){var v,x=On(c),D=!dt.scrollboxSize()&&x.position==="absolute",A=(D||m)&&p.css(c,"boxSizing",!1,x)==="border-box",O=m?Rn(c,a,m,A,x):0;return A&&D&&(O-=Math.ceil(c["offset"+a[0].toUpperCase()+a.slice(1)]-parseFloat(x[a])-Rn(c,a,"border",!1,x)-.5)),O&&(v=ln.exec(f))&&(v[3]||"px")!=="px"&&(c.style[a]=f,f=p.css(c,a)),bs(0,f,O)}}}),p.cssHooks.marginLeft=fs(dt.reliableMarginLeft,function(s,a){if(a)return(parseFloat(dn(s,"marginLeft"))||s.getBoundingClientRect().left-ds(s,{marginLeft:0},function(){return s.getBoundingClientRect().left}))+"px"}),p.each({margin:"",padding:"",border:"Width"},function(s,a){p.cssHooks[s+a]={expand:function(c){for(var f=0,m={},v=typeof c=="string"?c.split(" "):[c];f<4;f++)m[s+Ne[f]+a]=v[f]||v[f-2]||v[0];return m}},s!=="margin"&&(p.cssHooks[s+a].set=bs)}),p.fn.extend({css:function(s,a){return Ve(this,function(c,f,m){var v,x,D={},A=0;if(Array.isArray(f)){for(v=On(c),x=f.length;A<x;A++)D[f[A]]=p.css(c,f[A],!1,v);return D}return m!==void 0?p.style(c,f,m):p.css(c,f)},s,a,1<arguments.length)}}),((p.Tween=ke).prototype={constructor:ke,init:function(s,a,c,f,m,v){this.elem=s,this.prop=c,this.easing=m||p.easing._default,this.options=a,this.start=this.now=this.cur(),this.end=f,this.unit=v||(p.cssNumber[c]?"":"px")},cur:function(){var s=ke.propHooks[this.prop];return s&&s.get?s.get(this):ke.propHooks._default.get(this)},run:function(s){var a,c=ke.propHooks[this.prop];return this.options.duration?this.pos=a=p.easing[this.easing](s,this.options.duration*s,0,1,this.options.duration):this.pos=a=s,this.now=(this.end-this.start)*a+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):ke.propHooks._default.set(this),this}}).init.prototype=ke.prototype,(ke.propHooks={_default:{get:function(s){var a;return s.elem.nodeType!==1||s.elem[s.prop]!=null&&s.elem.style[s.prop]==null?s.elem[s.prop]:(a=p.css(s.elem,s.prop,""))&&a!=="auto"?a:0},set:function(s){p.fx.step[s.prop]?p.fx.step[s.prop](s):s.elem.nodeType!==1||!p.cssHooks[s.prop]&&s.elem.style[mr(s.prop)]==null?s.elem[s.prop]=s.now:p.style(s.elem,s.prop,s.now+s.unit)}}}).scrollTop=ke.propHooks.scrollLeft={set:function(s){s.elem.nodeType&&s.elem.parentNode&&(s.elem[s.prop]=s.now)}},p.easing={linear:function(s){return s},swing:function(s){return .5-Math.cos(s*Math.PI)/2},_default:"swing"},p.fx=ke.prototype.init,p.fx.step={};var Xe,wi,li,fn,pt=/^(?:toggle|show|hide)$/,vs=/queueHooks$/;function Pn(){wi&&(ut.hidden===!1&&ct.requestAnimationFrame?ct.requestAnimationFrame(Pn):ct.setTimeout(Pn,p.fx.interval),p.fx.tick())}function br(){return ct.setTimeout(function(){Xe=void 0}),Xe=Date.now()}function pn(s,a){var c,f=0,m={height:s};for(a=a?1:0;f<4;f+=2-a)m["margin"+(c=Ne[f])]=m["padding"+c]=s;return a&&(m.opacity=m.width=s),m}function vr(s,a,c){for(var f,m=(ye.tweeners[a]||[]).concat(ye.tweeners["*"]),v=0,x=m.length;v<x;v++)if(f=m[v].call(c,a,s))return f}function ye(s,a,c){var f,m,v=0,x=ye.prefilters.length,D=p.Deferred().always(function(){delete A.elem}),A=function(){if(m)return!1;for(var L=Xe||br(),E=Math.max(0,O.startTime+O.duration-L),z=1-(E/O.duration||0),Y=0,tt=O.tweens.length;Y<tt;Y++)O.tweens[Y].run(z);return D.notifyWith(s,[O,z,E]),z<1&&tt?E:(tt||D.notifyWith(s,[O,1,0]),D.resolveWith(s,[O]),!1)},O=D.promise({elem:s,props:p.extend({},a),opts:p.extend(!0,{specialEasing:{},easing:p.easing._default},c),originalProperties:a,originalOptions:c,startTime:Xe||br(),duration:c.duration,tweens:[],createTween:function(L,E){var z=p.Tween(s,O.opts,L,E,O.opts.specialEasing[L]||O.opts.easing);return O.tweens.push(z),z},stop:function(L){var E=0,z=L?O.tweens.length:0;if(m)return this;for(m=!0;E<z;E++)O.tweens[E].run(1);return L?(D.notifyWith(s,[O,1,0]),D.resolveWith(s,[O,L])):D.rejectWith(s,[O,L]),this}}),M=O.props;for(!function(L,E){var z,Y,tt,nt,Pt;for(z in L)if(tt=E[Y=Be(z)],nt=L[z],Array.isArray(nt)&&(tt=nt[1],nt=L[z]=nt[0]),z!==Y&&(L[Y]=nt,delete L[z]),(Pt=p.cssHooks[Y])&&"expand"in Pt)for(z in nt=Pt.expand(nt),delete L[Y],nt)z in L||(L[z]=nt[z],E[z]=tt);else E[Y]=tt}(M,O.opts.specialEasing);v<x;v++)if(f=ye.prefilters[v].call(O,s,M,O.opts))return ft(f.stop)&&(p._queueHooks(O.elem,O.opts.queue).stop=f.stop.bind(f)),f;return p.map(M,vr,O),ft(O.opts.start)&&O.opts.start.call(s,O),O.progress(O.opts.progress).done(O.opts.done,O.opts.complete).fail(O.opts.fail).always(O.opts.always),p.fx.timer(p.extend(A,{elem:s,anim:O,queue:O.opts.queue})),O}p.Animation=p.extend(ye,{tweeners:{"*":[function(s,a){var c=this.createTween(s,a);return Fn(c.elem,s,ln.exec(a),c),c}]},tweener:function(s,a){ft(s)?(a=s,s=["*"]):s=s.match(Pe);for(var c,f=0,m=s.length;f<m;f++)c=s[f],ye.tweeners[c]=ye.tweeners[c]||[],ye.tweeners[c].unshift(a)},prefilters:[function(s,a,c){var f,m,v,x,D,A,O,M,L="width"in a||"height"in a,E=this,z={},Y=s.style,tt=s.nodeType&&un(s),nt=X.get(s,"fxshow");for(f in c.queue||((x=p._queueHooks(s,"fx")).unqueued==null&&(x.unqueued=0,D=x.empty.fire,x.empty.fire=function(){x.unqueued||D()}),x.unqueued++,E.always(function(){E.always(function(){x.unqueued--,p.queue(s,"fx").length||x.empty.fire()})})),a)if(m=a[f],pt.test(m)){if(delete a[f],v=v||m==="toggle",m===(tt?"hide":"show")){if(m!=="show"||!nt||nt[f]===void 0)continue;tt=!0}z[f]=nt&&nt[f]||p.style(s,f)}if((A=!p.isEmptyObject(a))||!p.isEmptyObject(z))for(f in L&&s.nodeType===1&&(c.overflow=[Y.overflow,Y.overflowX,Y.overflowY],(O=nt&&nt.display)==null&&(O=X.get(s,"display")),(M=p.css(s,"display"))==="none"&&(O?M=O:(Ti([s],!0),O=s.style.display||O,M=p.css(s,"display"),Ti([s]))),(M==="inline"||M==="inline-block"&&O!=null)&&p.css(s,"float")==="none"&&(A||(E.done(function(){Y.display=O}),O==null&&(M=Y.display,O=M==="none"?"":M)),Y.display="inline-block")),c.overflow&&(Y.overflow="hidden",E.always(function(){Y.overflow=c.overflow[0],Y.overflowX=c.overflow[1],Y.overflowY=c.overflow[2]})),A=!1,z)A||(nt?"hidden"in nt&&(tt=nt.hidden):nt=X.access(s,"fxshow",{display:O}),v&&(nt.hidden=!tt),tt&&Ti([s],!0),E.done(function(){for(f in tt||Ti([s]),X.remove(s,"fxshow"),z)p.style(s,f,z[f])})),A=vr(tt?nt[f]:0,f,E),f in nt||(nt[f]=A.start,tt&&(A.end=A.start,A.start=0))}],prefilter:function(s,a){a?ye.prefilters.unshift(s):ye.prefilters.push(s)}}),p.speed=function(s,a,c){var f=s&&typeof s=="object"?p.extend({},s):{complete:c||!c&&a||ft(s)&&s,duration:s,easing:c&&a||a&&!ft(a)&&a};return p.fx.off?f.duration=0:typeof f.duration!="number"&&(f.duration in p.fx.speeds?f.duration=p.fx.speeds[f.duration]:f.duration=p.fx.speeds._default),f.queue!=null&&f.queue!==!0||(f.queue="fx"),f.old=f.complete,f.complete=function(){ft(f.old)&&f.old.call(this),f.queue&&p.dequeue(this,f.queue)},f},p.fn.extend({fadeTo:function(s,a,c,f){return this.filter(un).css("opacity",0).show().end().animate({opacity:a},s,c,f)},animate:function(s,a,c,f){var m=p.isEmptyObject(s),v=p.speed(a,c,f),x=function(){var D=ye(this,p.extend({},s),v);(m||X.get(this,"finish"))&&D.stop(!0)};return x.finish=x,m||v.queue===!1?this.each(x):this.queue(v.queue,x)},stop:function(s,a,c){var f=function(m){var v=m.stop;delete m.stop,v(c)};return typeof s!="string"&&(c=a,a=s,s=void 0),a&&this.queue(s||"fx",[]),this.each(function(){var m=!0,v=s!=null&&s+"queueHooks",x=p.timers,D=X.get(this);if(v)D[v]&&D[v].stop&&f(D[v]);else for(v in D)D[v]&&D[v].stop&&vs.test(v)&&f(D[v]);for(v=x.length;v--;)x[v].elem!==this||s!=null&&x[v].queue!==s||(x[v].anim.stop(c),m=!1,x.splice(v,1));!m&&c||p.dequeue(this,s)})},finish:function(s){return s!==!1&&(s=s||"fx"),this.each(function(){var a,c=X.get(this),f=c[s+"queue"],m=c[s+"queueHooks"],v=p.timers,x=f?f.length:0;for(c.finish=!0,p.queue(this,s,[]),m&&m.stop&&m.stop.call(this,!0),a=v.length;a--;)v[a].elem===this&&v[a].queue===s&&(v[a].anim.stop(!0),v.splice(a,1));for(a=0;a<x;a++)f[a]&&f[a].finish&&f[a].finish.call(this);delete c.finish})}}),p.each(["toggle","show","hide"],function(s,a){var c=p.fn[a];p.fn[a]=function(f,m,v){return f==null||typeof f=="boolean"?c.apply(this,arguments):this.animate(pn(a,!0),f,m,v)}}),p.each({slideDown:pn("show"),slideUp:pn("hide"),slideToggle:pn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(s,a){p.fn[s]=function(c,f,m){return this.animate(a,c,f,m)}}),p.timers=[],p.fx.tick=function(){var s,a=0,c=p.timers;for(Xe=Date.now();a<c.length;a++)(s=c[a])()||c[a]!==s||c.splice(a--,1);c.length||p.fx.stop(),Xe=void 0},p.fx.timer=function(s){p.timers.push(s),p.fx.start()},p.fx.interval=13,p.fx.start=function(){wi||(wi=!0,Pn())},p.fx.stop=function(){wi=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(s,a){return s=p.fx&&p.fx.speeds[s]||s,a=a||"fx",this.queue(a,function(c,f){var m=ct.setTimeout(c,s);f.stop=function(){ct.clearTimeout(m)}})},li=ut.createElement("input"),fn=ut.createElement("select").appendChild(ut.createElement("option")),li.type="checkbox",dt.checkOn=li.value!=="",dt.optSelected=fn.selected,(li=ut.createElement("input")).value="t",li.type="radio",dt.radioValue=li.value==="t";var re,Yt=p.expr.attrHandle;p.fn.extend({attr:function(s,a){return Ve(this,p.attr,s,a,1<arguments.length)},removeAttr:function(s){return this.each(function(){p.removeAttr(this,s)})}}),p.extend({attr:function(s,a,c){var f,m,v=s.nodeType;if(v!==3&&v!==8&&v!==2)return typeof s.getAttribute>"u"?p.prop(s,a,c):(v===1&&p.isXMLDoc(s)||(m=p.attrHooks[a.toLowerCase()]||(p.expr.match.bool.test(a)?re:void 0)),c!==void 0?c===null?void p.removeAttr(s,a):m&&"set"in m&&(f=m.set(s,c,a))!==void 0?f:(s.setAttribute(a,c+""),c):m&&"get"in m&&(f=m.get(s,a))!==null?f:(f=p.find.attr(s,a))==null?void 0:f)},attrHooks:{type:{set:function(s,a){if(!dt.radioValue&&a==="radio"&&It(s,"input")){var c=s.value;return s.setAttribute("type",a),c&&(s.value=c),a}}}},removeAttr:function(s,a){var c,f=0,m=a&&a.match(Pe);if(m&&s.nodeType===1)for(;c=m[f++];)s.removeAttribute(c)}}),re={set:function(s,a,c){return a===!1?p.removeAttr(s,c):s.setAttribute(c,c),c}},p.each(p.expr.match.bool.source.match(/\w+/g),function(s,a){var c=Yt[a]||p.find.attr;Yt[a]=function(f,m,v){var x,D,A=m.toLowerCase();return v||(D=Yt[A],Yt[A]=x,x=c(f,m,v)!=null?A:null,Yt[A]=D),x}});var Bn=/^(?:input|select|textarea|button)$/i,ui=/^(?:a|area)$/i;function je(s){return(s.match(Pe)||[]).join(" ")}function Ye(s){return s.getAttribute&&s.getAttribute("class")||""}function Lt(s){return Array.isArray(s)?s:typeof s=="string"&&s.match(Pe)||[]}p.fn.extend({prop:function(s,a){return Ve(this,p.prop,s,a,1<arguments.length)},removeProp:function(s){return this.each(function(){delete this[p.propFix[s]||s]})}}),p.extend({prop:function(s,a,c){var f,m,v=s.nodeType;if(v!==3&&v!==8&&v!==2)return v===1&&p.isXMLDoc(s)||(a=p.propFix[a]||a,m=p.propHooks[a]),c!==void 0?m&&"set"in m&&(f=m.set(s,c,a))!==void 0?f:s[a]=c:m&&"get"in m&&(f=m.get(s,a))!==null?f:s[a]},propHooks:{tabIndex:{get:function(s){var a=p.find.attr(s,"tabindex");return a?parseInt(a,10):Bn.test(s.nodeName)||ui.test(s.nodeName)&&s.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),dt.optSelected||(p.propHooks.selected={get:function(s){var a=s.parentNode;return a&&a.parentNode&&a.parentNode.selectedIndex,null},set:function(s){var a=s.parentNode;a&&(a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex)}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){p.propFix[this.toLowerCase()]=this}),p.fn.extend({addClass:function(s){var a,c,f,m,v,x;return ft(s)?this.each(function(D){p(this).addClass(s.call(this,D,Ye(this)))}):(a=Lt(s)).length?this.each(function(){if(f=Ye(this),c=this.nodeType===1&&" "+je(f)+" "){for(v=0;v<a.length;v++)m=a[v],c.indexOf(" "+m+" ")<0&&(c+=m+" ");x=je(c),f!==x&&this.setAttribute("class",x)}}):this},removeClass:function(s){var a,c,f,m,v,x;return ft(s)?this.each(function(D){p(this).removeClass(s.call(this,D,Ye(this)))}):arguments.length?(a=Lt(s)).length?this.each(function(){if(f=Ye(this),c=this.nodeType===1&&" "+je(f)+" "){for(v=0;v<a.length;v++)for(m=a[v];-1<c.indexOf(" "+m+" ");)c=c.replace(" "+m+" "," ");x=je(c),f!==x&&this.setAttribute("class",x)}}):this:this.attr("class","")},toggleClass:function(s,a){var c,f,m,v,x=typeof s,D=x==="string"||Array.isArray(s);return ft(s)?this.each(function(A){p(this).toggleClass(s.call(this,A,Ye(this),a),a)}):typeof a=="boolean"&&D?a?this.addClass(s):this.removeClass(s):(c=Lt(s),this.each(function(){if(D)for(v=p(this),m=0;m<c.length;m++)f=c[m],v.hasClass(f)?v.removeClass(f):v.addClass(f);else s!==void 0&&x!=="boolean"||((f=Ye(this))&&X.set(this,"__className__",f),this.setAttribute&&this.setAttribute("class",f||s===!1?"":X.get(this,"__className__")||""))}))},hasClass:function(s){var a,c,f=0;for(a=" "+s+" ";c=this[f++];)if(c.nodeType===1&&-1<(" "+je(Ye(c))+" ").indexOf(a))return!0;return!1}});var vo=/\r/g;p.fn.extend({val:function(s){var a,c,f,m=this[0];return arguments.length?(f=ft(s),this.each(function(v){var x;this.nodeType===1&&((x=f?s.call(this,v,p(this).val()):s)==null?x="":typeof x=="number"?x+="":Array.isArray(x)&&(x=p.map(x,function(D){return D==null?"":D+""})),(a=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()])&&"set"in a&&a.set(this,x,"value")!==void 0||(this.value=x))})):m?(a=p.valHooks[m.type]||p.valHooks[m.nodeName.toLowerCase()])&&"get"in a&&(c=a.get(m,"value"))!==void 0?c:typeof(c=m.value)=="string"?c.replace(vo,""):c??"":void 0}}),p.extend({valHooks:{option:{get:function(s){var a=p.find.attr(s,"value");return a??je(p.text(s))}},select:{get:function(s){var a,c,f,m=s.options,v=s.selectedIndex,x=s.type==="select-one",D=x?null:[],A=x?v+1:m.length;for(f=v<0?A:x?v:0;f<A;f++)if(((c=m[f]).selected||f===v)&&!c.disabled&&(!c.parentNode.disabled||!It(c.parentNode,"optgroup"))){if(a=p(c).val(),x)return a;D.push(a)}return D},set:function(s,a){for(var c,f,m=s.options,v=p.makeArray(a),x=m.length;x--;)((f=m[x]).selected=-1<p.inArray(p.valHooks.option.get(f),v))&&(c=!0);return c||(s.selectedIndex=-1),v}}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]={set:function(s,a){if(Array.isArray(a))return s.checked=-1<p.inArray(p(s).val(),a)}},dt.checkOn||(p.valHooks[this].get=function(s){return s.getAttribute("value")===null?"on":s.value})});var qi=ct.location,_r={guid:Date.now()},xr=/\?/;p.parseXML=function(s){var a,c;if(!s||typeof s!="string")return null;try{a=new ct.DOMParser().parseFromString(s,"text/xml")}catch{}return c=a&&a.getElementsByTagName("parsererror")[0],a&&!c||p.error("Invalid XML: "+(c?p.map(c.childNodes,function(f){return f.textContent}).join(`
`):s)),a};var _s=/^(?:focusinfocus|focusoutblur)$/,Wi=function(s){s.stopPropagation()};p.extend(p.event,{trigger:function(s,a,c,f){var m,v,x,D,A,O,M,L,E=[c||ut],z=sn.call(s,"type")?s.type:s,Y=sn.call(s,"namespace")?s.namespace.split("."):[];if(v=L=x=c=c||ut,c.nodeType!==3&&c.nodeType!==8&&!_s.test(z+p.event.triggered)&&(-1<z.indexOf(".")&&(z=(Y=z.split(".")).shift(),Y.sort()),A=z.indexOf(":")<0&&"on"+z,(s=s[p.expando]?s:new p.Event(z,typeof s=="object"&&s)).isTrigger=f?2:3,s.namespace=Y.join("."),s.rnamespace=s.namespace?new RegExp("(^|\\.)"+Y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,s.result=void 0,s.target||(s.target=c),a=a==null?[s]:p.makeArray(a,[s]),M=p.event.special[z]||{},f||!M.trigger||M.trigger.apply(c,a)!==!1)){if(!f&&!M.noBubble&&!ri(c)){for(D=M.delegateType||z,_s.test(D+z)||(v=v.parentNode);v;v=v.parentNode)E.push(v),x=v;x===(c.ownerDocument||ut)&&E.push(x.defaultView||x.parentWindow||ct)}for(m=0;(v=E[m++])&&!s.isPropagationStopped();)L=v,s.type=1<m?D:M.bindType||z,(O=(X.get(v,"events")||Object.create(null))[s.type]&&X.get(v,"handle"))&&O.apply(v,a),(O=A&&v[A])&&O.apply&&an(v)&&(s.result=O.apply(v,a),s.result===!1&&s.preventDefault());return s.type=z,f||s.isDefaultPrevented()||M._default&&M._default.apply(E.pop(),a)!==!1||!an(c)||A&&ft(c[z])&&!ri(c)&&((x=c[A])&&(c[A]=null),p.event.triggered=z,s.isPropagationStopped()&&L.addEventListener(z,Wi),c[z](),s.isPropagationStopped()&&L.removeEventListener(z,Wi),p.event.triggered=void 0,x&&(c[A]=x)),s.result}},simulate:function(s,a,c){var f=p.extend(new p.Event,c,{type:s,isSimulated:!0});p.event.trigger(f,null,a)}}),p.fn.extend({trigger:function(s,a){return this.each(function(){p.event.trigger(s,a,this)})},triggerHandler:function(s,a){var c=this[0];if(c)return p.event.trigger(s,a,c,!0)}});var _o=/\[\]$/,xs=/\r?\n/g,ys=/^(?:submit|button|image|reset|file)$/i,Ts=/^(?:input|select|textarea|keygen)/i;function Vi(s,a,c,f){var m;if(Array.isArray(a))p.each(a,function(v,x){c||_o.test(s)?f(s,x):Vi(s+"["+(typeof x=="object"&&x!=null?v:"")+"]",x,c,f)});else if(c||si(a)!=="object")f(s,a);else for(m in a)Vi(s+"["+m+"]",a[m],c,f)}p.param=function(s,a){var c,f=[],m=function(v,x){var D=ft(x)?x():x;f[f.length]=encodeURIComponent(v)+"="+encodeURIComponent(D??"")};if(s==null)return"";if(Array.isArray(s)||s.jquery&&!p.isPlainObject(s))p.each(s,function(){m(this.name,this.value)});else for(c in s)Vi(c,s[c],a,m);return f.join("&")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var s=p.prop(this,"elements");return s?p.makeArray(s):this}).filter(function(){var s=this.type;return this.name&&!p(this).is(":disabled")&&Ts.test(this.nodeName)&&!ys.test(s)&&(this.checked||!ji.test(s))}).map(function(s,a){var c=p(this).val();return c==null?null:Array.isArray(c)?p.map(c,function(f){return{name:a.name,value:f.replace(xs,`\r
`)}}):{name:a.name,value:c.replace(xs,`\r
`)}}).get()}});var ws=/%20/g,As=/#.*$/,xo=/([?&])_=[^&]*/,Es=/^(.*?):[ \t]*([^\r\n]*)$/gm,yo=/^(?:GET|HEAD)$/,To=/^\/\//,Cs={},yr={},Ss="*/".concat("*"),Tr=ut.createElement("a");function wr(s){return function(a,c){typeof a!="string"&&(c=a,a="*");var f,m=0,v=a.toLowerCase().match(Pe)||[];if(ft(c))for(;f=v[m++];)f[0]==="+"?(f=f.slice(1)||"*",(s[f]=s[f]||[]).unshift(c)):(s[f]=s[f]||[]).push(c)}}function Ze(s,a,c,f){var m={},v=s===yr;function x(D){var A;return m[D]=!0,p.each(s[D]||[],function(O,M){var L=M(a,c,f);return typeof L!="string"||v||m[L]?v?!(A=L):void 0:(a.dataTypes.unshift(L),x(L),!1)}),A}return x(a.dataTypes[0])||!m["*"]&&x("*")}function Ar(s,a){var c,f,m=p.ajaxSettings.flatOptions||{};for(c in a)a[c]!==void 0&&((m[c]?s:f||(f={}))[c]=a[c]);return f&&p.extend(!0,s,f),s}Tr.href=qi.href,p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:qi.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(qi.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ss,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(s,a){return a?Ar(Ar(s,p.ajaxSettings),a):Ar(p.ajaxSettings,s)},ajaxPrefilter:wr(Cs),ajaxTransport:wr(yr),ajax:function(s,a){typeof s=="object"&&(a=s,s=void 0),a=a||{};var c,f,m,v,x,D,A,O,M,L,E=p.ajaxSetup({},a),z=E.context||E,Y=E.context&&(z.nodeType||z.jquery)?p(z):p.event,tt=p.Deferred(),nt=p.Callbacks("once memory"),Pt=E.statusCode||{},Gt={},de={},gt="canceled",bt={readyState:0,getResponseHeader:function(Tt){var Mt;if(A){if(!v)for(v={};Mt=Es.exec(m);)v[Mt[1].toLowerCase()+" "]=(v[Mt[1].toLowerCase()+" "]||[]).concat(Mt[2]);Mt=v[Tt.toLowerCase()+" "]}return Mt==null?null:Mt.join(", ")},getAllResponseHeaders:function(){return A?m:null},setRequestHeader:function(Tt,Mt){return A==null&&(Tt=de[Tt.toLowerCase()]=de[Tt.toLowerCase()]||Tt,Gt[Tt]=Mt),this},overrideMimeType:function(Tt){return A==null&&(E.mimeType=Tt),this},statusCode:function(Tt){var Mt;if(Tt)if(A)bt.always(Tt[bt.status]);else for(Mt in Tt)Pt[Mt]=[Pt[Mt],Tt[Mt]];return this},abort:function(Tt){var Mt=Tt||gt;return c&&c.abort(Mt),Te(0,Mt),this}};if(tt.promise(bt),E.url=((s||E.url||qi.href)+"").replace(To,qi.protocol+"//"),E.type=a.method||a.type||E.method||E.type,E.dataTypes=(E.dataType||"*").toLowerCase().match(Pe)||[""],E.crossDomain==null){D=ut.createElement("a");try{D.href=E.url,D.href=D.href,E.crossDomain=Tr.protocol+"//"+Tr.host!=D.protocol+"//"+D.host}catch{E.crossDomain=!0}}if(E.data&&E.processData&&typeof E.data!="string"&&(E.data=p.param(E.data,E.traditional)),Ze(Cs,E,a,bt),A)return bt;for(M in(O=p.event&&E.global)&&p.active++==0&&p.event.trigger("ajaxStart"),E.type=E.type.toUpperCase(),E.hasContent=!yo.test(E.type),f=E.url.replace(As,""),E.hasContent?E.data&&E.processData&&(E.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(E.data=E.data.replace(ws,"+")):(L=E.url.slice(f.length),E.data&&(E.processData||typeof E.data=="string")&&(f+=(xr.test(f)?"&":"?")+E.data,delete E.data),E.cache===!1&&(f=f.replace(xo,"$1"),L=(xr.test(f)?"&":"?")+"_="+_r.guid+++L),E.url=f+L),E.ifModified&&(p.lastModified[f]&&bt.setRequestHeader("If-Modified-Since",p.lastModified[f]),p.etag[f]&&bt.setRequestHeader("If-None-Match",p.etag[f])),(E.data&&E.hasContent&&E.contentType!==!1||a.contentType)&&bt.setRequestHeader("Content-Type",E.contentType),bt.setRequestHeader("Accept",E.dataTypes[0]&&E.accepts[E.dataTypes[0]]?E.accepts[E.dataTypes[0]]+(E.dataTypes[0]!=="*"?", "+Ss+"; q=0.01":""):E.accepts["*"]),E.headers)bt.setRequestHeader(M,E.headers[M]);if(E.beforeSend&&(E.beforeSend.call(z,bt,E)===!1||A))return bt.abort();if(gt="abort",nt.add(E.complete),bt.done(E.success),bt.fail(E.error),c=Ze(yr,E,a,bt)){if(bt.readyState=1,O&&Y.trigger("ajaxSend",[bt,E]),A)return bt;E.async&&0<E.timeout&&(x=ct.setTimeout(function(){bt.abort("timeout")},E.timeout));try{A=!1,c.send(Gt,Te)}catch(Tt){if(A)throw Tt;Te(-1,Tt)}}else Te(-1,"No Transport");function Te(Tt,Mt,Ei,Ln){var De,Fe,ue,ci,Xi,Ie=Mt;A||(A=!0,x&&ct.clearTimeout(x),c=void 0,m=Ln||"",bt.readyState=0<Tt?4:0,De=200<=Tt&&Tt<300||Tt===304,Ei&&(ci=function(rt,Ot,se){for(var $t,oe,it,st,xt=rt.contents,At=rt.dataTypes;At[0]==="*";)At.shift(),$t===void 0&&($t=rt.mimeType||Ot.getResponseHeader("Content-Type"));if($t){for(oe in xt)if(xt[oe]&&xt[oe].test($t)){At.unshift(oe);break}}if(At[0]in se)it=At[0];else{for(oe in se){if(!At[0]||rt.converters[oe+" "+At[0]]){it=oe;break}st||(st=oe)}it=it||st}if(it)return it!==At[0]&&At.unshift(it),se[it]}(E,bt,Ei)),!De&&-1<p.inArray("script",E.dataTypes)&&p.inArray("json",E.dataTypes)<0&&(E.converters["text script"]=function(){}),ci=function(rt,Ot,se,$t){var oe,it,st,xt,At,Oe={},Ci=rt.dataTypes.slice();if(Ci[1])for(st in rt.converters)Oe[st.toLowerCase()]=rt.converters[st];for(it=Ci.shift();it;)if(rt.responseFields[it]&&(se[rt.responseFields[it]]=Ot),!At&&$t&&rt.dataFilter&&(Ot=rt.dataFilter(Ot,rt.dataType)),At=it,it=Ci.shift()){if(it==="*")it=At;else if(At!=="*"&&At!==it){if(!(st=Oe[At+" "+it]||Oe["* "+it])){for(oe in Oe)if((xt=oe.split(" "))[1]===it&&(st=Oe[At+" "+xt[0]]||Oe["* "+xt[0]])){st===!0?st=Oe[oe]:Oe[oe]!==!0&&(it=xt[0],Ci.unshift(xt[1]));break}}if(st!==!0)if(st&&rt.throws)Ot=st(Ot);else try{Ot=st(Ot)}catch(zn){return{state:"parsererror",error:st?zn:"No conversion from "+At+" to "+it}}}}return{state:"success",data:Ot}}(E,ci,bt,De),De?(E.ifModified&&((Xi=bt.getResponseHeader("Last-Modified"))&&(p.lastModified[f]=Xi),(Xi=bt.getResponseHeader("etag"))&&(p.etag[f]=Xi)),Tt===204||E.type==="HEAD"?Ie="nocontent":Tt===304?Ie="notmodified":(Ie=ci.state,Fe=ci.data,De=!(ue=ci.error))):(ue=Ie,!Tt&&Ie||(Ie="error",Tt<0&&(Tt=0))),bt.status=Tt,bt.statusText=(Mt||Ie)+"",De?tt.resolveWith(z,[Fe,Ie,bt]):tt.rejectWith(z,[bt,Ie,ue]),bt.statusCode(Pt),Pt=void 0,O&&Y.trigger(De?"ajaxSuccess":"ajaxError",[bt,E,De?Fe:ue]),nt.fireWith(z,[bt,Ie]),O&&(Y.trigger("ajaxComplete",[bt,E]),--p.active||p.event.trigger("ajaxStop")))}return bt},getJSON:function(s,a,c){return p.get(s,a,c,"json")},getScript:function(s,a){return p.get(s,void 0,a,"script")}}),p.each(["get","post"],function(s,a){p[a]=function(c,f,m,v){return ft(f)&&(v=v||m,m=f,f=void 0),p.ajax(p.extend({url:c,type:a,dataType:v,data:f,success:m},p.isPlainObject(c)&&c))}}),p.ajaxPrefilter(function(s){var a;for(a in s.headers)a.toLowerCase()==="content-type"&&(s.contentType=s.headers[a]||"")}),p._evalUrl=function(s,a,c){return p.ajax({url:s,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(f){p.globalEval(f,a,c)}})},p.fn.extend({wrapAll:function(s){var a;return this[0]&&(ft(s)&&(s=s.call(this[0])),a=p(s,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&a.insertBefore(this[0]),a.map(function(){for(var c=this;c.firstElementChild;)c=c.firstElementChild;return c}).append(this)),this},wrapInner:function(s){return ft(s)?this.each(function(a){p(this).wrapInner(s.call(this,a))}):this.each(function(){var a=p(this),c=a.contents();c.length?c.wrapAll(s):a.append(s)})},wrap:function(s){var a=ft(s);return this.each(function(c){p(this).wrapAll(a?s.call(this,c):s)})},unwrap:function(s){return this.parent(s).not("body").each(function(){p(this).replaceWith(this.childNodes)}),this}}),p.expr.pseudos.hidden=function(s){return!p.expr.pseudos.visible(s)},p.expr.pseudos.visible=function(s){return!!(s.offsetWidth||s.offsetHeight||s.getClientRects().length)},p.ajaxSettings.xhr=function(){try{return new ct.XMLHttpRequest}catch{}};var Er={0:200,1223:204},gn=p.ajaxSettings.xhr();dt.cors=!!gn&&"withCredentials"in gn,dt.ajax=gn=!!gn,p.ajaxTransport(function(s){var a,c;if(dt.cors||gn&&!s.crossDomain)return{send:function(f,m){var v,x=s.xhr();if(x.open(s.type,s.url,s.async,s.username,s.password),s.xhrFields)for(v in s.xhrFields)x[v]=s.xhrFields[v];for(v in s.mimeType&&x.overrideMimeType&&x.overrideMimeType(s.mimeType),s.crossDomain||f["X-Requested-With"]||(f["X-Requested-With"]="XMLHttpRequest"),f)x.setRequestHeader(v,f[v]);a=function(D){return function(){a&&(a=c=x.onload=x.onerror=x.onabort=x.ontimeout=x.onreadystatechange=null,D==="abort"?x.abort():D==="error"?typeof x.status!="number"?m(0,"error"):m(x.status,x.statusText):m(Er[x.status]||x.status,x.statusText,(x.responseType||"text")!=="text"||typeof x.responseText!="string"?{binary:x.response}:{text:x.responseText},x.getAllResponseHeaders()))}},x.onload=a(),c=x.onerror=x.ontimeout=a("error"),x.onabort!==void 0?x.onabort=c:x.onreadystatechange=function(){x.readyState===4&&ct.setTimeout(function(){a&&c()})},a=a("abort");try{x.send(s.hasContent&&s.data||null)}catch(D){if(a)throw D}},abort:function(){a&&a()}}}),p.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(s){return p.globalEval(s),s}}}),p.ajaxPrefilter("script",function(s){s.cache===void 0&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),p.ajaxTransport("script",function(s){var a,c;if(s.crossDomain||s.scriptAttrs)return{send:function(f,m){a=p("<script>").attr(s.scriptAttrs||{}).prop({charset:s.scriptCharset,src:s.url}).on("load error",c=function(v){a.remove(),c=null,v&&m(v.type==="error"?404:200,v.type)}),ut.head.appendChild(a[0])},abort:function(){c&&c()}}});var Ai,Cr=[],Nn=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var s=Cr.pop()||p.expando+"_"+_r.guid++;return this[s]=!0,s}}),p.ajaxPrefilter("json jsonp",function(s,a,c){var f,m,v,x=s.jsonp!==!1&&(Nn.test(s.url)?"url":typeof s.data=="string"&&(s.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Nn.test(s.data)&&"data");if(x||s.dataTypes[0]==="jsonp")return f=s.jsonpCallback=ft(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,x?s[x]=s[x].replace(Nn,"$1"+f):s.jsonp!==!1&&(s.url+=(xr.test(s.url)?"&":"?")+s.jsonp+"="+f),s.converters["script json"]=function(){return v||p.error(f+" was not called"),v[0]},s.dataTypes[0]="json",m=ct[f],ct[f]=function(){v=arguments},c.always(function(){m===void 0?p(ct).removeProp(f):ct[f]=m,s[f]&&(s.jsonpCallback=a.jsonpCallback,Cr.push(f)),v&&ft(m)&&m(v[0]),v=m=void 0}),"script"}),dt.createHTMLDocument=((Ai=ut.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",Ai.childNodes.length===2),p.parseHTML=function(s,a,c){return typeof s!="string"?[]:(typeof a=="boolean"&&(c=a,a=!1),a||(dt.createHTMLDocument?((f=(a=ut.implementation.createHTMLDocument("")).createElement("base")).href=ut.location.href,a.head.appendChild(f)):a=ut),v=!c&&[],(m=sr.exec(s))?[a.createElement(m[1])]:(m=cr([s],a,v),v&&v.length&&p(v).remove(),p.merge([],m.childNodes)));var f,m,v},p.fn.load=function(s,a,c){var f,m,v,x=this,D=s.indexOf(" ");return-1<D&&(f=je(s.slice(D)),s=s.slice(0,D)),ft(a)?(c=a,a=void 0):a&&typeof a=="object"&&(m="POST"),0<x.length&&p.ajax({url:s,type:m||"GET",dataType:"html",data:a}).done(function(A){v=arguments,x.html(f?p("<div>").append(p.parseHTML(A)).find(f):A)}).always(c&&function(A,O){x.each(function(){c.apply(this,v||[A.responseText,O,A])})}),this},p.expr.pseudos.animated=function(s){return p.grep(p.timers,function(a){return s===a.elem}).length},p.offset={setOffset:function(s,a,c){var f,m,v,x,D,A,O=p.css(s,"position"),M=p(s),L={};O==="static"&&(s.style.position="relative"),D=M.offset(),v=p.css(s,"top"),A=p.css(s,"left"),(O==="absolute"||O==="fixed")&&-1<(v+A).indexOf("auto")?(x=(f=M.position()).top,m=f.left):(x=parseFloat(v)||0,m=parseFloat(A)||0),ft(a)&&(a=a.call(s,c,p.extend({},D))),a.top!=null&&(L.top=a.top-D.top+x),a.left!=null&&(L.left=a.left-D.left+m),"using"in a?a.using.call(s,L):M.css(L)}},p.fn.extend({offset:function(s){if(arguments.length)return s===void 0?this:this.each(function(m){p.offset.setOffset(this,s,m)});var a,c,f=this[0];return f?f.getClientRects().length?(a=f.getBoundingClientRect(),c=f.ownerDocument.defaultView,{top:a.top+c.pageYOffset,left:a.left+c.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var s,a,c,f=this[0],m={top:0,left:0};if(p.css(f,"position")==="fixed")a=f.getBoundingClientRect();else{for(a=this.offset(),c=f.ownerDocument,s=f.offsetParent||c.documentElement;s&&(s===c.body||s===c.documentElement)&&p.css(s,"position")==="static";)s=s.parentNode;s&&s!==f&&s.nodeType===1&&((m=p(s).offset()).top+=p.css(s,"borderTopWidth",!0),m.left+=p.css(s,"borderLeftWidth",!0))}return{top:a.top-m.top-p.css(f,"marginTop",!0),left:a.left-m.left-p.css(f,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var s=this.offsetParent;s&&p.css(s,"position")==="static";)s=s.offsetParent;return s||oi})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(s,a){var c=a==="pageYOffset";p.fn[s]=function(f){return Ve(this,function(m,v,x){var D;if(ri(m)?D=m:m.nodeType===9&&(D=m.defaultView),x===void 0)return D?D[a]:m[v];D?D.scrollTo(c?D.pageXOffset:x,c?x:D.pageYOffset):m[v]=x},s,f,arguments.length)}}),p.each(["top","left"],function(s,a){p.cssHooks[a]=fs(dt.pixelPosition,function(c,f){if(f)return f=dn(c,a),Hi.test(f)?p(c).position()[a]+"px":f})}),p.each({Height:"height",Width:"width"},function(s,a){p.each({padding:"inner"+s,content:a,"":"outer"+s},function(c,f){p.fn[f]=function(m,v){var x=arguments.length&&(c||typeof m!="boolean"),D=c||(m===!0||v===!0?"margin":"border");return Ve(this,function(A,O,M){var L;return ri(A)?f.indexOf("outer")===0?A["inner"+s]:A.document.documentElement["client"+s]:A.nodeType===9?(L=A.documentElement,Math.max(A.body["scroll"+s],L["scroll"+s],A.body["offset"+s],L["offset"+s],L["client"+s])):M===void 0?p.css(A,O,D):p.style(A,O,M,D)},a,x?m:void 0,x)}})}),p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(s,a){p.fn[a]=function(c){return this.on(a,c)}}),p.fn.extend({bind:function(s,a,c){return this.on(s,null,a,c)},unbind:function(s,a){return this.off(s,null,a)},delegate:function(s,a,c,f){return this.on(a,s,c,f)},undelegate:function(s,a,c){return arguments.length===1?this.off(s,"**"):this.off(a,s||"**",c)},hover:function(s,a){return this.on("mouseenter",s).on("mouseleave",a||s)}}),p.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(s,a){p.fn[a]=function(c,f){return 0<arguments.length?this.on(a,null,c,f):this.trigger(a)}});var wo=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;p.proxy=function(s,a){var c,f,m;if(typeof a=="string"&&(c=s[a],a=s,s=c),ft(s))return f=ge.call(arguments,2),(m=function(){return s.apply(a||this,f.concat(ge.call(arguments)))}).guid=s.guid=s.guid||p.guid++,m},p.holdReady=function(s){s?p.readyWait++:p.ready(!0)},p.isArray=Array.isArray,p.parseJSON=JSON.parse,p.nodeName=It,p.isFunction=ft,p.isWindow=ri,p.camelCase=Be,p.type=si,p.now=Date.now,p.isNumeric=function(s){var a=p.type(s);return(a==="number"||a==="string")&&!isNaN(s-parseFloat(s))},p.trim=function(s){return s==null?"":(s+"").replace(wo,"$1")},typeof define=="function"&&define.amd&&define("jquery",[],function(){return p});var jn=ct.jQuery,Sr=ct.$;return p.noConflict=function(s){return ct.$===p&&(ct.$=Sr),s&&ct.jQuery===p&&(ct.jQuery=jn),p},typeof ni>"u"&&(ct.jQuery=ct.$=p),p});/*! For license information please see viewer.min.js.LICENSE.txt */(()=>{"use strict";var ct,ni;window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)},jQuery.support.cors=!0,$.ajaxTransport?($.ajaxSetup({flatOptions:{renderer:!0}}),$.ajaxTransport("+binary",function(t,e,i){if(window.FormData&&(t.dataType&&t.dataType=="binary"||t.data&&(window.ArrayBuffer&&t.data instanceof ArrayBuffer||window.Blob&&t.data instanceof Blob)))return{send:function(n,r){var o=new XMLHttpRequest,l=t.url,h=t.type,d=t.responseType||"blob",u=t.data||null;t.renderer&&o.addEventListener("progress",function(g){g.lengthComputable&&(t.renderer.downloads[this.responseURL]?t.renderer.downloads[this.responseURL].loaded=g.loaded:t.renderer.downloads[this.responseURL]={loaded:g.loaded,total:g.total},t.renderer.updateProgress())}),o.addEventListener("load",function(){t.renderer&&(delete t.renderer.downloads[this.responseURL],t.renderer.updateProgress());var g={};g[t.dataType]=o.response,r(o.status,o.statusText,g,o.getAllResponseHeaders())}),o.open(h,l,!0),o.responseType=d,o.send(u)},abort:function(){i.abort()}}})):(ct=$.httpData,$.httpData=function(t,e,i){return e=="binary"?t.response:ct(t,e,i)},$.ajaxSetup({beforeSend:function(t,e){e.dataType=="binary"&&(t.responseType=e.responseType||"arraybuffer",t.addEventListener("progress",function(i){e.renderer&&i.lengthComputable&&(e.renderer.downloads[this.responseURL]?e.renderer.downloads[this.responseURL].loaded=i.loaded:e.renderer.downloads[this.responseURL]={loaded:i.loaded,total:i.total},e.renderer.updateProgress())},!1),t.addEventListener("load",function(){e.renderer&&(delete e.renderer.downloads[this.responseURL],e.renderer.updateProgress())},!1))}})),Math.randomInt=Math.randomInt||function(t,e){return Math.floor(Math.random()*(e-t))+t},typeof Object.create!="function"&&(Object.create=(ni=function(){},function(t){if(arguments.length>1)throw Error("Second argument not supported");if(typeof t!="object")throw TypeError("Argument must be an object");ni.prototype=t;var e=new ni;return ni.prototype=null,e})),window.console=window.console||{log:function(){},error:function(){},warn:function(){}};let Xt=Float32Array;function En(t,e,i){const n=new Xt(3);return t&&(n[0]=t),e&&(n[1]=e),i&&(n[2]=i),n}function ge(t,e,i){return(i=i||new Xt(3))[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i}function Jr(t,e,i){return(i=i||new Xt(3))[0]=t[0]*e[0],i[1]=t[1]*e[1],i[2]=t[2]*e[2],i}let rn=Float32Array;function qe(t){return(t=t||new rn(16))[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Cn(t,e){e=e||new rn(16);const i=t[0],n=t[1],r=t[2],o=t[3],l=t[4],h=t[5],d=t[6],u=t[7],g=t[8],b=t[9],_=t[10],y=t[11],I=t[12],S=t[13],k=t[14],U=t[15],G=_*U,F=k*y,P=d*U,T=k*u,C=d*y,N=_*u,V=r*U,W=k*o,J=r*y,at=_*o,St=r*u,Ut=d*o,vt=g*S,ee=I*b,le=l*S,be=I*h,ve=l*b,_e=g*h,xe=i*S,Ge=I*n,Wt=i*b,ei=g*n,bi=i*h,vi=l*n,Qi=G*h+T*b+C*S-(F*h+P*b+N*S),tn=F*n+V*b+at*S-(G*n+W*b+J*S),en=P*n+W*h+St*S-(T*n+V*h+Ut*S),nn=N*n+J*h+Ut*b-(C*n+at*h+St*b),Vt=1/(i*Qi+l*tn+g*en+I*nn);return e[0]=Vt*Qi,e[1]=Vt*tn,e[2]=Vt*en,e[3]=Vt*nn,e[4]=Vt*(F*l+P*g+N*I-(G*l+T*g+C*I)),e[5]=Vt*(G*i+W*g+J*I-(F*i+V*g+at*I)),e[6]=Vt*(T*i+V*l+Ut*I-(P*i+W*l+St*I)),e[7]=Vt*(C*i+at*l+St*g-(N*i+J*l+Ut*g)),e[8]=Vt*(vt*u+be*y+ve*U-(ee*u+le*y+_e*U)),e[9]=Vt*(ee*o+xe*y+ei*U-(vt*o+Ge*y+Wt*U)),e[10]=Vt*(le*o+Ge*u+bi*U-(be*o+xe*u+vi*U)),e[11]=Vt*(_e*o+Wt*u+vi*y-(ve*o+ei*u+bi*y)),e[12]=Vt*(le*_+_e*k+ee*d-(ve*k+vt*d+be*_)),e[13]=Vt*(Wt*k+vt*r+Ge*_-(xe*_+ei*k+ee*r)),e[14]=Vt*(xe*d+vi*k+be*r-(bi*k+le*r+Ge*d)),e[15]=Vt*(bi*_+ve*r+ei*d-(Wt*d+vi*_+_e*r)),e}function Kr(t,e,i){i=i||En();const n=e[0],r=e[1],o=e[2],l=n*t[3]+r*t[7]+o*t[11]+t[15];return i[0]=(n*t[0]+r*t[4]+o*t[8]+t[12])/l,i[1]=(n*t[1]+r*t[5]+o*t[9]+t[13])/l,i[2]=(n*t[2]+r*t[6]+o*t[10]+t[14])/l,i}function sn(t,e,i){i=i||En();const n=e[0],r=e[1],o=e[2];return i[0]=n*t[0]+r*t[4]+o*t[8],i[1]=n*t[1]+r*t[5]+o*t[9],i[2]=n*t[2]+r*t[6]+o*t[10],i}const Sn=5120,on=5121,dt=5122,ft=5123,ri=5124,ut=5125,tr=5126,er={};{const t=er;t[Sn]=Int8Array,t[on]=Uint8Array,t[dt]=Int16Array,t[ft]=Uint16Array,t[ri]=Int32Array,t[ut]=Uint32Array,t[tr]=Float32Array,t[32819]=Uint16Array,t[32820]=Uint16Array,t[33635]=Uint16Array,t[5131]=Uint16Array,t[33640]=Uint32Array,t[35899]=Uint32Array,t[35902]=Uint32Array,t[36269]=Uint32Array,t[34042]=Uint32Array}function si(t){if(t instanceof Int8Array)return Sn;if(t instanceof Uint8Array||t instanceof Uint8ClampedArray)return on;if(t instanceof Int16Array)return dt;if(t instanceof Uint16Array)return ft;if(t instanceof Int32Array)return ri;if(t instanceof Uint32Array)return ut;if(t instanceof Float32Array)return tr;throw new Error("unsupported typed array type")}function ir(t){if(t===Int8Array)return Sn;if(t===Uint8Array||t===Uint8ClampedArray)return on;if(t===Int16Array)return dt;if(t===Uint16Array)return ft;if(t===Int32Array)return ri;if(t===Uint32Array)return ut;if(t===Float32Array)return tr;throw new Error("unsupported typed array type")}function Qs(t){const e=er[t];if(!e)throw new Error("unknown gl type");return e}const p=typeof SharedArrayBuffer<"u"?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};function nr(...t){console.error(...t)}const It=new Map;function Qr(t,e){if(!t||typeof t!="object")return!1;let i=It.get(e);i||(i=new WeakMap,It.set(e,i));let n=i.get(t);if(n===void 0){const r=Object.prototype.toString.call(t);n=r.substring(8,r.length-1)===e,i.set(t,n)}return n}function ts(t,e){return typeof WebGLTexture<"u"&&Qr(e,"WebGLTexture")}const es=35044,_t=34962,Pi=34963,to=34660,eo=5120,We=5121,rr=5122,Bi=5123,is=5124,ns=5125,sr=5126,Mn={attribPrefix:""};function rs(t,e,i,n,r){t.bindBuffer(e,i),t.bufferData(e,n,r||es)}function or(t,e,i,n){if(r=e,typeof WebGLBuffer<"u"&&Qr(r,"WebGLBuffer"))return e;var r;i=i||_t;const o=t.createBuffer();return rs(t,i,o,e,n),o}function ss(t){return t==="indices"}function os(t){return t.length?t:t.data}const as=/coord|texture/i,Pe=/color|colour/i;function _i(t,e,i){return t.numComponents||t.size||function(n,r){let o;if(o=as.test(n)?2:Pe.test(n)?4:3,r%o>0)throw new Error(`Can not guess numComponents for attribute '${n}'. Tried ${o} but ${r} values is not evenly divisible by ${o}. You should specify it.`);return o}(e,i||os(t).length)}function xi(t,e){if(p(t))return t;if(p(t.data))return t.data;Array.isArray(t)&&(t={data:t});let i=t.type?kn(t.type):void 0;return i||(i=ss(e)?Uint16Array:Float32Array),new i(t.data)}function kn(t){return typeof t=="number"?Qs(t):t||Float32Array}function io(t,e){return{buffer:e.buffer,numValues:24,type:(i=e.type,typeof i=="number"?i:i?ir(i):sr),arrayType:kn(e.type)};var i}function ar(t,e){const i=e.data||e,n=kn(e.type),r=i*n.BYTES_PER_ELEMENT,o=t.createBuffer();return t.bindBuffer(_t,o),t.bufferData(_t,r,e.drawType||es),{buffer:o,numValues:i,type:ir(n),arrayType:n}}function Dn(t,e,i){const n=xi(e,i);return{arrayType:n.constructor,buffer:or(t,n,void 0,e.drawType),type:si(n),numValues:0}}function Ve(t,e){const i={};return Object.keys(e).forEach(function(n){if(!ss(n)){const o=e[n],l=o.attrib||o.name||o.attribName||Mn.attribPrefix+n;if(o.value){if(!Array.isArray(o.value)&&!p(o.value))throw new Error("array.value is not array or typedarray");i[l]={value:o.value}}else{let h;h=o.buffer&&o.buffer instanceof WebGLBuffer?io:typeof o=="number"||typeof o.data=="number"?ar:Dn;const{buffer:d,type:u,numValues:g,arrayType:b}=h(t,o,n),_=o.normalize!==void 0?o.normalize:(r=b)===Int8Array||r===Uint8Array,y=_i(o,n,g);i[l]={buffer:d,numComponents:y,type:u,normalize:_,stride:o.stride||0,offset:o.offset||0,divisor:o.divisor===void 0?void 0:o.divisor,drawType:o.drawType}}}var r}),t.bindBuffer(_t,null),i}const Ni=["position","positions","a_position"];function no(t,e){let i,n;for(n=0;n<Ni.length&&(i=Ni[n],!(i in e))&&(i=Mn.attribPrefix+i,!(i in e));++n);n===Ni.length&&(i=Object.keys(e)[0]);const r=e[i];if(!r.buffer)return 1;t.bindBuffer(_t,r.buffer);const o=t.getBufferParameter(_t,to);t.bindBuffer(_t,null);var l;const h=o/((l=r.type)===eo||l===We?1:l===rr||l===Bi?2:l===is||l===ns||l===sr?4:0),d=r.numComponents||r.size,u=h/d;if(u%1!=0)throw new Error(`numComponents ${d} not correct for length ${length}`);return u}function ro(t,e,i){const n=Ve(t,e),r=Object.assign({},i||{});r.attribs=Object.assign({},i?i.attribs:{},n);const o=e.indices;if(o){const l=xi(o,"indices");r.indices=or(t,l,Pi),r.numElements=l.length,r.elementType=si(l)}else r.numElements||(r.numElements=no(t,r.attribs));return r}function Be(t,e,i){const n=i==="indices"?Pi:_t;return or(t,xi(e,i),n)}function an(t,e){const i={};return Object.keys(e).forEach(function(n){i[n]=Be(t,e[n],n)}),e.indices?(i.numElements=e.indices.length,i.elementType=si(xi(e.indices))):i.numElements=function(n){let r,o;for(o=0;o<Ni.length&&(r=Ni[o],!(r in n));++o);o===Ni.length&&(r=Object.keys(n)[0]);const l=n[r],h=os(l).length;if(h===void 0)return 1;const d=_i(l,r),u=h/d;if(h%d>0)throw new Error(`numComponents ${d} not correct for length ${h}`);return u}(e),i}function hn(t,e){let i=0;return t.push=function(){for(let n=0;n<arguments.length;++n){const r=arguments[n];if(r instanceof Array||p(r))for(let o=0;o<r.length;++o)t[i++]=r[o];else t[i++]=r}},t.reset=function(n){i=n||0},t.numComponents=e,Object.defineProperty(t,"numElements",{get:function(){return this.length/this.numComponents|0}}),t}function X(t,e,i){return hn(new(i||Float32Array)(t*e),t)}function ie(t,e,i){const n=t.length,r=new Float32Array(3);for(let o=0;o<n;o+=3)i(e,[t[o],t[o+1],t[o+2]],r),t[o]=r[0],t[o+1]=r[1],t[o+2]=r[2]}function so(t,e,i){i=i||En();const n=e[0],r=e[1],o=e[2];return i[0]=n*t[0]+r*t[1]+o*t[2],i[1]=n*t[4]+r*t[5]+o*t[6],i[2]=n*t[8]+r*t[9]+o*t[10],i}function oo(t,e){return ie(t,e,sn),t}function hs(t,e){return ie(t,Cn(e),so),t}function ls(t,e){return ie(t,e,Kr),t}function ln(t,e){return Object.keys(t).forEach(function(i){const n=t[i];i.indexOf("pos")>=0?ls(n,e):i.indexOf("tan")>=0||i.indexOf("binorm")>=0?oo(n,e):i.indexOf("norm")>=0&&hs(n,e)}),t}function Ne(t,e,i){return t=t||2,{position:{numComponents:2,data:[(e=e||0)+-1*(t*=.5),(i=i||0)+-1*t,e+1*t,i+-1*t,e+-1*t,i+1*t,e+1*t,i+1*t]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function oi(t,e,i,n,r){t=t||1,e=e||1,i=i||1,n=n||1,r=r||qe();const o=(i+1)*(n+1),l=X(3,o),h=X(3,o),d=X(2,o);for(let b=0;b<=n;b++)for(let _=0;_<=i;_++){const y=_/i,I=b/n;l.push(t*y-.5*t,0,e*I-.5*e),h.push(0,1,0),d.push(y,I)}const u=i+1,g=X(3,i*n*2,Uint16Array);for(let b=0;b<n;b++)for(let _=0;_<i;_++)g.push((b+0)*u+_,(b+1)*u+_,(b+0)*u+_+1),g.push((b+1)*u+_,(b+1)*u+_+1,(b+0)*u+_+1);return ln({position:l,normal:h,texcoord:d,indices:g},r)}function yi(t,e,i,n,r,o,l){if(e<=0||i<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,o=o||0;const h=(r=r||Math.PI)-n,d=(l=l||2*Math.PI)-o,u=(e+1)*(i+1),g=X(3,u),b=X(3,u),_=X(2,u);for(let S=0;S<=i;S++)for(let k=0;k<=e;k++){const U=k/e,G=S/i,F=d*U+o,P=h*G+n,T=Math.sin(F),C=Math.cos(F),N=Math.sin(P),V=C*N,W=Math.cos(P),J=T*N;g.push(t*V,t*W,t*J),b.push(V,W,J),_.push(1-U,G)}const y=e+1,I=X(3,e*i*2,Uint16Array);for(let S=0;S<e;S++)for(let k=0;k<i;k++)I.push((k+0)*y+S,(k+0)*y+S+1,(k+1)*y+S),I.push((k+1)*y+S,(k+0)*y+S+1,(k+1)*y+S+1);return{position:g,normal:b,texcoord:_,indices:I}}const ao=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function un(t){const e=(t=t||1)/2,i=[[-e,-e,-e],[+e,-e,-e],[-e,+e,-e],[+e,+e,-e],[-e,-e,+e],[+e,-e,+e],[-e,+e,+e],[+e,+e,+e]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],r=[[1,0],[0,0],[0,1],[1,1]],o=X(3,24),l=X(3,24),h=X(2,24),d=X(3,12,Uint16Array);for(let u=0;u<6;++u){const g=ao[u];for(let _=0;_<4;++_){const y=i[g[_]],I=n[u],S=r[_];o.push(y),l.push(I),h.push(S)}const b=4*u;d.push(b+0,b+1,b+2),d.push(b+0,b+2,b+3)}return{position:o,normal:l,texcoord:h,indices:d}}function Fn(t,e,i,n,r,o,l){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(r<1)throw new Error("verticalSubdivisions must be 1 or greater");const h=o===void 0||o,d=l===void 0||l,u=(h?2:0)+(d?2:0),g=(n+1)*(r+1+u),b=X(3,g),_=X(3,g),y=X(2,g),I=X(3,n*(r+u/2)*2,Uint16Array),S=n+1,k=Math.atan2(t-e,i),U=Math.cos(k),G=Math.sin(k),F=r+(d?2:0);for(let P=h?-2:0;P<=F;++P){let T,C=P/r,N=i*C;P<0?(N=0,C=1,T=t):P>r?(N=i,C=1,T=e):T=t+P/r*(e-t),P!==-2&&P!==r+2||(T=0,C=0),N-=i/2;for(let V=0;V<S;++V){const W=Math.sin(V*Math.PI*2/n),J=Math.cos(V*Math.PI*2/n);b.push(W*T,N,J*T),P<0?_.push(0,-1,0):P>r?_.push(0,1,0):T===0?_.push(0,0,0):_.push(W*U,G,J*U),y.push(V/n,1-C)}}for(let P=0;P<r+u;++P)if(!(P===1&&h||P===r+u-2&&d))for(let T=0;T<n;++T)I.push(S*(P+0)+0+T,S*(P+0)+1+T,S*(P+1)+1+T),I.push(S*(P+0)+0+T,S*(P+1)+1+T,S*(P+1)+0+T);return{position:b,normal:_,texcoord:y,indices:I}}function hr(t,e){e=e||[];const i=[];for(let n=0;n<t.length;n+=4){const r=t[n],o=t.slice(n+1,n+4);o.push.apply(o,e);for(let l=0;l<r;++l)i.push.apply(i,o)}return i}function Ti(){const t=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],e=hr([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),i=hr([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),n=t.length/3,r={position:X(3,n),texcoord:X(2,n),normal:X(3,n),color:X(4,n,Uint8Array),indices:X(3,n/3,Uint16Array)};r.position.push(t),r.texcoord.push([.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0]),r.normal.push(e),r.color.push(i);for(let o=0;o<n;++o)r.indices.push(o);return r}function ai(t,e,i,n,r,o,l){if(r<=0)throw new Error("subdivisionDown must be > 0");const h=(l=l||1)-(o=o||0),d=2*(r+1)*4,u=X(3,d),g=X(3,d),b=X(2,d);function _(U,G,F){return U+(G-U)*F}function y(U,G,F,P,T,C){for(let N=0;N<=r;N++){const V=G/1,W=N/r,J=2*(V-.5),at=(o+W*h)*Math.PI,St=Math.sin(at),Ut=Math.cos(at),vt=_(t,U,St),ee=J*n,le=Ut*t,be=St*vt;u.push(ee,le,be);const ve=ge(Jr([0,St,Ut],F),P);g.push(ve),b.push(V*T+C,W)}}for(let U=0;U<2;U++){const G=2*(U/1-.5);y(e,U,[1,1,1],[0,0,0],1,0),y(e,U,[0,0,0],[G,0,0],0,0),y(i,U,[1,1,1],[0,0,0],1,0),y(i,U,[0,0,0],[G,0,0],0,1)}const I=X(3,2*r*4,Uint16Array);function S(U,G){for(let F=0;F<r;++F)I.push(U+F+0,U+F+1,G+F+0),I.push(U+F+1,G+F+1,G+F+0)}const k=r+1;return S(0*k,4*k),S(5*k,7*k),S(6*k,2*k),S(3*k,1*k),{position:u,normal:g,texcoord:b,indices:I}}function cn(t,e,i,n,r,o){return Fn(t,t,e,i,n,r,o)}function ji(t,e,i,n,r,o){if(i<3)throw new Error("radialSubdivisions must be 3 or greater");if(n<3)throw new Error("verticalSubdivisions must be 3 or greater");r=r||0;const l=(o=o||2*Math.PI)-r,h=i+1,d=n+1,u=h*d,g=X(3,u),b=X(3,u),_=X(2,u),y=X(3,i*n*2,Uint16Array);for(let I=0;I<d;++I){const S=I/n,k=S*Math.PI*2,U=Math.sin(k),G=t+U*e,F=Math.cos(k),P=F*e;for(let T=0;T<h;++T){const C=T/i,N=r+C*l,V=Math.sin(N),W=Math.cos(N),J=V*G,at=W*G,St=V*U,Ut=W*U;g.push(J,P,at),b.push(St,F,Ut),_.push(C,1-S)}}for(let I=0;I<n;++I)for(let S=0;S<i;++S){const k=1+S,U=1+I;y.push(h*I+S,h*U+S,h*I+k),y.push(h*U+S,h*U+k,h*I+k)}return{position:g,normal:b,texcoord:_,indices:y}}function lr(t,e,i,n,r){if(e<3)throw new Error("divisions must be at least 3");r=r||1,n=n||0;const o=(e+1)*((i=i||1)+1),l=X(3,o),h=X(3,o),d=X(2,o),u=X(3,i*e*2,Uint16Array);let g=0;const b=t-n,_=e+1;for(let y=0;y<=i;++y){const I=n+b*Math.pow(y/i,r);for(let S=0;S<=e;++S){const k=2*Math.PI*S/e,U=I*Math.cos(k),G=I*Math.sin(k);if(l.push(U,0,G),h.push(0,1,0),d.push(1-S/e,y/i),y>0&&S!==e){const F=g+(S+1),P=g+S,T=g+S-_,C=g+(S+1)-_;u.push(F,P,T),u.push(F,T,C)}}g+=e+1}return{position:l,normal:h,texcoord:d,indices:u}}function Me(t){return function(e){return an(e,t.apply(this,Array.prototype.slice.call(arguments,1)))}}function Ht(t){return function(e){return ro(e,t.apply(null,Array.prototype.slice.call(arguments,1)))}}Ht(Ti),Me(Ti),Ht(un),Me(un),Ht(oi),Me(oi),Ht(yi),Me(yi),Ht(Fn),Me(Fn),Ht(Ne),Me(Ne),Ht(ai),Me(ai),Ht(cn),Me(cn),Ht(ji),Me(ji),Ht(lr),Me(lr);function ne(t){return!!t.texStorage2D}const ur=function(){const t={},e={};return function(i,n){return function(r){const o=r.constructor.name;if(!t[o]){for(const l in r)if(typeof r[l]=="number"){const h=e[r[l]];e[r[l]]=h?`${h} | ${l}`:l}t[o]=!0}}(i),e[n]||(typeof n=="number"?`0x${n.toString(16)}`:n)}}();new Uint8Array([128,192,255,255]);const ho=6406,cr=6407,dr=6408,Li=6409,zi=6410,fr=6402,In=34041,lo=33319,uo=33320,co=6403,us=36244,fo=36248,po=36249,cs={};{const t=cs;t[ho]={numColorComponents:1},t[Li]={numColorComponents:1},t[zi]={numColorComponents:2},t[cr]={numColorComponents:3},t[dr]={numColorComponents:4},t[co]={numColorComponents:1},t[us]={numColorComponents:1},t[lo]={numColorComponents:2},t[uo]={numColorComponents:2},t[cr]={numColorComponents:3},t[fo]={numColorComponents:3},t[dr]={numColorComponents:4},t[po]={numColorComponents:4},t[fr]={numColorComponents:1},t[In]={numColorComponents:2}}const hi=nr;function pr(t){return typeof document<"u"&&document.getElementById?document.getElementById(t):null}const Hi=33984,Gi=34962,On=35713,ds=35714,go=35632,dn=35633,fs=35981,gr=35718,ps=35721,gs=35971,mr=35382,mo=35396,bo=35398,ms=35392,bs=35395,Rn=5126,Un=5124,ke=5125,Xe=3553,wi=34067,li=32879,fn=35866,pt={};function vs(t,e){return pt[e].bindPoint}function Pn(t,e){return function(i){t.uniform1i(e,i)}}function br(t,e){return function(i){t.uniform1iv(e,i)}}function pn(t,e){return function(i){t.uniform2iv(e,i)}}function vr(t,e){return function(i){t.uniform3iv(e,i)}}function ye(t,e){return function(i){t.uniform4iv(e,i)}}function re(t,e,i,n){const r=vs(0,e);return ne(t)?function(o){let l,h;!o||ts(0,o)?(l=o,h=null):(l=o.texture,h=o.sampler),t.uniform1i(n,i),t.activeTexture(Hi+i),t.bindTexture(r,l),t.bindSampler(i,h)}:function(o){t.uniform1i(n,i),t.activeTexture(Hi+i),t.bindTexture(r,o)}}function Yt(t,e,i,n,r){const o=vs(0,e),l=new Int32Array(r);for(let h=0;h<r;++h)l[h]=i+h;return ne(t)?function(h){t.uniform1iv(n,l),h.forEach(function(d,u){let g,b;t.activeTexture(Hi+l[u]),!d||ts(0,d)?(g=d,b=null):(g=d.texture,b=d.sampler),t.bindSampler(i,b),t.bindTexture(o,g)})}:function(h){t.uniform1iv(n,l),h.forEach(function(d,u){t.activeTexture(Hi+l[u]),t.bindTexture(o,d)})}}function Bn(t,e){return function(i){if(i.value)switch(t.disableVertexAttribArray(e),i.value.length){case 4:t.vertexAttrib4fv(e,i.value);break;case 3:t.vertexAttrib3fv(e,i.value);break;case 2:t.vertexAttrib2fv(e,i.value);break;case 1:t.vertexAttrib1fv(e,i.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else t.bindBuffer(Gi,i.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,i.numComponents||i.size,i.type||Rn,i.normalize||!1,i.stride||0,i.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,i.divisor||0)}}function ui(t,e){return function(i){if(i.value){if(t.disableVertexAttribArray(e),i.value.length!==4)throw new Error("The length of an integer constant value must be 4!");t.vertexAttrib4iv(e,i.value)}else t.bindBuffer(Gi,i.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,i.numComponents||i.size,i.type||Un,i.stride||0,i.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,i.divisor||0)}}function je(t,e){return function(i){if(i.value){if(t.disableVertexAttribArray(e),i.value.length!==4)throw new Error("The length of an unsigned integer constant value must be 4!");t.vertexAttrib4uiv(e,i.value)}else t.bindBuffer(Gi,i.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,i.numComponents||i.size,i.type||ke,i.stride||0,i.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,i.divisor||0)}}function Ye(t,e,i){const n=i.size,r=i.count;return function(o){t.bindBuffer(Gi,o.buffer);const l=o.size||o.numComponents||n,h=l/r,d=o.type||Rn,u=pt[d].size*l,g=o.normalize||!1,b=o.offset||0,_=u/r;for(let y=0;y<r;++y)t.enableVertexAttribArray(e+y),t.vertexAttribPointer(e+y,h,d,g,u,b+_*y),t.vertexAttribDivisor&&t.vertexAttribDivisor(e+y,o.divisor||0)}}pt[5126]={Type:Float32Array,size:4,setter:function(t,e){return function(i){t.uniform1f(e,i)}},arraySetter:function(t,e){return function(i){t.uniform1fv(e,i)}}},pt[35664]={Type:Float32Array,size:8,setter:function(t,e){return function(i){t.uniform2fv(e,i)}},cols:2},pt[35665]={Type:Float32Array,size:12,setter:function(t,e){return function(i){t.uniform3fv(e,i)}},cols:3},pt[35666]={Type:Float32Array,size:16,setter:function(t,e){return function(i){t.uniform4fv(e,i)}},cols:4},pt[Un]={Type:Int32Array,size:4,setter:Pn,arraySetter:br},pt[35667]={Type:Int32Array,size:8,setter:pn,cols:2},pt[35668]={Type:Int32Array,size:12,setter:vr,cols:3},pt[35669]={Type:Int32Array,size:16,setter:ye,cols:4},pt[5125]={Type:Uint32Array,size:4,setter:function(t,e){return function(i){t.uniform1ui(e,i)}},arraySetter:function(t,e){return function(i){t.uniform1uiv(e,i)}}},pt[36294]={Type:Uint32Array,size:8,setter:function(t,e){return function(i){t.uniform2uiv(e,i)}},cols:2},pt[36295]={Type:Uint32Array,size:12,setter:function(t,e){return function(i){t.uniform3uiv(e,i)}},cols:3},pt[36296]={Type:Uint32Array,size:16,setter:function(t,e){return function(i){t.uniform4uiv(e,i)}},cols:4},pt[35670]={Type:Uint32Array,size:4,setter:Pn,arraySetter:br},pt[35671]={Type:Uint32Array,size:8,setter:pn,cols:2},pt[35672]={Type:Uint32Array,size:12,setter:vr,cols:3},pt[35673]={Type:Uint32Array,size:16,setter:ye,cols:4},pt[35674]={Type:Float32Array,size:32,setter:function(t,e){return function(i){t.uniformMatrix2fv(e,!1,i)}},rows:2,cols:2},pt[35675]={Type:Float32Array,size:48,setter:function(t,e){return function(i){t.uniformMatrix3fv(e,!1,i)}},rows:3,cols:3},pt[35676]={Type:Float32Array,size:64,setter:function(t,e){return function(i){t.uniformMatrix4fv(e,!1,i)}},rows:4,cols:4},pt[35685]={Type:Float32Array,size:32,setter:function(t,e){return function(i){t.uniformMatrix2x3fv(e,!1,i)}},rows:2,cols:3},pt[35686]={Type:Float32Array,size:32,setter:function(t,e){return function(i){t.uniformMatrix2x4fv(e,!1,i)}},rows:2,cols:4},pt[35687]={Type:Float32Array,size:48,setter:function(t,e){return function(i){t.uniformMatrix3x2fv(e,!1,i)}},rows:3,cols:2},pt[35688]={Type:Float32Array,size:48,setter:function(t,e){return function(i){t.uniformMatrix3x4fv(e,!1,i)}},rows:3,cols:4},pt[35689]={Type:Float32Array,size:64,setter:function(t,e){return function(i){t.uniformMatrix4x2fv(e,!1,i)}},rows:4,cols:2},pt[35690]={Type:Float32Array,size:64,setter:function(t,e){return function(i){t.uniformMatrix4x3fv(e,!1,i)}},rows:4,cols:3},pt[35678]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:Xe},pt[35680]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:wi},pt[35679]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:li},pt[35682]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:Xe},pt[36289]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:fn},pt[36292]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:fn},pt[36293]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:wi},pt[36298]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:Xe},pt[36299]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:li},pt[36300]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:wi},pt[36303]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:fn},pt[36306]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:Xe},pt[36307]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:li},pt[36308]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:wi},pt[36311]={Type:null,size:0,setter:re,arraySetter:Yt,bindPoint:fn};const Lt={};Lt[5126]={size:4,setter:Bn},Lt[35664]={size:8,setter:Bn},Lt[35665]={size:12,setter:Bn},Lt[35666]={size:16,setter:Bn},Lt[Un]={size:4,setter:ui},Lt[35667]={size:8,setter:ui},Lt[35668]={size:12,setter:ui},Lt[35669]={size:16,setter:ui},Lt[5125]={size:4,setter:je},Lt[36294]={size:8,setter:je},Lt[36295]={size:12,setter:je},Lt[36296]={size:16,setter:je},Lt[35670]={size:4,setter:ui},Lt[35671]={size:8,setter:ui},Lt[35672]={size:12,setter:ui},Lt[35673]={size:16,setter:ui},Lt[35674]={size:4,setter:Ye,count:2},Lt[35675]={size:9,setter:Ye,count:3},Lt[35676]={size:16,setter:Ye,count:4};const vo=/ERROR:\s*\d+:(\d+)/gi,qi=/^[ \t]*\n/;function _r(t){let e=0;return qi.test(t)&&(e=1,t=t.replace(qi,"")),{lineOffset:e,shaderSource:t}}function xr(t,e){return t.errorCallback(e),t.callback&&setTimeout(()=>{t.callback(`${e}
${t.errors.join(`
`)}`)}),null}function _s(t,e,i,n){if(n=n||hi,!t.getShaderParameter(i,On)){const r=t.getShaderInfoLog(i),{lineOffset:o,shaderSource:l}=_r(t.getShaderSource(i)),h=`${function(d,u="",g=0){const b=[...u.matchAll(vo)],_=new Map(b.map((y,I)=>{const S=parseInt(y[1]),k=b[I+1],U=k?k.index:u.length;return[S-1,u.substring(y.index,U)]}));return d.split(`
`).map((y,I)=>{const S=_.get(I);return`${I+1+g}: ${y}${S?`

^^^ ${S}`:""}`}).join(`
`)}(l,r,o)}
Error compiling ${ur(t,e)}: ${r}`;return n(h),h}return""}function Wi(t,e,i){let n,r,o;if(typeof e=="function"&&(i=e,e=void 0),typeof t=="function")i=t,t=void 0;else if(t&&!Array.isArray(t)){const u=t;i=u.errorCallback,t=u.attribLocations,n=u.transformFeedbackVaryings,r=u.transformFeedbackMode,o=u.callback}const l=i||hi,h=[],d={errorCallback(u,...g){h.push(u),l(u,...g)},transformFeedbackVaryings:n,transformFeedbackMode:r,callback:o,errors:h};{let u={};Array.isArray(t)?t.forEach(function(g,b){u[g]=e?e[b]:b}):u=t||{},d.attribLocations=u}return d}const _o=["VERTEX_SHADER","FRAGMENT_SHADER"],xs=(t=0)=>new Promise(e=>setTimeout(e,t));function ys(t,e,i){const n=t.createProgram(),{attribLocations:r,transformFeedbackVaryings:o,transformFeedbackMode:l}=Wi(i);for(let d=0;d<e.length;++d){let u=e[d];if(typeof u=="string"){const g=pr(u),b=g?g.text:u;let _=t[_o[d]];g&&g.type&&(_=((h=g.type).indexOf("frag")>=0?go:h.indexOf("vert")>=0?dn:void 0)||_),u=t.createShader(_),t.shaderSource(u,_r(b).shaderSource),t.compileShader(u),t.attachShader(n,u)}}var h;Object.entries(r).forEach(([d,u])=>t.bindAttribLocation(n,u,d));{let d=o;d&&(d.attribs&&(d=d.attribs),Array.isArray(d)||(d=Object.keys(d)),t.transformFeedbackVaryings(n,d,l||fs))}return t.linkProgram(n),n}function Ts(t,e,i,n,r){const o=Wi(i,n,r),l=new Set(e),h=ys(t,e,o);function d(u,g){const b=As(u,g,o.errorCallback);return b&&function(_,y,I){const S=_.getAttachedShaders(y);for(const k of S)I.has(k)&&_.deleteShader(k);_.deleteProgram(y)}(u,g,l),b}if(!o.callback)return d(t,h)?void 0:h;ws(t,h).then(()=>{const u=d(t,h);o.callback(u,u?void 0:h)})}function Vi(t){return function(e,i,...n){return new Promise((r,o)=>{const l=Wi(...n);l.callback=(h,d)=>{h?o(h):r(d)},t(e,i,l)})}}Vi(Ts),Vi(Ai);async function ws(t,e){const i=t.getExtension("KHR_parallel_shader_compile"),n=i?(o,l)=>o.getProgramParameter(l,i.COMPLETION_STATUS_KHR):()=>!0;let r=0;do await xs(r),r=1e3/60;while(!n(t,e))}function As(t,e,i){if(i=i||hi,!t.getProgramParameter(e,ds)){const n=t.getProgramInfoLog(e);return i(`Error in program linking: ${n}`),`${n}
${t.getAttachedShaders(e).map(r=>_s(t,t.getShaderParameter(r,t.SHADER_TYPE),r,i)).filter(r=>r).join(`
`)}`}}function xo(t,e,i,n,r){return Ts(t,e,i,n,r)}function Es(t){const e=t.name;return e.startsWith("gl_")||e.startsWith("webgl_")}const yo=/(\.|\[|]|\w+)/g,To=t=>t>="0"&&t<="9";function Cs(t,e,i,n){const r=t.split(yo).filter(h=>h!=="");let o=0,l="";for(;;){const h=r[o++];l+=h;const d=To(h[0]),u=d?parseInt(h):h;if(d&&(l+=r[o++]),o===r.length){i[u]=e;break}{const g=r[o++],b=g==="[",_=i[u]||(b?[]:{});i[u]=_,i=_,n[l]=n[l]||function(y){return function(I){wr(y,I)}}(_),l+=g}}}function yr(t,e){let i=0;function n(h,d,u){const g=d.name.endsWith("[0]"),b=d.type,_=pt[b];if(!_)throw new Error(`unknown type: 0x${b.toString(16)}`);let y;if(_.bindPoint){const I=i;i+=d.size,y=g?_.arraySetter(t,b,I,u,d.size):_.setter(t,b,I,u,d.size)}else y=_.arraySetter&&g?_.arraySetter(t,u):_.setter(t,u);return y.location=u,y}const r={},o={},l=t.getProgramParameter(e,gr);for(let h=0;h<l;++h){const d=t.getActiveUniform(e,h);if(Es(d))continue;let u=d.name;u.endsWith("[0]")&&(u=u.substr(0,u.length-3));const g=t.getUniformLocation(e,d.name);if(g){const b=n(0,d,g);r[u]=b,Cs(u,b,o,r)}}return r}function Ss(t,e){const i={},n=t.getProgramParameter(e,gs);for(let r=0;r<n;++r){const o=t.getTransformFeedbackVarying(e,r);i[o.name]={index:r,type:o.type,size:o.size}}return i}function Tr(t,e){const i=t.getProgramParameter(e,gr),n=[],r=[];for(let h=0;h<i;++h){r.push(h),n.push({});const d=t.getActiveUniform(e,h);n[h].name=d.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(h){const d=h[0],u=h[1];t.getActiveUniforms(e,r,t[d]).forEach(function(g,b){n[b][u]=g})});const o={},l=t.getProgramParameter(e,mr);for(let h=0;h<l;++h){const d=t.getActiveUniformBlockName(e,h),u={index:t.getUniformBlockIndex(e,d),usedByVertexShader:t.getActiveUniformBlockParameter(e,h,mo),usedByFragmentShader:t.getActiveUniformBlockParameter(e,h,bo),size:t.getActiveUniformBlockParameter(e,h,ms),uniformIndices:t.getActiveUniformBlockParameter(e,h,bs)};u.used=u.usedByVertexShader||u.usedByFragmentShader,o[d]=u}return{blockSpecs:o,uniformData:n}}function wr(t,e){for(const i in e){const n=t[i];typeof n=="function"?n(e[i]):wr(t[i],e[i])}}function Ze(t,...e){const i=t.uniformSetters||t,n=e.length;for(let r=0;r<n;++r){const o=e[r];if(Array.isArray(o)){const l=o.length;for(let h=0;h<l;++h)Ze(i,o[h])}else for(const l in o){const h=i[l];h&&h(o[l])}}}function Ar(t,e){const i={},n=t.getProgramParameter(e,ps);for(let r=0;r<n;++r){const o=t.getActiveAttrib(e,r);if(Es(o))continue;const l=t.getAttribLocation(e,o.name),h=Lt[o.type],d=h.setter(t,l,h);d.location=l,i[o.name]=d}return i}function Er(t,e){const i={program:e,uniformSetters:yr(t,e),attribSetters:Ar(t,e)};return ne(t)&&(i.uniformBlockSpec=Tr(t,e),i.transformFeedbackInfo=Ss(t,e)),i}const gn=/\s|{|}|;/;function Ai(t,e,i,n,r){const o=Wi(i,n,r),l=[];if(e=e.map(function(u){if(!gn.test(u)){const g=pr(u);if(g)u=g.text;else{const b=`no element with id: ${u}`;o.errorCallback(b),l.push(b)}}return u}),l.length)return xr(o,"");const h=o.callback;h&&(o.callback=(u,g)=>{h(u,u?void 0:Er(t,g))});const d=xo(t,e,o);return d?Er(t,d):null}function Cr(t,e,i,n,r){for(const[o,l]of Object.entries(e)){const h={...r},d=i[o];Array.isArray(d)||Object.assign(h,d);const u=As(t,l,h.errorCallback);if(u){for(const g of Object.values(e)){const b=t.getAttachedShaders(g);t.deleteProgram(g);for(const _ of b)n.has(_)||t.deleteShader(_)}return u}}}function Nn(t,e,i={}){const n=new Set,r=Object.fromEntries(Object.entries(e).map(([o,l])=>{const h={...i},d=Array.isArray(l)?l:l.shaders;return Array.isArray(l)||Object.assign(h,l),d.forEach(n.add,n),[o,ys(t,d,h)]}));return i.callback?void async function(o,l){for(const h of Object.values(l))await ws(o,h)}(t,r).then(()=>{const o=Cr(t,r,e,n,i);i.callback(o,o?void 0:r)}):Cr(t,r,e,n,i)?void 0:r}function wo(t,e,i){function n(l,h){return Object.fromEntries(Object.entries(h).map(([d,u])=>[d,Er(l,u)]))}const r=(i=Wi(i)).callback;r&&(i.callback=(l,h)=>{r(l,l?void 0:n(t,h))});const o=Nn(t,e,i);if(!r&&o)return n(t,o)}Vi(Nn),Vi(wo);const jn=36096,Sr=33306,s={};s[34041]=Sr,s[6401]=36128,s[36168]=36128,s[6402]=jn,s[33189]=jn,s[33190]=jn,s[36012]=jn,s[35056]=Sr,s[36013]=Sr;const a={};a[32854]=!0,a[32855]=!0,a[36194]=!0,a[34041]=!0,a[33189]=!0,a[6401]=!0,a[36168]=!0;var c={};const f={position:3,normal:3,tangent:3,texcoord:2,texcoord0:2,texcoord1:2,texcoord2:2};var m={};class v{constructor(){this.attribs={}}disableAll(){for(let e in this.attribs)this.gl.disableVertexAttribArray(this.attribs[e]);this.attribs={}}enable(e,i){this.gl=e;var n={};for(let o in i){var r=i[o];r.loc!==void 0&&(this.attribs[r.loc]===void 0&&e.enableVertexAttribArray(r.loc),e.vertexAttribPointer(r.loc,r.size,r.type,!1,r.stride,r.offset),n[r.loc]=r.loc,this.attribs[o]=null)}for(let o in this.attribs);this.attribs=n}}class x{static CreateProgramAttributes(e,i){var n={},r=0;for(let h in i){var o=i[h],l=f[h];n[o]={type:e.FLOAT,size:l,offset:4*r},r+=l}for(let h in n)n[h].stride=4*r;return n}CleanUpPrograms(){m={}}ReleaseProgram(e){}static _GetProgram(e){return m[e]}static RegisterProgram(e,i){if(!m[e]){var n=i.shaders;m[e]={shaders:[n[0],n[1]],attributes:i.attributes}}return m[e]}static GetProgram(e,i,n,r){var o=m[i],l="";for(var h in n)l+=h+":"+n[h]+"-";if(!o){var d=i.split("."),u=c[d[0]][d[1]];u&&(o=x.RegisterProgram(i,u))}if(!o)throw"Program not registered: "+d;o.programInfo||(o.programInfo={}),o.programInfo[l]=x.CompileProgram(e,o.shaders,n),r=r||o.attributes&&x.CreateProgramAttributes(e,o.attributes);var g=o.programInfo[l];if(r)for(var h in r){var b=g.attribSetters[h];b&&(r[h]=r[h]||{},r[h].loc=b.location)}return g.attributes=r,g}static CompileProgram(e,i,n,r){var o="";for(var l in n){var h=n[l];o="#define "+l+" "+(h===null?"":h)+`
`}var d={};const u=Ai(e,[o+i[0],o+i[1]],null,null);if(r)for(var l in r){var g=u.attribSetters[l];g&&(r[l]=r[l]||{},r[l].loc=g.location)}for(var l in u.uniformSetters)d[l]=u.uniformSetters[l].location;return u.uniforms=d,u}}var D=new x,A=1e-6,O=typeof Float32Array<"u"?Float32Array:Array;function M(){var t=new O(3);return O!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function L(t){var e=t[0],i=t[1],n=t[2];return Math.hypot(e,i,n)}function E(t,e,i){var n=new O(3);return n[0]=t,n[1]=e,n[2]=i,n}function z(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Y(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t}function tt(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function nt(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function Pt(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function Gt(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function de(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function gt(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function bt(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t}function Te(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n}function Tt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Mt(t,e){var i=e[0],n=e[1],r=e[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function Ei(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ln(t,e,i){var n=e[0],r=e[1],o=e[2],l=i[0],h=i[1],d=i[2];return t[0]=r*d-o*h,t[1]=o*l-n*d,t[2]=n*h-r*l,t}function De(t,e,i,n){var r=e[0],o=e[1],l=e[2];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=l+n*(i[2]-l),t}function Fe(t,e,i){var n=e[0],r=e[1],o=e[2],l=i[3]*n+i[7]*r+i[11]*o+i[15];return l=l||1,t[0]=(i[0]*n+i[4]*r+i[8]*o+i[12])/l,t[1]=(i[1]*n+i[5]*r+i[9]*o+i[13])/l,t[2]=(i[2]*n+i[6]*r+i[10]*o+i[14])/l,t}function ue(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=n*i[0]+r*i[3]+o*i[6],t[1]=n*i[1]+r*i[4]+o*i[7],t[2]=n*i[2]+r*i[5]+o*i[8],t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ci,Xi=nt,Ie=L;ci=M();function rt(){var t=new O(16);return O!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Ot(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function se(t,e,i,n,r,o,l,h,d,u,g,b,_,y,I,S){var k=new O(16);return k[0]=t,k[1]=e,k[2]=i,k[3]=n,k[4]=r,k[5]=o,k[6]=l,k[7]=h,k[8]=d,k[9]=u,k[10]=g,k[11]=b,k[12]=_,k[13]=y,k[14]=I,k[15]=S,k}function $t(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function oe(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],o=e[6],l=e[7],h=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=r,t[13]=l,t[14]=h}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function it(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],l=e[4],h=e[5],d=e[6],u=e[7],g=e[8],b=e[9],_=e[10],y=e[11],I=e[12],S=e[13],k=e[14],U=e[15],G=i*h-n*l,F=i*d-r*l,P=i*u-o*l,T=n*d-r*h,C=n*u-o*h,N=r*u-o*d,V=g*S-b*I,W=g*k-_*I,J=g*U-y*I,at=b*k-_*S,St=b*U-y*S,Ut=_*U-y*k,vt=G*Ut-F*St+P*at+T*J-C*W+N*V;return vt?(vt=1/vt,t[0]=(h*Ut-d*St+u*at)*vt,t[1]=(r*St-n*Ut-o*at)*vt,t[2]=(S*N-k*C+U*T)*vt,t[3]=(_*C-b*N-y*T)*vt,t[4]=(d*J-l*Ut-u*W)*vt,t[5]=(i*Ut-r*J+o*W)*vt,t[6]=(k*P-I*N-U*F)*vt,t[7]=(g*N-_*P+y*F)*vt,t[8]=(l*St-h*J+u*V)*vt,t[9]=(n*J-i*St-o*V)*vt,t[10]=(I*C-S*P+U*G)*vt,t[11]=(b*P-g*C-y*G)*vt,t[12]=(h*W-l*at-d*V)*vt,t[13]=(i*at-n*W+r*V)*vt,t[14]=(S*F-I*T-k*G)*vt,t[15]=(g*T-b*F+_*G)*vt,t):null}function st(t,e,i){var n=e[0],r=e[1],o=e[2],l=e[3],h=e[4],d=e[5],u=e[6],g=e[7],b=e[8],_=e[9],y=e[10],I=e[11],S=e[12],k=e[13],U=e[14],G=e[15],F=i[0],P=i[1],T=i[2],C=i[3];return t[0]=F*n+P*h+T*b+C*S,t[1]=F*r+P*d+T*_+C*k,t[2]=F*o+P*u+T*y+C*U,t[3]=F*l+P*g+T*I+C*G,F=i[4],P=i[5],T=i[6],C=i[7],t[4]=F*n+P*h+T*b+C*S,t[5]=F*r+P*d+T*_+C*k,t[6]=F*o+P*u+T*y+C*U,t[7]=F*l+P*g+T*I+C*G,F=i[8],P=i[9],T=i[10],C=i[11],t[8]=F*n+P*h+T*b+C*S,t[9]=F*r+P*d+T*_+C*k,t[10]=F*o+P*u+T*y+C*U,t[11]=F*l+P*g+T*I+C*G,F=i[12],P=i[13],T=i[14],C=i[15],t[12]=F*n+P*h+T*b+C*S,t[13]=F*r+P*d+T*_+C*k,t[14]=F*o+P*u+T*y+C*U,t[15]=F*l+P*g+T*I+C*G,t}function xt(t,e,i){var n,r,o,l,h,d,u,g,b,_,y,I,S=i[0],k=i[1],U=i[2];return e===t?(t[12]=e[0]*S+e[4]*k+e[8]*U+e[12],t[13]=e[1]*S+e[5]*k+e[9]*U+e[13],t[14]=e[2]*S+e[6]*k+e[10]*U+e[14],t[15]=e[3]*S+e[7]*k+e[11]*U+e[15]):(n=e[0],r=e[1],o=e[2],l=e[3],h=e[4],d=e[5],u=e[6],g=e[7],b=e[8],_=e[9],y=e[10],I=e[11],t[0]=n,t[1]=r,t[2]=o,t[3]=l,t[4]=h,t[5]=d,t[6]=u,t[7]=g,t[8]=b,t[9]=_,t[10]=y,t[11]=I,t[12]=n*S+h*k+b*U+e[12],t[13]=r*S+d*k+_*U+e[13],t[14]=o*S+u*k+y*U+e[14],t[15]=l*S+g*k+I*U+e[15]),t}function At(t,e,i){var n=i[0],r=i[1],o=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Oe(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[4],l=e[5],h=e[6],d=e[7],u=e[8],g=e[9],b=e[10],_=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*n,t[5]=l*r+g*n,t[6]=h*r+b*n,t[7]=d*r+_*n,t[8]=u*r-o*n,t[9]=g*r-l*n,t[10]=b*r-h*n,t[11]=_*r-d*n,t}function Ci(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],l=e[1],h=e[2],d=e[3],u=e[4],g=e[5],b=e[6],_=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*n,t[1]=l*r+g*n,t[2]=h*r+b*n,t[3]=d*r+_*n,t[4]=u*r-o*n,t[5]=g*r-l*n,t[6]=b*r-h*n,t[7]=_*r-d*n,t}function zn(t,e,i){var n=e[0],r=e[1],o=e[2],l=e[3],h=n+n,d=r+r,u=o+o,g=n*h,b=n*d,_=n*u,y=r*d,I=r*u,S=o*u,k=l*h,U=l*d,G=l*u;return t[0]=1-(y+S),t[1]=b+G,t[2]=_-U,t[3]=0,t[4]=b-G,t[5]=1-(g+S),t[6]=I+k,t[7]=0,t[8]=_+U,t[9]=I-k,t[10]=1-(g+y),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function fe(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Hn(t,e){var i=e[0],n=e[1],r=e[2],o=e[4],l=e[5],h=e[6],d=e[8],u=e[9],g=e[10];return t[0]=Math.hypot(i,n,r),t[1]=Math.hypot(o,l,h),t[2]=Math.hypot(d,u,g),t}var $e=function(t,e,i,n,r){var o,l=1/Math.tan(e/2);return t[0]=l/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0?(o=1/(n-r),t[10]=(r+n)*o,t[14]=2*r*n*o):(t[10]=-1,t[14]=-2*n),t},Ms=st;const mn={2:"Wowhead",3:"LolKing",6:"HeroKing",7:"DestinyDB"};class Si{constructor(e){if(!e.type||!mn[e.type])throw"Viewer error: Bad viewer type given";if(!e.container)throw"Viewer error: Bad container given";if(!e.aspect)throw"Viewer error: Bad aspect ratio given";if(!e.contentPath)throw"Viewer error: No content path given";console.log("Creating viewer with options",e),this.type=e.type,this.container=e.container,this.aspect=parseFloat(e.aspect),this.renderer=null,this.options=e;const i=this.container.width(),n=Math.round(i/this.aspect);this.init(i,n)}destroy(){this.renderer&&this.renderer.destroy(),this.options=null,this.container=null}init(e,i){if(typeof window.Uint8Array!==void 0&&typeof window.DataView!==void 0)try{const n=document.createElement("canvas");if(!(n.getContext("webgl",{alpha:!1})||n.getContext("experimental-webgl",{alpha:!1})))return void console.log("viewer init failed")}catch{return void console.log("viewer init failed")}this.mode=1,this.renderer=new Dh(this),this.renderer.resize(e,i),this.renderer.init()}setAdaptiveMode(e){this.renderer.setAdaptiveMode(e)}setZoom(e){this.renderer.zoom.target=e}setOffset(e,i){this.renderer.setTranslation(e,i,0)}setFullscreen(e){e?Si.requestFullscreen(this.renderer.canvas[0]):Si.exitFullscreen()}method(e,i){return i===void 0&&(i=[]),this.renderer?this.renderer.method(e,[].concat(i)):null}option(e,i){return i!==void 0&&(this.options[e]=i),this.options[e]}static isFullscreen(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}static requestFullscreen(e){document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||(e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen())}static exitFullscreen(){(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}}const Le=Si,Mr=class{constructor(t,e,i){this.g=t,this.ba=e,this.f=i,this.e=!1,this.dc=t.createBuffer(),this.ba=0}b(t){const e=this.g;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.dc),!this.e||this.ba<t.byteLength?(e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,this.f?e.DYNAMIC_DRAW:e.STATIC_DRAW),this.ba=t.byteLength,this.e=!0):e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}d(){return this.ba}c(){const t=this.g;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.dc)}a(){const t=this.g;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},Mi=class{constructor(t,e,i){this.ba=t,this.f=e,this.dc=i,this.g=!1,this.e=t.createBuffer(),this.f=0}c(){const t=this.ba;t.bindBuffer(t.ARRAY_BUFFER,this.e)}a(){const t=this.ba;t.bindBuffer(t.ARRAY_BUFFER,null)}b(t){const e=this.ba;e.bindBuffer(e.ARRAY_BUFFER,this.e),!this.g||this.f<t.byteLength?(e.bufferData(e.ARRAY_BUFFER,t,this.dc?e.DYNAMIC_DRAW:e.STATIC_DRAW),this.g=!0,this.f=t.byteLength):e.bufferSubData(e.ARRAY_BUFFER,0,t),e.bindBuffer(e.ARRAY_BUFFER,null)}d(){return this.f}};var Bt;(function(t){t[t.GFLOAT=0]="GFLOAT",t[t.GUNSIGNED_BYTE=1]="GUNSIGNED_BYTE"})(Bt||(Bt={}));class qt{constructor(e,i,n,r,o,l){this.f=e,this.a=i,this.c=n,this.d=r,this.e=o,this.b=l}}function Gn(t,e){switch(e){case Bt.GFLOAT:return t.FLOAT;case Bt.GUNSIGNED_BYTE:return t.UNSIGNED_BYTE}}const qn=class{constructor(t,e){this.dc=t,this.ba=e,this.f=null,this.e=[],this.f=e.createVertexArrayOES()}a(t){this.dc,this.c(),t.c(),this.b(),this.e.push(t)}d(t,e){const i=this.dc;this.c(),t.c();for(const n of e)i.enableVertexAttribArray(n.f),i.vertexAttribPointer(n.f,n.a,Gn(i,n.c),n.d,n.e,n.b);this.b(),this.e.push(t)}c(){this.ba.bindVertexArrayOES(this.f)}b(){this.ba.bindVertexArrayOES(null)}},w=class{constructor(t,e){this.ba=t,this.dc=e,this.e=[]}a(t){this.f=t}d(t,e){this.e.push({buffer:t,bindings:e})}c(){const t=this.ba;this.f.c();const e=this.dc.e();for(const i of this.e){i.b.c();for(const n of i.a)this.dc.c(n.f),t.vertexAttribPointer(n.f,n.a,Gn(t,n.c),n.d,n.e,n.b)}this.dc.d(e)}b(){}};class R{}class B{constructor(e,i,n,r){this.b=e,this.c=i,this.a=n,this.d=r}}class j{constructor(e,i){this.a=e,this.b=i}}class q{constructor(e,i){this.b=e,this.a=i}}class Q extends R{}const K=class extends Q{constructor(t,e,i,n){super(),this.d=t,this.e=e,this.cba=i,this.ba=n}b(){return this.cba.a}a(t){const e=this.cba;t.a(this.e),t.e(e.a),t.d(e.f),t.b(e.e),t.j(e.b),t.g(e.c),t.c(e.d),Ze(this.e.d(),this.ba)}},et=class{constructor(t,e,i,n){if(this.ba=t,this.c=Ai(t,[i,n],Object.keys(e),null),!this.c)throw"Failed to create program"}a(){this.ba.useProgram(this.c.program)}d(){return this.c}};class Z{static e(e){const i=32767&e;return i<Et.length?Et[i]:(WH.debug("Unknown shader effect:",i),["PS_Combiners_Opaque","VS_Diffuse_T1"])}static f(e,i){let n="";return e==-1e3&&i==3?"Skin":32768&e?Z.e(e)[0]:(i==1?n=112&e?"PS_Combiners_Mod":"PS_Combiners_Opaque":n=(112&e?"PS_Combiners_Mod":"PS_Combiners_Opaque")+"_"+(112&e?["Opaque","Mod","Mod","Add","Mod2x","Mod","Mod2xNA","AddNA"]:["Opaque","Mod","Mod","AddAlpha","Mod2x","Mod","Mod2xNA","AddAlpha"])[7&e],n)}static c(e,i){let n="";if(e==-1e3&&i==3)n="T1_T1_T1";else{if(32768&e)return Z.e(e)[1];n=i==1?128&e?"Env":16384&e?"T2":"T1":128&e?8&e?"Env_Env":"Env_T1":8&e?"T1_Env":16384&e?"T1_T2":"T1_T1"}return"VS_Diffuse_"+n}static d(e,i,n){const r=Z.f(e,i),o=Z.c(e,i),l="Wow."+o+"_"+r;if(x._GetProgram(l))return{name:l};const h={shaders:[Z.a(o,n),Z.g(o,r,!1)],attributes:{position:"aPosition",normal:"aNormal",texcoord0:"aTexCoord0",texcoord1:"aTexCoord1"}};return x.RegisterProgram(l,h),{name:l}}static b(e){const i={},n={texcoord1:function(r,o){r.INPUT_TEXCOORD1="aTexCoord"+o}};for(let r in e.options){const o=e.options[r];n[r](i,o)}return{name:"Wow."+e.name,config:i}}static h(e){var i="";if(i+=`lTexCoord1 = (uTextureMatrix1 * vec4(vTexCoord1, 0, 1)).st;
`,i+=`lTexCoord2 = (uTextureMatrix2 * vec4(vTexCoord2, 0, 1)).st;
`,e.slice(0,2)==="VS"){let n=(e=e.slice(3)).split("_"),r=n[0];if(r==="Diffuse"||r==="Color"){i="",n.splice(0,1);let o={T1:["uTextureMatrix1","vTexCoord1"],T2:["uTextureMatrix2","vTexCoord2"],T3:["","aTexCoord2"],Env:["","texEnv"]},l=1;for(let h in n)o[n[h]]?(o[n[h]][0]&&o[n[h]][1]!="texEnv"?i+="lTexCoord"+l+" = ("+o[n[h]][0]+" * vec4("+o[n[h]][1]+`, 0, 1)).st;
`:o[n[h]][1]=="texEnv"?i+="lTexCoord"+l+` = texEnv;
`:i+="lTexCoord"+l+" = (uTextureMatrix"+l+" * vec4("+o[n[h]][1]+`, 0, 1)).st;
`,l++):WH.debug("Missing vertex shader def?",e)}}return i}static a(e,i){var n;return`attribute vec3 aPosition;
attribute vec3 aNormal;
attribute vec2 aTexCoord0;
attribute vec2 aTexCoord1;
attribute vec3 aColor;
`+((n={SKINNING:i}).SKINNING?`attribute vec4 aBoneWeights;
attribute vec4 aBones;
`:"")+`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vTexCoord1;
varying vec2 vTexCoord2;
uniform mat4 uModelMatrix;
uniform mat4 uPanningMatrix;
uniform mat4 uViewMatrix;
uniform mat4 uInvTranspViewModelMat;
uniform mat4 uProjMatrix;
uniform vec3 uCameraPos;
`+(n.SKINNING?`uniform sampler2D uBoneMatricesTex;
#define ROW0_U ((0.5 + 0.0) / 4.)
#define ROW1_U ((0.5 + 1.0) / 4.)
#define ROW2_U ((0.5 + 2.0) / 4.)
#define ROW3_U ((0.5 + 3.0) / 4.)
const float numBones = 256.0;
mat4 getBoneMatrix(float boneNdx) {
float v = (boneNdx + 0.5) / numBones;
return mat4(
texture2D(uBoneMatricesTex, vec2(ROW0_U, v)),
texture2D(uBoneMatricesTex, vec2(ROW1_U, v)),
texture2D(uBoneMatricesTex, vec2(ROW2_U, v)),
texture2D(uBoneMatricesTex, vec2(ROW3_U, v))
);
}
highp mat4 transpose(in highp mat4 inMatrix) {
highp vec4 i0 = inMatrix[0];
highp vec4 i1 = inMatrix[1];
highp vec4 i2 = inMatrix[2];
highp vec4 i3 = inMatrix[3];
highp mat4 outMatrix = mat4(
vec4(i0.x, i1.x, i2.x, i3.x),
vec4(i0.y, i1.y, i2.y, i3.y),
vec4(i0.z, i1.z, i2.z, i3.z),
vec4(i0.w, i1.w, i2.w, i3.w)
);
return outMatrix;
}
mat4 inverse(mat4 m) {
float
a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],
a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],
a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],
a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],
b00 = a00 * a11 - a01 * a10,
b01 = a00 * a12 - a02 * a10,
b02 = a00 * a13 - a03 * a10,
b03 = a01 * a12 - a02 * a11,
b04 = a01 * a13 - a03 * a11,
b05 = a02 * a13 - a03 * a12,
b06 = a20 * a31 - a21 * a30,
b07 = a20 * a32 - a22 * a30,
b08 = a20 * a33 - a23 * a30,
b09 = a21 * a32 - a22 * a31,
b10 = a21 * a33 - a23 * a31,
b11 = a22 * a33 - a23 * a32,
det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;
return mat4(
a11 * b11 - a12 * b10 + a13 * b09,
a02 * b10 - a01 * b11 - a03 * b09,
a31 * b05 - a32 * b04 + a33 * b03,
a22 * b04 - a21 * b05 - a23 * b03,
a12 * b08 - a10 * b11 - a13 * b07,
a00 * b11 - a02 * b08 + a03 * b07,
a32 * b02 - a30 * b05 - a33 * b01,
a20 * b05 - a22 * b02 + a23 * b01,
a10 * b10 - a11 * b08 + a13 * b06,
a01 * b08 - a00 * b10 - a03 * b06,
a30 * b04 - a31 * b02 + a33 * b00,
a21 * b02 - a20 * b04 - a23 * b00,
a11 * b07 - a10 * b09 - a12 * b06,
a00 * b09 - a01 * b07 + a02 * b06,
a31 * b01 - a30 * b03 - a32 * b00,
a20 * b03 - a21 * b01 + a22 * b00) / det;
}
`:"")+`void main(void) {
mat4 boneTransformMat =  mat4(1.0);
`+(n.SKINNING?`if (length(aBoneWeights) > 0.0) {
boneTransformMat =  mat4(0.0);
for (int i = 0; i < 4; i++) {
boneTransformMat += getBoneMatrix(aBones[i]) * aBoneWeights[i];
}
}
mat4 viewModelMat = uViewMatrix * uModelMatrix * boneTransformMat;
mat4 invTranspViewModelMat = transpose(inverse(viewModelMat));
`:`mat4 viewModelMat = uViewMatrix * uModelMatrix;
mat4 invTranspViewModelMat = uInvTranspViewModelMat;
`)+`vec4 pos = viewModelMat * vec4(aPosition, 1);
vPosition = pos.rgb;
gl_Position = uProjMatrix * pos;
vTexCoord1 = aTexCoord0;
vTexCoord2 = aTexCoord1;
vNormal = normalize((invTranspViewModelMat * vec4(aNormal, 0.0)).xyz);
}
`}static g(e,i,n){let r=ht[i];r||(WH.debug("Missing pixel shader def",i),r=ht[i="PS_Combiners_Opaque_Mod"]);let o="		"+r.slice(1,r.length).join(`
		`);for(let d=0;d<r[0];d++){let u=d+1;o="vec4 tex"+d+" = texture2D(uTexture"+u+", lTexCoord"+u+`.st);
`+o}let l=this.h(e);var h;return`precision mediump float;
varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vTexCoord1;
varying vec2 vTexCoord2;
varying vec2 vTexCoord3;
varying vec2 vTexCoord4;
uniform bool uHasAlpha;
uniform bool uHasSpecEmiss;
uniform bool uHasEmissiveGlowing;
uniform int uBlendMode;
uniform bool uUnlit;
uniform vec4 uColor;
uniform vec4 uAmbientColor;
uniform vec4 uDiffuseColor;
uniform vec4 uPrimaryColor;
uniform vec4 uSecondaryColor;
uniform vec3 uLightDir1;
uniform vec3 uLightDir2;
uniform vec3 uLightDir3;
uniform mat4 uTextureMatrix1;
uniform mat4 uTextureMatrix2;
uniform mat4 uTextureMatrix3;
uniform mat4 uTextureMatrix4;
uniform sampler2D uTexture1;
uniform sampler2D uTexture2;
uniform sampler2D uTexture3;
uniform sampler2D uTexture4;
uniform sampler2D uAlpha;
uniform vec4 uTexSampleAlpha;
`+((h={EXCERPT_TEX_COORD:l,EXCERPT_BASE:o,GRADIENT:n}).GRADIENT?`uniform vec4 u_gradGradientColors_0;
uniform vec4 u_gradGradientColors_1;
uniform vec4 u_gradGradientColors_2;
uniform vec4 u_gradEdgeColor;
uniform vec4 u_gradBoundingBox;
uniform vec4 u_gradUpVec;
uniform vec4 u_gradFlags;
uniform vec4 u_mulLum_OpaqMat;
`:"")+`vec2 sphereMap(vec3 vertex, vec3 normal) {
vec3 normPos = (normalize(vertex.xyz));
vec3 reflection = reflect(normPos, normalize(normal));
reflection = vec3(reflection.x, reflection.y, reflection.z + 1.0);
vec2 texCoord = ((normalize(reflection).xy * 0.5) + vec2(0.5));
return texCoord;
}
void main(void) {
vec2 lTexCoord1 = vec2(0.0);
vec2 lTexCoord2 = vec2(0.0);
vec2 lTexCoord3 = vec2(0.0);
vec4 _output = vec4(1.0);
vec4 _input = uColor;
vec3 _specular = vec3(0.0);
vec2 texEnv = sphereMap(vPosition.xyz,normalize(vNormal.xyz));
`+(h.EXCERPT_TEX_COORD?h.EXCERPT_TEX_COORD:"")+(h.EXCERPT_BASE?h.EXCERPT_BASE:"")+`_output.a = _output.a * uDiffuseColor.a;
if (uBlendMode == 13) {
_output.a = _output.a * _input.a;
} else if (uBlendMode == 1) {
if (_output.a < (128.0/255.0))
discard;
_output.a = _input.a;
} else if (uBlendMode == 0) {
_output.a = _input.a;
} else {
_output.a = _output.a * _input.a;
}
if (!uUnlit) {
vec4 litColor = uAmbientColor;
vec3 normal = normalize(vNormal);
float dp = max(0.0, dot(normal, uLightDir1));
litColor += uPrimaryColor * dp;
dp = max(0.0, dot(normal, uLightDir2));
litColor += uSecondaryColor * dp;
dp = max(0.0, dot(normal, uLightDir3));
litColor += uSecondaryColor * dp;
litColor = clamp(litColor, vec4(0,0,0,0), vec4(1,1,1,1));
_output.rgb *= (litColor * uDiffuseColor).rgb;
}
_output += vec4(_specular, 0.0);
`+(h.GRADIENT?`float power = u_gradEdgeColor.w;
float midValue = u_gradGradientColors_2.w;
float opaqueMaterial = u_mulLum_OpaqMat.y;
float lum = clamp(dot(_output.xyz, vec3(0.212599993, 0.715200007, 0.0722000003)), 0.0, 1.0);
float val0 = 0.0;
float val1 = midValue;
if (lum > midValue) {
val0 = midValue;
val1 = 1.0;
}
float lerpValue = clamp(((lum - val0) / (val1 - val0)), 0.0, 1.0);
vec3 gradColor0 = u_gradGradientColors_0.xyz;
vec3 gradColor1 = u_gradGradientColors_1.xyz;
if (lum > midValue) {
gradColor0 = u_gradGradientColors_1.xyz;
gradColor1 = u_gradGradientColors_2.xyz;
}
vec3 gradientColor = mix(gradColor0, gradColor1, vec3(lerpValue));
bool flipNormal = ((u_gradGradientColors_0.w > 0.0) && (vNormal.z > 0.0));
vec3 normal = flipNormal ? -vNormal.xyz : vNormal.xyz;
vec2 term = vec2(dot(-(vPosition.xyz), normal), dot(normalize(-(vPosition.xyz)), (normal * vec3(0.05, 0.05, 1.0))));
vec2 invTerm = (vec2(1.0) - clamp(term, 0.0, 1.0));
vec2 f = (invTerm * invTerm);
float fresnel_rim = pow((f.x + f.y), power);
bool disableHeightFade = bool(u_gradFlags.x);
float visMod = 0.0;
vec4 res = _output;
vec3 distVecTest = vec3(0,0,0);
if (!(disableHeightFade))
{
vec3 distVec = (vPosition - u_gradBoundingBox.xyz);
float _dot = dot(distVec, u_gradUpVec.xyz);
float relHeight = (_dot * u_gradBoundingBox.w);
bool invertHeightFade = bool(u_gradFlags.w);
distVecTest = vec3(relHeight);
relHeight = invertHeightFade ? clamp((1.0 - relHeight), 0.0, 1.0) : relHeight;
float visMod = clamp((relHeight * 1.66666663), 0.0, 0.899999976);
visMod = (visMod * visMod);
res = vec4(_output.r, _output.g, _output.b, (_output.w * visMod));
}
vec3 lerp = mix(gradientColor, u_gradEdgeColor.xyz, vec3(fresnel_rim));
float multiplyLum = u_mulLum_OpaqMat.x;
if (bool(multiplyLum))
{
res = vec4(lerp.xyz, (res.w * lum));
}
else
{
res = vec4(lerp.xyz, res.w);
}
_output = mix(_output, res, vec4(u_gradFlags.y));
_output = vec4(_output.xyz, res.a * _output.a);
`:"")+`gl_FragColor = _output;
}
`}}const Et=[["PS_Combiners_Opaque_Mod2xNA_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_AddAlpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_AddAlpha_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Mod2xNA_Alpha_Add","VS_Diffuse_T1_Env_T1","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Mod_AddAlpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_AddAlpha","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_AddAlpha","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_AddAlpha_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Alpha_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Mod2xNA_Alpha_3s","VS_Diffuse_T1_Env_T1","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Opaque_AddAlpha_Wgt","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_Add_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_ModNA_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_AddAlpha_Wgt","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_AddAlpha_Wgt","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_AddAlpha_Wgt","VS_Diffuse_T1_T2","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Mod_Add_Wgt","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Mod2xNA_Alpha_UnshAlpha","VS_Diffuse_T1_Env_T1","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Mod_Dual_Crossfade","VS_Diffuse_T1","HS_T1","DS_T1"],["PS_Combiners_Mod_Depth","VS_Diffuse_EdgeFade_T1","HS_T1","DS_T1"],["PS_Combiners_Opaque_Mod2xNA_Alpha_Alpha","VS_Diffuse_T1_Env_T2","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Mod_Mod","VS_Diffuse_EdgeFade_T1_T2","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_Masked_Dual_Crossfade","VS_Diffuse_T1_T2","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Alpha","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Mod2xNA_Alpha_UnshAlpha","VS_Diffuse_T1_Env_T2","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Mod_Depth","VS_Diffuse_EdgeFade_Env","HS_T1","DS_T1"],["PS_Guild","VS_Diffuse_T1_T2_T1","HS_T1_T2_T3","DS_T1_T2"],["PS_Guild_NoBorder","VS_Diffuse_T1_T2","HS_T1_T2","DS_T1_T2_T3"],["PS_Guild_Opaque","VS_Diffuse_T1_T2_T1","HS_T1_T2_T3","DS_T1_T2"],["PS_Illum","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_Mod_Mod_Const","VS_Diffuse_T1_T2_T3","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Mod_Mod_Mod_Const","VS_Color_T1_T2_T3","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Opaque","VS_Diffuse_T1","HS_T1","DS_T1"],["PS_Combiners_Mod_Mod2x","VS_Diffuse_EdgeFade_T1_T2","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod","VS_Diffuse_EdgeFade_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_Mod_Depth","VS_Diffuse_EdgeFade_T1_T2","HS_T1_T2","DS_T1_T2"]],ht={PS_Combiners_Add:[1,"_output.rgb = _input.rgb + tex0.rgb;","_output.a = _input.a + tex0.a;"],PS_Combiners_Decal:[1,"_output.rgb = mix(_input.rgb, tex0.rgb, _input.a);","_output.a = _input.a;"],PS_Combiners_Fade:[1,"_output.rgb = mix(tex0.rgb, _input.rgb, _input.a);","_output.a = _input.a;"],PS_Combiners_Mod:[1,"_output.rgb = _input.rgb * tex0.rgb;","_output.a = tex0.a;"],PS_Combiners_Mod2x:[1,"_output.rgb = _input.rgb * tex0.rgb * 2.0;","_output.a = tex0.a * 2.0;"],PS_Combiners_Opaque:[1,"_output.rgb = _input.rgb * tex0.rgb;","_output.a = 1.0;"],PS_Combiners_Add_Add:[2,"_output.rgb = (_input.rgb + tex0.rgb) + tex1.rgb;","_output.a = (_input.a + tex0.a) + tex1.a;"],PS_Combiners_Add_Mod:[2,"_output.rgb = (_input.rgb + tex0.rgb) * tex1.rgb;","_output.a = (_input.a + tex0.a) * tex1.a;"],PS_Combiners_Add_Mod2x:[2,"_output.rgb = (_input.rgb + tex0.rgb) * tex1.rgb * 2.0;","_output.a = (_input.a + tex0.a) * tex1.a * 2.0;"],PS_Combiners_Add_Opaque:[2,"_output.rgb = (_input.rgb + tex0.rgb) * tex1.rgb;","_output.a = _input.a + tex0.a;"],PS_Combiners_Mod_AddNA:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_output.a = tex0.a;","_specular = tex1.rgb;"],PS_Combiners_Mod_Mod:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb;","_output.a = tex0.a * tex1.a;"],PS_Combiners_Mod_Mod2x:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 2.0;","_output.a = tex0.a * tex1.a * 2.0;"],PS_Combiners_Mod_Add:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_output.a = tex0.a + tex1.a;","_specular = tex1.rgb;"],PS_Combiners_Mod_Mod2xNA:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 2.0;","_output.a = tex0.a;"],PS_Combiners_Mod_Opaque:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb;","_output.a = tex0.a;"],PS_Combiners_Mod2x_Add:[2,"_output.rgb = (_input.rgb * tex0.rgb) * 2.0 + tex1.rgb;","_output.a = (tex0.a) * 2.0 + tex1.a;"],PS_Combiners_Mod2x_Mod2x:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 4.0;","_output.a = (tex0.a) * tex1.a * 4.0;"],PS_Combiners_Mod2x_Opaque:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 2.0;","_output.a = tex0.a * 2.0;"],PS_Combiners_Opaque_Add:[2,"_output.rgb = (_input.rgb * tex0.rgb) + tex1.rgb;","_output.a = _input.a + tex1.a;"],PS_Combiners_Opaque_AddAlpha:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_specular = (tex1.rgb * tex1.a);"],PS_Combiners_Opaque_AddAlpha_Wgt:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_specular = (tex1.rgb * tex1.a) * uTexSampleAlpha.g;"],PS_Combiners_Opaque_AddAlpha_Alpha:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_specular = (tex1.rgb * tex1.a * (1.0 - tex0.a));"],PS_Combiners_Opaque_AddNA:[2,"_output.rgb = (_input.rgb * tex0.rgb) + tex1.rgb;","_output.a = _input.a;"],PS_Combiners_Opaque_Mod:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb;","_output.a = tex1.a;"],PS_Combiners_Opaque_Mod2x:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 2.0;","_output.a = tex1.a * 2.0;"],PS_Combiners_Opaque_Mod2xNA:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 2.0;",""],PS_Combiners_Opaque_Mod2xNA_Alpha:[2,"_output.rgb = _input.rgb * mix(tex0.rgb * tex1.rgb * 2.0, tex0.rgb, vec3(tex0.a));",""],PS_Combiners_Opaque_Opaque:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb;",""],PS_Combiners_Opaque_Mod2xNA_Alpha_Add:[3,"_output.rgb = _input.rgb * mix(tex0.rgb * tex1.rgb * 2.0, tex0.rgb, vec3(tex0.a));","_specular = tex2.rgb * tex2.a * uTexSampleAlpha.b;"],PS_Combiners_Mod_Mod_Mod_Const:[3,"_output.rgb = _input.rgb * (tex0 * tex1 * tex2).rgb;","_output.a = (tex0 * tex1 * tex2).a;"],PS_Combiners_Mod_AddAlpha:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_output.a = tex0.a;","_specular = tex1.rgb * tex1.a;"],PS_Combiners_Mod_AddAlpha_Wgt:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_output.a = tex0.a;","_specular = tex1.rgb * tex1.a * uTexSampleAlpha.g;"],PS_Combiners_Mod_AddAlpha_Alpha:[2,"_output.rgb = _input.rgb * tex0.rgb;","_output.a = (tex0.a + tex1.a * (0.3 * tex1.r + 0.59 * tex1.g + 0.11 * tex1.b));","_specular = tex1.rgb * tex1.a * (1.0 - tex0.a);"],PS_Combiners_Opaque_Mod_Add_Wgt:[2,"_output.rgb = _input.rgb * mix(tex0.rgb, tex1.rgb, vec3(tex1.a));","_specular = (tex0.rgb * tex0.a) * uTexSampleAlpha.r;"],PS_Guild:[3,"_output.rgb = _input.rgb * mix(tex0.rgb * mix(vec3(1.0, 1.0, 1.0), tex1.rgb * vec3(1.0, 1.0, 1.0), vec3(tex1.a)), tex2.rgb * vec3(1.0, 1.0, 1.0), vec3(tex2.a));","_output.a = tex0.a;"],PS_Guild_Opaque:[3,"_output.rgb = _input.rgb * mix(tex0.rgb * mix(vec3(1.0, 1.0, 1.0), tex1.rgb * vec3(1.0, 1.0, 1.0), vec3(tex1.a)), tex2.rgb * vec3(1.0, 1.0, 1.0), vec3(tex2.a));",""],PS_Guild_NoBorder:[2,"_output.rgb = _input.rgb * tex0.rgb * mix(vec3(1.0, 1.0, 1.0), tex1.rgb * vec3(1.0, 1.0, 1.0), vec3(tex1.a));","_output.a = tex0.a;"],PS_Combiners_Opaque_Alpha_Alpha:[2,"_output.rgb = _input.rgb * mix(mix(tex0.rgb, tex1.rgb, vec3(tex1.a)), tex0.rgb, vec3(tex0.a));",""],PS_Combiners_Opaque_Mod2xNA_Alpha_3s:[3,"_output.rgb = _input.rgb * mix(tex0.rgb * tex1.rgb * 2.0, tex2.rgb, vec3(tex2.a));"],PS_Combiners_Mod_Add_Alpha:[2,"_output.rgb = _input.rgb * tex0.rgb;","_output.a = (tex0.a + tex1.a);","_specular = tex1.rgb * (1.0 - tex0.a);"],PS_Combiners_Opaque_ModNA_Alpha:[2,"_output.rgb = _input.rgb * mix(tex0.rgb * tex1.rgb, tex0.rgb, vec3(tex0.a));",""],PS_Combiners_Opaque_Mod2xNA_Alpha_UnshAlpha:[3,"float glowOpacity = clamp((tex2.a * vec4(1.0, 1.0, 1.0, 1.0).z), 0.0, 1.0); _output.rgb = _input.rgb * mix(tex0.rgb * tex1.rgb * 2.000000, tex0.rgb, vec3(tex0.a)) * (1.0 - glowOpacity);","_specular = tex2.rgb * glowOpacity;"],PS_Combiners_Opaque_Mod2xNA_Alpha_Alpha:[3,"_output.rgb = _input.rgb * mix(mix(tex0.rgb * tex1.rgb * 2.000000, tex2.rgb, vec3(tex2.a)), tex0.rgb, vec3(tex0.a));",""],PS_Combiners_Mod_Depth:[1,"_output.rgb = _input.rgb * tex0.rgb;","_output.a = tex0.a;"],PS_Combiners_Opaque_Alpha:[2,"_output.rgb = _input.rgb * mix(tex0.rgb, tex1.rgb, vec3(tex1.a));",""],Skin:[3,`//Fresnel Rim\r
if (uHasSpecEmiss) {\r
    vec3 emissiveColor = tex2.rgb;\r
    vec3 emissiveTerm = tex2.rgb;\r
    if (uHasEmissiveGlowing) {\r
        vec3 eyeVec_120 = vPosition.xyz;\r
        vec3 t121 = -(eyeVec_120);\r
        vec2 term_126 = vec2(dot(t121, vNormal), dot(normalize(t121), (vNormal * vec3(0.0500000007, 0.0500000007, 1.0))));\r
        vec2 invTerm_128 = (vec2(1.0) - clamp(term_126, 0.0, 1.0));\r
        vec2 f_129 = (invTerm_128 * invTerm_128);\r
        float fresnel_rim_133 = pow((f_129.x + f_129.y), 0.600000024);\r
        vec3 t136 = (tex2.rgb /*+ ((vec3(0.0500000007, 0.0, 0.400000006) * 1.0) * fresnel_rim_133)*/);\r
        emissiveColor = vec3(t136.r, tex2.g, t136.b);\r
\r
        float t267 = dot(normalize(vNormal),  normalize(-(vPosition.xyz)));\r
        emissiveTerm = mix(vec3(0.0), 2.0*emissiveColor, vec3(pow(clamp(t267, 0.0, 1.0), (( 128.0 * (tex2.a)) + 9.99999975e-006))));\r
    }\r
\r
    _output.rgb = _input.rgb * tex0.rgb + tex1.rgb + emissiveTerm.rgb;\r
} else {\r
    _output.rgb = _input.rgb * tex0.rgb;\r
}\r
_output.a = tex0.a; //\r
`],PS_Combiners_Mod_Dual_Crossfade:[3,"_output.rgb = _input.rgb * mix(mix(tex0, texture2D(uTexture2,vTexCoord1), vec4(clamp(uTexSampleAlpha.g, 0.000000, 1.000000))), texture2D(uTexture3,vTexCoord1), vec4(clamp(uTexSampleAlpha.b, 0.000000, 1.000000))).rgb;","_output.a = mix(mix(tex0, texture2D(uTexture2,vTexCoord1), vec4(clamp(uTexSampleAlpha.g, 0.000000, 1.000000))), texture2D(uTexture3,vTexCoord1), vec4(clamp(uTexSampleAlpha.b, 0.000000, 1.000000))).a;"],PS_Combiners_Mod_Masked_Dual_Crossfade:[4,"_output.rgb = _input.rgb * mix(mix(tex0, texture2D(uTexture2,texCoord), vec4(clamp(uTexSampleAlpha.g, 0.000000, 1.000000))), texture2D(uTexture3,texCoord), vec4(clamp(uTexSampleAlpha.b, 0.000000, 1.000000))).rgb;","_output.a = mix(mix(tex0, texture2D(uTexture2,texCoord), vec4(clamp(uTexSampleAlpha.g, 0.000000, 1.000000))), texture2D(uTexture3,texCoord), vec4(clamp(uTexSampleAlpha.b, 0.000000, 1.000000))).a * texture(uTexture4,texCoord2).a;"],PS_Combiners_Mod_Mod_Depth:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb;","_output.a = tex0.a * tex1.a;"]},lt=Z,wt=class{constructor(t){this.b=t,this.a=new Set}e(){const t=this.a;return this.a=new Set,t}c(t){this.a.has(t)||(this.b.enableVertexAttribArray(t),this.a.add(t))}d(t){const e=this.b;[...t].filter(i=>!this.a.has(i)).forEach(i=>e.disableVertexAttribArray(i))}},ot=class{},Zt=class{},te=class extends Zt{};function yt(){var t=new O(4);return O!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function mt(t,e,i,n){var r=new O(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r}function Jt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function pe(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}function Nt(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function Je(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function Ft(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function Kt(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.hypot(e,i,n,r)}function Ke(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],l=i*i+n*n+r*r+o*o;return l>0&&(l=1/Math.sqrt(l)),t[0]=i*l,t[1]=n*l,t[2]=r*l,t[3]=o*l,t}function ae(t,e,i){var n=e[0],r=e[1],o=e[2],l=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*l,t[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*l,t[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*l,t[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*l,t}var Ao=Kt;(function(){var t=yt()})();const Ih=class extends te{constructor(t,e){super(),this.j=e,this.ed=M(),this.i=E(0,0,0),this.f=yt(),this.g=mt(0,0,0,0),this.h=new Mi(t,40*e.length/4,!0),this.ba(e)}dc(t,e){const i=this.cba;let n=this.j.length;for(let r=0;r<n;++r){if(!e.has(r))continue;Y(this.i,0,0,0),pe(this.g,0,0,0,0);const o=this.j[r];let l=!1;for(let h=0;h<4;++h){const d=o.f[h]/255;if(d>0){const u=t[o.d[h]];Fe(this.ed,o.g,u.q),ae(this.f,o.c,u.h),this.i[0]=this.i[0]+this.ed[0]*d,this.i[1]=this.i[1]+this.ed[1]*d,this.i[2]=this.i[2]+this.ed[2]*d,this.g[0]=this.g[0]+this.f[0]*d,this.g[1]=this.g[1]+this.f[1]*d,this.g[2]=this.g[2]+this.f[2]*d,l=!0}}if(l){let h=10*r;i[h++]=this.i[0],i[h++]=this.i[1],i[h++]=this.i[2],i[h++]=this.g[0],i[h++]=this.g[1],i[h++]=this.g[2]}}this.h.b(this.cba)}ba(t){const e=40*t.length/4;this.cba=new Float32Array(e);const i=this.cba,n=t;let r=0;for(let o=0;o<n.length;++o)i[r++]=n[o].g[0],i[r++]=n[o].g[1],i[r++]=n[o].g[2],i[r++]=n[o].c[0],i[r++]=n[o].c[1],i[r++]=n[o].c[2],i[r++]=n[o].i,i[r++]=n[o].a,i[r++]=n[o].b,i[r++]=n[o].e;this.h.b(this.cba)}b(t){this.h.b(t)}d(){return this.h.d()}c(){this.h.c()}a(){this.h.a()}},Oh=class extends te{constructor(t,e){super(),this.cba=e,this.f=new Mi(t,48*e.length,!0),this.ba(e)}dc(t,e){}ba(t){const e=48*t.length;this.ed=new Uint8Array(e);let i=new DataView(this.ed.buffer);const n=t;let r=0;for(let o=0;o<n.length;++o)i.setFloat32(r,n[o].g[0],!0),r+=4,i.setFloat32(r,n[o].g[1],!0),r+=4,i.setFloat32(r,n[o].g[2],!0),r+=4,i.setFloat32(r,n[o].c[0],!0),r+=4,i.setFloat32(r,n[o].c[1],!0),r+=4,i.setFloat32(r,n[o].c[2],!0),r+=4,i.setUint8(r,n[o].d[0]),r+=1,i.setUint8(r,n[o].d[1]),r+=1,i.setUint8(r,n[o].d[2]),r+=1,i.setUint8(r,n[o].d[3]),r+=1,i.setUint8(r,n[o].f[0]),r+=1,i.setUint8(r,n[o].f[1]),r+=1,i.setUint8(r,n[o].f[2]),r+=1,i.setUint8(r,n[o].f[3]),r+=1,i.setFloat32(r,n[o].i,!0),r+=4,i.setFloat32(r,n[o].a,!0),r+=4,i.setFloat32(r,n[o].b,!0),r+=4,i.setFloat32(r,n[o].e,!0),r+=4;this.f.b(this.ed)}b(t){this.f.b(t)}d(){return this.f.d()}c(){this.f.c()}a(){this.f.a()}},Rh=class{b(){return{}}a(t){}},Uh=class{constructor(t,e){this.e=t,this.d=e,this.d=256,this.ba=new Float32Array(16*this.d),this.c=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.c),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null)}b(){return{uBoneMatricesTex:this.c}}a(t){const e=Math.min(256,t.length);for(let n=0;n<e;n++)this.ba.set(t[n].q,16*n);const i=this.e;i.bindTexture(i.TEXTURE_2D,this.c),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,4,this.d,0,i.RGBA,i.FLOAT,this.ba),i.bindTexture(i.TEXTURE_2D,null)}};var di;(function(t){t[t.aPosition=0]="aPosition",t[t.aNormal=1]="aNormal",t[t.aTexCoord0=2]="aTexCoord0",t[t.aTexCoord1=3]="aTexCoord1"})(di||(di={}));const Ph={aPosition:di.aPosition,aNormal:di.aNormal,aTexCoord0:di.aTexCoord0,aTexCoord1:di.aTexCoord1},Bh=[new qt(di.aPosition,3,Bt.GFLOAT,!1,40,0),new qt(di.aNormal,3,Bt.GFLOAT,!1,40,12),new qt(di.aTexCoord0,2,Bt.GFLOAT,!1,40,24),new qt(di.aTexCoord1,2,Bt.GFLOAT,!1,40,32)];var we;(function(t){t[t.aPosition=0]="aPosition",t[t.aNormal=1]="aNormal",t[t.aBones=2]="aBones",t[t.aBoneWeights=3]="aBoneWeights",t[t.aTexCoord0=4]="aTexCoord0",t[t.aTexCoord1=5]="aTexCoord1"})(we||(we={}));const Nh={aPosition:we.aPosition,aNormal:we.aNormal,aBones:we.aBones,aBoneWeights:we.aBoneWeights,aTexCoord0:we.aTexCoord0,aTexCoord1:we.aTexCoord1},jh=[new qt(we.aPosition,3,Bt.GFLOAT,!1,48,0),new qt(we.aNormal,3,Bt.GFLOAT,!1,48,12),new qt(we.aBones,4,Bt.GUNSIGNED_BYTE,!1,48,24),new qt(we.aBoneWeights,4,Bt.GUNSIGNED_BYTE,!0,48,28),new qt(we.aTexCoord0,2,Bt.GFLOAT,!1,48,32),new qt(we.aTexCoord1,2,Bt.GFLOAT,!1,48,40)];var Qt;(function(t){t[t.aPosition=0]="aPosition",t[t.aColor=1]="aColor",t[t.aTexcoord0=2]="aTexcoord0",t[t.aTexcoord1=3]="aTexcoord1",t[t.aTexcoord2=4]="aTexcoord2",t[t.aAlphaCutoff=5]="aAlphaCutoff"})(Qt||(Qt={}));const Lh={[Qt.aPosition]:Qt.aPosition,[Qt.aColor]:Qt.aColor,[Qt.aTexcoord0]:Qt.aTexcoord0,[Qt.aTexcoord1]:Qt.aTexcoord1,[Qt.aTexcoord2]:Qt.aTexcoord2,[Qt.aAlphaCutoff]:Qt.aAlphaCutoff},zh=[new qt(Qt.aPosition,3,Bt.GFLOAT,!1,56,0),new qt(Qt.aColor,4,Bt.GFLOAT,!1,56,12),new qt(Qt.aTexcoord0,2,Bt.GFLOAT,!1,56,28),new qt(Qt.aTexcoord1,2,Bt.GFLOAT,!1,56,36),new qt(Qt.aTexcoord2,2,Bt.GFLOAT,!1,56,44),new qt(Qt.aAlphaCutoff,1,Bt.GFLOAT,!1,56,52)];var Qe;(function(t){t[t.aPosition=0]="aPosition",t[t.aColor=1]="aColor",t[t.aTexcoord0=2]="aTexcoord0"})(Qe||(Qe={}));const Hh={[Qe.aPosition]:Qe.aPosition,[Qe.aColor]:Qe.aColor,[Qe.aTexcoord0]:Qe.aTexcoord0},Gh=[new qt(Qe.aPosition,3,Bt.GFLOAT,!1,36,0),new qt(Qe.aColor,4,Bt.GFLOAT,!1,36,12),new qt(Qe.aTexcoord0,2,Bt.GFLOAT,!1,36,28)],qh=class{constructor(t,e){this.ba=t,this.hg=e,this.fe=new Map,this.ji=new wt(t.j());const i=t.j();this.lk=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.lk),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),i.bindTexture(i.TEXTURE_2D,null)}dc(){throw new Error("Method not implemented.")}o(){return this.ba}b(t){return new Mr(this.ba.j(),t,!1)}a(t){return this.ba.o?new Oh(this.ba.j(),t):new Ih(this.ba.j(),t)}c(t){return new Mi(this.ba.j(),t,!0)}h(t){return new Mi(this.ba.j(),t,!0)}f(t,e){const i=this.ba.fe(),n=i?new qn(this.ba.j(),i):new w(this.ba.j(),this.ji),r=this.ba.o?jh:Bh;return n.d(t,r),n.a(e),n}j(t,e){const i=this.ba.fe(),n=i?new qn(this.ba.j(),i):new w(this.ba.j(),this.ji);return n.a(e),n.d(t,zh),n}l(t,e){const i=this.ba.fe(),n=i?new qn(this.ba.j(),i):new w(this.ba.j(),this.ji);return n.a(e),n.d(t,Gh),n}m(t,e,i,n){return this.ba.o?new Uh(this.ba.j(),t):new Rh}d(t,e,i){const n=lt.f(i.b,i.c.length),r=lt.c(i.b,i.c.length),o="Wow."+r+"_"+n+(i.d?"_gradient":"");let l;this.fe.has(o)?l=this.fe.get(o):(l=new et(this.ba.j(),this.ba.o?Nh:Ph,lt.a(r,this.ba.o),lt.g(r,n,i.d)),this.fe.set(o,l));const h=Object.assign(Object.assign(Object.assign({},this.hg),t.b()),i.a);for(let d=0;d<Math.max(i.c.length,4);d++){let u=d<i.c.length?i.c[d].c:this.lk;h["uTexture"+(d+1).toString()]=u}return new K(this.ba.j(),l,e,h)}k(t,e,i){const n=Object.assign(Object.assign(Object.assign({},this.hg),t.b()),i.b);let r;const o="ParticleShader";this.fe.has(o)?r=this.fe.get(o):(r=new et(this.ba.j(),Lh,`attribute vec3 aPosition;\r
attribute vec4 aColor;\r
attribute vec2 aTexcoord0;\r
attribute vec2 aTexcoord1;\r
attribute vec2 aTexcoord2;\r
attribute float aAlphaCutoff;\r
\r
varying vec4 vColor;\r
varying vec2 vTexcoord0;\r
varying vec2 vTexcoord1;\r
varying vec2 vTexcoord2;\r
varying float vAlphaCutoff;\r
\r
uniform mat4 uModelMatrix;\r
uniform mat4 uViewMatrix;\r
uniform mat4 uProjMatrix;\r
\r
void main(void) {\r
    vec4 pos = vec4(aPosition, 1);\r
\r
    gl_Position = uProjMatrix * pos;\r
\r
    vColor = aColor;\r
    vTexcoord0 = aTexcoord0;\r
    vTexcoord1 = aTexcoord1;\r
    vTexcoord2 = aTexcoord2;\r
    vAlphaCutoff = aAlphaCutoff;\r
}`,`precision mediump float;\r
\r
varying vec4 vColor;\r
varying vec2 vTexcoord0;\r
varying vec2 vTexcoord1;\r
varying vec2 vTexcoord2;\r
varying float vAlphaCutoff;\r
\r
uniform bool uHasTexture;\r
uniform bool uHasTexture2;\r
uniform bool uHasTexture3;\r
uniform bool uHasAlpha;\r
uniform int uBlendMode;\r
uniform int uPixelShader;\r
uniform sampler2D uTexture0;\r
uniform sampler2D uTexture1;\r
uniform sampler2D uTexture2;\r
uniform float uAlphaTreshold;\r
\r
uniform float alphaMult;\r
uniform float colorMult;\r
\r
void main(void) {\r
    float lo_thresh = 0.01;\r
    vec4 color = vec4(1, 1, 1, 1);\r
    vec4 tex = vec4(1, 1, 1, 1);\r
    vec4 tex2 = vec4(1, 1, 1, 1);\r
    vec4 tex3 = vec4(1, 1, 1, 1);\r
    if (uHasTexture) {\r
        tex = texture2D(uTexture0, vTexcoord0).rgba;\r
    }\r
    if (uHasTexture2) {\r
        tex2 = texture2D(uTexture1, vTexcoord1).rgba;\r
    }\r
    if (uHasTexture3) {\r
        tex3 = texture2D(uTexture2, vTexcoord2).rgba;\r
    }\r
    vec4 finalColor = vec4((tex * vColor ).rgb, tex.a*vColor.a );\r
    vec3 matDiffuse = vec3(1.0);\r
    float opacity = 1.0;\r
    if (uPixelShader == 0) {\r
        matDiffuse = vColor.xyz * tex.rgb;\r
        opacity = tex.a*vColor.a;\r
    } else if (uPixelShader == 1) {\r
        vec4 textureMod = tex*tex2;\r
        float texAlpha = (textureMod.w * tex3.w);\r
        opacity = texAlpha*vColor.a;\r
        matDiffuse = vColor.xyz * 4.0 * textureMod.rgb;\r
    } else if (uPixelShader == 2) {\r
        vec4 textureMod = tex*tex2*tex3;\r
        float texAlpha = (textureMod.w);\r
        opacity = texAlpha*vColor.a;\r
        matDiffuse = vColor.xyz * textureMod.rgb;\r
    } else if (uPixelShader == 3) {\r
        vec4 textureMod = tex*tex2*tex3;\r
        float texAlpha = (textureMod.w);\r
        opacity = texAlpha*vColor.a;\r
\r
        matDiffuse = vColor.xyz * textureMod.rgb;\r
    } else if (uPixelShader == 4) {\r
        discard;\r
    }\r
\r
    finalColor = vec4(matDiffuse.rgb * colorMult, opacity * alphaMult);\r
\r
    if (finalColor.a < vAlphaCutoff ) discard;\r
    if (finalColor.a < uAlphaTreshold ) discard;\r
    gl_FragColor = finalColor;\r
}\r
`),this.fe.set(o,r));for(let l=0;l<i.a.length;l++)i.a[l]&&(n["uTexture"+l.toString()]=i.a[l].c);return new K(this.ba.j(),r,e,n)}e(t,e,i){const n=Object.assign(Object.assign(Object.assign({},this.hg),t.b()),i.a);let r;const o="RibbonShader";return this.fe.has(o)?r=this.fe.get(o):(r=new et(this.ba.j(),Hh,`attribute vec3 aPosition;\r
attribute vec4 aColor;\r
attribute vec2 aTexcoord0;\r
\r
uniform mat4 uViewMatrix;\r
uniform mat4 uProjMatrix;\r
\r
varying vec4 vColor;\r
varying vec2 vTexcoord0;\r
\r
void main() {\r
    vec4 aPositionVec4 = vec4(aPosition, 1);\r
    vColor = aColor;\r
    vTexcoord0 = aTexcoord0;\r
\r
    gl_Position = uProjMatrix * uViewMatrix * aPositionVec4;\r
}\r
\r
\r
`,`precision mediump float;\r
\r
varying vec4 vColor;\r
varying vec2 vTexcoord0;\r
uniform sampler2D uTexture;\r
\r
void main() {\r
    vec4 tex = texture2D(uTexture, vTexcoord0).rgba;\r
    gl_FragColor = vec4((vColor.rgb*tex.rgb), tex.a * vColor.a );\r
}\r
`),this.fe.set(o,r)),n.uTexture=i.b[0].c,new K(this.ba.j(),r,e,n)}n(t,e,i,n){const r=this.ba.j();let o=new ot;return o.f=e,o.b=t.b,o.h=r.TRIANGLES,o.e=t.c,o.g=t.a,o.c=n,o.a=i,o}g(t,e,i,n){const r=this.ba.j();let o=new ot;return o.f=e,o.b=t.b,o.h=r.TRIANGLE_STRIP,o.e=t.c,o.g=t.a,o.c=n,o.a=i,o}i(t){const e=this.ba.j(),i=e.createTexture();function n(o){return(o&o-1)==0}e.bindTexture(e.TEXTURE_2D,i),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),n(t.width)&&n(t.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR));const r=this.ba.dc;return r&&e.texParameteri(e.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY_EXT,this.ba.i),i}};var Eo;(function(t){t[t.GxBlend_UNDEFINED=-1]="GxBlend_UNDEFINED",t[t.GxBlend_Opaque=0]="GxBlend_Opaque",t[t.GxBlend_AlphaKey=1]="GxBlend_AlphaKey",t[t.GxBlend_Alpha=2]="GxBlend_Alpha",t[t.GxBlend_Add=3]="GxBlend_Add",t[t.GxBlend_Mod=4]="GxBlend_Mod",t[t.GxBlend_Mod2x=5]="GxBlend_Mod2x",t[t.GxBlend_ModAdd=6]="GxBlend_ModAdd",t[t.GxBlend_InvSrcAlphaAdd=7]="GxBlend_InvSrcAlphaAdd",t[t.GxBlend_InvSrcAlphaOpaque=8]="GxBlend_InvSrcAlphaOpaque",t[t.GxBlend_SrcAlphaOpaque=9]="GxBlend_SrcAlphaOpaque",t[t.GxBlend_NoAlphaAdd=10]="GxBlend_NoAlphaAdd",t[t.GxBlend_ConstantAlpha=11]="GxBlend_ConstantAlpha",t[t.GxBlend_Screen=12]="GxBlend_Screen",t[t.GxBlend_BlendAdd=13]="GxBlend_BlendAdd",t[t.GxBlend_MAX=14]="GxBlend_MAX"})(Eo||(Eo={}));const Wn=Eo,Wh=class{constructor(t){this.k=t,this.ba=-1,this.ji=-1,this.r=-1,this.t=-1,this.hg=-1,this.s=Wn.GxBlend_UNDEFINED,this.dc=null,this.fe=null,this.o=null,this.l=null,this.m=null}q(){this.ba=-1,this.ji=-1,this.r=-1,this.t=-1,this.hg=-1,this.s=Wn.GxBlend_UNDEFINED,this.dc=null,this.fe=null,this.o=null,this.l=null,this.m=null}e(t){this.s!=t&&(this.n(t),this.s=t)}b(t){const e=t?1:0;e!=this.ba&&(this.k.depthMask(t),this.ba=e)}d(t){const e=t?1:0;e!=this.ji&&(t?this.k.enable(this.k.DEPTH_TEST):this.k.disable(this.k.DEPTH_TEST),this.ji=e)}j(t){const e=t?1:0;e!=this.r&&(t?this.k.enable(this.k.CULL_FACE):this.k.disable(this.k.CULL_FACE),this.r=e)}c(t){const e=t?1:0;e!=this.t&&(t?this.k.frontFace(this.k.CCW):this.k.frontFace(this.k.CW),this.t=e)}g(t){this.hg!=t&&(this.k.colorMask((1&t)>0,(2&t)>0,(4&t)>0,(8&t)>0),this.hg=t)}h(t){this.fe!=t&&(t?t.c():t.a(),this.fe=t)}i(t){this.dc!=t&&(t?t.c():t.a(),this.dc=t)}f(t){this.o!=t&&(t?t.c():this.o.b(),this.o=t,this.dc=null,this.fe=null)}a(t){t!=this.l&&(t&&t.a(),this.l=t)}n(t){const e=this.k;switch(t==0?e.disable(e.BLEND):(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD)),t){case 0:break;case 1:e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ONE);break;case 2:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE);break;case 4:e.blendFuncSeparate(e.DST_COLOR,e.ZERO,e.ONE,e.ONE);break;case 5:e.blendFuncSeparate(e.DST_COLOR,e.SRC_COLOR,e.ONE,e.ONE);break;case 6:e.blendFuncSeparate(e.DST_COLOR,e.ONE,e.ONE,e.ONE);break;case 10:e.blendFunc(e.ONE,e.ONE);break;case 7:e.blendFuncSeparate(e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE,e.ONE);break;case 8:e.blendFuncSeparate(e.ONE_MINUS_SRC_ALPHA,e.ZERO,e.ONE,e.ONE);break;case 13:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE);break;default:throw 3735927486}}p(t){this.m!=t&&(t.a(this),this.m=t)}},Vh=class{constructor(t,e){this.m=t,this.h=e,this.n=!1,this.o=!1,this.ba=t.getExtension("OES_vertex_array_object"),this.dc=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.dc?(this.i=t.getParameter(this.dc.MAX_TEXTURE_MAX_ANISOTROPY_EXT),WH.debug("Texture anisotropy enabled",this.i)):WH.debug("Texture anisotropy disabled (not supported)"),this.n=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0,this.k=t.getExtension("OES_texture_float"),this.o=this.n&&this.k!=null,this.o?WH.debug("(float texture) Skinning in shader is supported"):WH.debug("(float texture) Skinning in shader is (not supported) "),this.l=new qh(this,e),this.g=new Wh(t)}j(){return this.m}fe(){return this.ba}c(){return this.l}d(t){const e=this.g,i=this.j();e.f(t.b),e.p(t.f),i.drawElements(t.h,t.g,i.UNSIGNED_SHORT,t.e)}b(){this.g.q()}a(){this.g.f(null)}e(t){this.b(),t.forEach(e=>{this.d(e)}),this.a()}},Xh=class{constructor(t,e){this.j=t,this.a=e,this.c=null,this.f=!1,this.e=0,this.h=0,e!=0&&(this.g=t.options.contentPath+"textures/"+e+WH.WebP.getImageExtension(),this.l=new Image,this.l.onload=()=>{this.d()},this.l.onerror=()=>{this.l=null},this.i(this.l,this.g))}i(t,e){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=n=>{var r=new Blob([i.response]);t.src=window.URL.createObjectURL(r)},i.addEventListener("progress",n=>{const r=this.j;r&&n.lengthComputable&&(r.downloads[e]?r.downloads[e].loaded=n.loaded:r.downloads[e]={loaded:n.loaded,total:n.total},r.updateProgress())}),i.addEventListener("load",()=>{const n=this.j;n&&(delete n.downloads[e],n.updateProgress())}),i.send()}k(){return this.f}b(){this.c=null}d(){this.e=this.l.width,this.h=this.l.height,this.c=this.j.renderer.i(this.l),this.f=!0,this.l=null}},Yh={147259:!0},Co=[1,1,1,1,1,1,1,2,1,1,1,1,1,1,0,1,0,0,1,1,1,1,1,1,0,0,1,0,1,0,0,0,2,1,1,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1],Ea={2:{GeosetType:15,Original:2,Override:11},3:{GeosetType:15,Original:3,Override:12},4:{GeosetType:15,Original:4,Override:13},5:{GeosetType:15,Original:5,Override:14},6:{GeosetType:15,Original:6,Override:15},7:{GeosetType:15,Original:7,Override:16},8:{GeosetType:15,Original:8,Override:17},9:{GeosetType:15,Original:9,Override:18},10:{GeosetType:15,Original:10,Override:19},11:{GeosetType:12,Original:2,Override:0},12:{GeosetType:12,Original:3,Override:0},13:{GeosetType:12,Original:1,Override:5},14:{GeosetType:12,Original:2,Override:3},15:{GeosetType:12,Original:2,Override:2},16:{GeosetType:22,Original:2,Override:1},17:{GeosetType:22,Original:1,Override:2},18:{GeosetType:22,Original:1,Override:3},19:{GeosetType:22,Original:2,Override:3},20:{GeosetType:12,Original:1,Override:1},21:{GeosetType:12,Original:1,Override:9},22:{GeosetType:12,Original:2,Override:10},23:{GeosetType:12,Original:2,Override:6},24:{GeosetType:12,Original:1,Override:5},25:{GeosetType:27,Original:0,Override:1},26:{GeosetType:27,Original:0,Override:1},27:{GeosetType:27,Original:0,Override:1},28:{GeosetType:13,Original:1,Override:0},31:{GeosetType:12,Original:1,Override:13},32:{GeosetType:12,Original:2,Override:14},33:{GeosetType:42,Original:11,Override:1},38:{GeosetType:20,Original:1,Override:9}},jt={ITEM:1,HELM:2,SHOULDER:4,NPC:8,CHARACTER:16,HUMANOIDNPC:32,OBJECT:64,ARMOR:128,PATH:256,ITEMVISUAL:512,COLLECTION:1024},Ca=[0,1,0,3,4,5,6,7,8,9,10,0,0,21,22,22,16,21,0,19,5,21,22,22,0,21,21,27],Zh=[0,16,0,15,1,7,10,5,6,6,8,0,0,17,18,19,14,20,0,9,7,21,22,23,0,24,25,0],$h=[0,0,0,0,0,0,0,0,0,0,0,0,0,22,0,0,0,22,0,0,0,0,0,0,0,0,0,0],Sa=[0,2,0,4,128,128,128,128,128,128,128,0,0,1,1,1,128,1,0,128,128,1,1,1,0,1,1,2],Jh=[13,14,15,16,17,88,89],Kh=[8,9,10,11,12,86,87],Qh={86:[4,0,4,1,4,0,4,1],85:[84,0,84,1,84,0,84,1],84:[3,0,3,1,3,0,3,1],77:[5,1,0,-1,5,0,0,-1],76:[10,0,1,1,10,0,1,1],75:[10,0,1,1,10,0,1,1],74:[5,1,0,-1,5,0,0,-1],73:[5,1,0,-1,5,0,0,-1],72:[5,1,0,-1,5,0,0,-1],71:[5,1,0,-1,5,0,0,-1],37:[7,0,7,1,7,0,7,1],36:[2,0,2,1,2,0,2,1],34:[3,0,3,1,3,0,3,1],33:[5,1,0,-1,5,0,0,-1],31:[0,-1,8,1,0,-1,8,1],30:[11,0,11,1,11,0,11,1],29:[10,0,10,1,10,0,10,1],28:[6,0,6,1,6,0,6,1],27:[4,0,4,1,4,0,4,1],26:[24,0,24,1,24,0,24,1],25:[24,0,24,1,24,0,24,1],23:[1,0,1,1,1,0,1,1],15:[5,0,5,1,5,0,5,1],1:[0,-1,0,-1,0,-1,0,3]},Ma={21:26,22:27,15:28,17:26,25:32,13:32,23:33,14:28,26:26},Vn={0:{21:26,22:27},1:{21:26,22:27},2:{21:30,22:31},3:{21:32,22:33},4:{21:26,22:27,15:28},5:{21:26},6:{21:26,22:27},7:{21:26,22:27},8:{21:26,22:27},9:{21:33,22:28}},ks=5300,So=`precision mediump float;\r
\r
uniform float x;\r
uniform float y;\r
uniform float width;\r
uniform float height;\r
\r
attribute vec2 aTextCoord;\r
varying vec2 vTextCoords;\r
void main() {\r
    vTextCoords = aTextCoord;\r
\r
    vec2 pos = vec2(\r
        (x + aTextCoord.x*width)* 2.0 - 1.0,\r
        (y + aTextCoord.y*height)* 2.0 - 1.0\r
    );\r
\r
    gl_Position = vec4(pos.x, pos.y, 0, 1);\r
}`;class ka{constructor(){this.a=null,this.d=null,this.b=null}c(){this.a!=null&&this.a.b(),this.d!=null&&this.d.b(),this.b!=null&&this.b.b()}e(){return!(this.a&&!this.a.k())&&!(this.d&&!this.d.k())&&!(this.b&&!this.b.k())}}class tl{constructor(){this.g=null,this.c=null,this.e=null,this.h={},this.i=new v,this.d=null,this.f=null}}const Mo={uDiffuseTexture:null,uSpecularTexture:null,uEmissiveTexture:null};class el{constructor(e,i,n){this.e=i,this.d=n,this.h=null,this.a=null,this.j=null,this.n=null,this.p=null,this.f=!1,this.o=e,this.p=function(r){let o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),r.bindTexture(r.TEXTURE_2D,null);let l=r.createTexture();r.bindTexture(r.TEXTURE_2D,l),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([0,0,0,255])),r.bindTexture(r.TEXTURE_2D,null);let h=new tl;return h.d=o,h.f=l,h.g=Ai(r,[So,`precision mediump float;\r
\r
varying vec2 vTextCoords;\r
uniform sampler2D uDiffuseTexture;\r
uniform sampler2D uSpecularTexture;\r
uniform sampler2D uEmissiveTexture;\r
uniform sampler2D renderResultTexture;\r
uniform int uBlendMode;\r
uniform vec2 screenResolution;\r
uniform int layer;\r
\r
uniform float diffuseTexWidth;\r
uniform float diffuseTexHeight;\r
\r
float overlayBlend(float a, float b) {\r
    if (b > 0.5) {\r
        return (1.0 - (1.0 - 2.0 * (a - 0.5)) * (1.0 - b));\r
    } else {\r
        return ((2.0 * a) * b);\r
    }\r
}\r
\r
float alphaStraightBlend(float a, float b, float alpha) {\r
    return (a * alpha) + (b * (1.0 - alpha));\r
}\r
\r
void main() {\r
    vec2 l_texCoord = vTextCoords.xy;\r
\r
\r
    l_texCoord.x = max(min(l_texCoord.x, (diffuseTexWidth-0.5)/diffuseTexWidth), 0.5/diffuseTexWidth);\r
    l_texCoord.y = max(min(l_texCoord.y, (diffuseTexHeight-0.5)/diffuseTexHeight), 0.5/diffuseTexHeight);\r
\r
    vec4 diffuse = texture2D( uDiffuseTexture, l_texCoord );\r
    vec4 backGround = texture2D( renderResultTexture, gl_FragCoord.xy / screenResolution );\r
\r
    if (uBlendMode == 1) {\r
        // Blit (we do nothing?)\r
        //if (diffuse.a < 0.001) discard;\r
\r
        //vec4 finalColor = diffuse;\r
\r
        //diffuse = vec4(finalColor.rgb, finalColor.a);\r
    } else if (uBlendMode == 2) {\r
        // Multiply\r
        if (diffuse.a < 0.001) discard;\r
\r
        vec4 multTexture = diffuse;\r
        vec3 finalColor = (backGround.rgb * multTexture.rgb);\r
\r
        diffuse = vec4(finalColor.rgb, 1.0);\r
    } else if (uBlendMode == 3) {\r
        // Overlay\r
        if (diffuse.a < 0.001) discard;\r
\r
        vec4 overlayTex = diffuse;\r
\r
        vec3 finalColor = vec3(\r
            overlayBlend(overlayTex.r, backGround.r),\r
            overlayBlend(overlayTex.g, backGround.g),\r
            overlayBlend(overlayTex.b, backGround.b)\r
        );\r
\r
        vec3 mainTexVisible = backGround.rgb * (1.0 - overlayTex.a);\r
        vec3 overlayTexVisible = finalColor.rgb * (overlayTex.a);\r
        finalColor = (mainTexVisible + overlayTexVisible);\r
\r
        diffuse = vec4(finalColor, backGround.a);\r
    } else if (uBlendMode == 5) {\r
        // AlphaStraight\r
        vec4 overlayTex = diffuse;\r
\r
        //float alphaMult = 1.0;\r
        //vec3 finalColor = vec3(\r
        //    alphaStraightBlend(overlayTex.r, backGround.r, alphaMult*overlayTex.a),\r
        //    alphaStraightBlend(overlayTex.g, backGround.g, alphaMult*overlayTex.a),\r
        //    alphaStraightBlend(overlayTex.b, backGround.b, alphaMult*overlayTex.a)\r
        //);\r
        vec3 finalColor = overlayTex.rgb * overlayTex.a + backGround.rgb * (1.0 - overlayTex.a);\r
\r
        diffuse = vec4(finalColor.rgb, 1.0);\r
    } else if (uBlendMode == 0 || uBlendMode == 4 || uBlendMode == 6 || uBlendMode == 7) {\r
        // default, Screen, InferAlphaBlend, Unknown1\r
        if (diffuse.a < 0.001) discard;\r
\r
        vec3 finalColor = mix(backGround.rgb, diffuse.rgb, diffuse.a);\r
\r
        diffuse = vec4(finalColor.rgb, 1.0);\r
    }\r
\r
    gl_FragColor = diffuse;\r
}`],null,null),h.c=Ai(r,[So,`precision mediump float;\r
\r
varying vec2 vTextCoords;\r
uniform sampler2D uDiffuseTexture;\r
uniform sampler2D uSpecularTexture;\r
uniform sampler2D uEmissiveTexture;\r
uniform sampler2D renderResultTexture;\r
uniform int uBlendMode;\r
\r
void main() {\r
    vec4 diffuse = texture2D( uDiffuseTexture, vTextCoords.xy );\r
    vec4 specular = texture2D( uSpecularTexture, vTextCoords.xy );\r
    if (diffuse.a < 0.001) discard;\r
    gl_FragColor = vec4(specular.rgb, 1.0);\r
}`],null,null),h.e=Ai(r,[So,`precision mediump float;\r
\r
varying vec2 vTextCoords;\r
uniform sampler2D uDiffuseTexture;\r
uniform sampler2D uSpecularTexture;\r
uniform sampler2D uEmissiveTexture;\r
uniform sampler2D renderResultTexture;\r
uniform int uBlendMode;\r
uniform vec2 screenResolution;\r
uniform float emissiveAlphaOverride;\r
uniform int layer;\r
\r
void main() {\r
    vec4 diffuse = texture2D( uDiffuseTexture, vTextCoords.xy );\r
    vec4 emissive = texture2D( uEmissiveTexture, vTextCoords.xy );\r
    vec4 backGround = texture2D( renderResultTexture, gl_FragCoord.xy / screenResolution );\r
\r
    if (diffuse.a < 0.001) discard;\r
//    if (emissive.a < 0.001) discard;\r
\r
    //TODO: This is a hack from what was observed in Nightborne texture customization with tatoos.\r
    //TODO: But Maybe switch should be over layer or something else instead of blend\r
    float alpha = 1.0;\r
\r
    if (emissiveAlphaOverride > -1.0) {\r
        alpha = emissiveAlphaOverride;\r
    } else if (layer <= 1) {\r
        alpha = 0.0;\r
    } else {\r
        alpha = emissive.a;\r
    }\r
\r
    gl_FragColor = vec4(emissive.rgb, alpha);\r
}`],null,null),h.h={},h.j=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,h.j),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),h.a=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,h.a),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Int16Array([0,1,2,1,3,2]),r.STATIC_DRAW),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),h.k=r.createFramebuffer(),h.b={loc:r.getAttribLocation(h.g.program,"aTextCoord"),type:r.FLOAT,size:2,offset:0,stride:0},h}(e)}b(){let e=this.o;this.n||(this.n=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.e,this.d,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),this.h||(this.h=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.h),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.e,this.d,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),this.a||(this.a=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.a),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.e,this.d,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),this.j||(this.j=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.j),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.e,this.d,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null)),e.bindFramebuffer(e.FRAMEBUFFER,this.p.k),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.h,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.a,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.j,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.useProgram(this.p.c.program),e.bindBuffer(e.ARRAY_BUFFER,this.p.j),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.p.a),this.p.i.disableAll(),this.p.i.enable(e,[this.p.b]),e.viewport(0,0,this.e,this.d)}m(e,i,n,r,o,l,h,d){let u=this.o;this.p.h.x=i,this.p.h.y=n,this.p.h.width=r,this.p.h.height=o,this.p.h.diffuseTexWidth=e.a.e,this.p.h.diffuseTexHeight=e.a.h,e.d==null&&e.b==null||(this.f=!0);let g=0;l==1?g=1:l==4?g=2:l==6?g=3:l==7?g=4:l==9?g=5:l==15?g=6:l==16&&(g=7),this.p.h.uBlendMode=g,this.p.h.screenResolution=new Float32Array([this.e,this.d]),this.p.h.uDiffuseTexture=e.a!=null?e.a.c:this.p.d,this.p.h.uSpecularTexture=e.d!=null?e.d.c:this.p.d,this.p.h.uEmissiveTexture=e.b!=null?e.b.c:this.p.f,this.p.h.renderResultTexture=this.n!=null?this.n:this.p.d,this.p.h.layer=h,this.p.h.emissiveAlphaOverride=d,u.disable(u.CULL_FACE),u.disable(u.DEPTH_TEST),u.disable(u.BLEND),u.useProgram(this.p.g.program),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,this.h,0),u.bindTexture(u.TEXTURE_2D,this.n),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,this.e,this.d,0),u.bindTexture(u.TEXTURE_2D,null),Ze(this.p.g,this.p.h),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),Ze(this.p.g,Mo),u.useProgram(this.p.c.program),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,this.a,0),u.bindTexture(u.TEXTURE_2D,this.n),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,this.e,this.d,0),u.bindTexture(u.TEXTURE_2D,null),Ze(this.p.c,this.p.h),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),Ze(this.p.c,Mo),u.useProgram(this.p.e.program),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,this.j,0),u.bindTexture(u.TEXTURE_2D,this.n),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,this.e,this.d,0),u.bindTexture(u.TEXTURE_2D,null),Ze(this.p.e,this.p.h),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),Ze(this.p.e,Mo),u.useProgram(null)}l(){let e=this.o;e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST)}i(e){if(e==0)return this.h;if(e==1)return this.a;if(e==2)return this.j;throw new Error("unknown usage "+e)}g(e){let i=null;return i={c:e,e:this.e,h:this.d,f:!0},i}c(){let e=this.o;this.n&&e.deleteTexture(this.n),this.h&&e.deleteTexture(this.h),this.a&&e.deleteTexture(this.a),this.j&&e.deleteTexture(this.j),this.h=null,this.a=null,this.j=null,this.n=null,this.p=null,this.o=null}k(e){switch(e){case 0:return this.g(this.h);case 1:return this.g(this.a);case 2:return this.g(this.j);default:return null}}}function Ae(){var t=new O(2);return O!=Float32Array&&(t[0]=0,t[1]=0),t}function Yi(t,e){var i=new O(2);return i[0]=t,i[1]=e,i}function Ds(t,e,i){return t[0]=e,t[1]=i,t}function il(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function Fs(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}(function(){var t=Ae()})();function bn(){var t=new O(9);return O!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Is(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function nl(t,e,i){var n=e[0],r=e[1],o=e[2],l=e[3],h=e[4],d=e[5],u=e[6],g=e[7],b=e[8],_=i[0],y=i[1],I=i[2],S=i[3],k=i[4],U=i[5],G=i[6],F=i[7],P=i[8];return t[0]=_*n+y*l+I*u,t[1]=_*r+y*h+I*g,t[2]=_*o+y*d+I*b,t[3]=S*n+k*l+U*u,t[4]=S*r+k*h+U*g,t[5]=S*o+k*d+U*b,t[6]=G*n+F*l+P*u,t[7]=G*r+F*h+P*g,t[8]=G*o+F*d+P*b,t}function ki(){var t=new O(4);return O!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function rl(t,e,i){i*=.5;var n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t}function sl(t,e,i,n){var r,o,l,h,d,u=e[0],g=e[1],b=e[2],_=e[3],y=i[0],I=i[1],S=i[2],k=i[3];return(o=u*y+g*I+b*S+_*k)<0&&(o=-o,y=-y,I=-I,S=-S,k=-k),1-o>A?(r=Math.acos(o),l=Math.sin(r),h=Math.sin((1-n)*r)/l,d=Math.sin(n*r)/l):(h=1-n,d=n),t[0]=h*u+d*y,t[1]=h*g+d*I,t[2]=h*b+d*S,t[3]=h*_+d*k,t}var ol,al,hl,ll,ul,cl,dl=Jt,Da=pe,fl=Ke;ol=M(),al=E(1,0,0),hl=E(0,1,0),ll=ki(),ul=ki(),cl=bn();class Xn{constructor(){this.d=-1,this.a=null,this.e=0,this.b=-1,this.c=!1}}class ko{constructor(){this.f=new Xn,this.e=new Xn,this.d=new Xn,this.b=0,this.c=1,this.a=!1}}class Do{e(){var e=this;if(e.c)for(var i=0;i<e.c.length;++i)e.c[i]=null;return e.j=null,e.c=null,null}i(e,i,n,r){let o=this;if(r==null&&(r=this.k()),this.g>=0&&(e=this.g<i.length?i[this.g]:i[0]),o.a!=0||o.c.length>1){if(o.j.length>1){for(var l=-1,h=o.j.length-1,d=0;d<h;++d)if(e>=o.j[d]&&e<=o.j[d+1]){l=d;break}if(l==-1&&(l=o.j.length-1),o.a==1){var u=o.j[l],g=o.j[l+1],b=0;return e>g?(b=1,console.log("time > t2")):u!=g&&(b=(e-u)/(g-u)),b=Math.max(0,Math.min(1,b)),o.f(o.c[l],o.c[l+1],b,r)}return r=o.l(r,o.c[l])}return o.c.length>0?r=o.l(r,o.c[0]):n}return o.c.length==0?r:r=o.l(r,o.c[0])}h(e){var i,n=this;n.a=e.getInt16(),n.g=e.getInt16(),n.b=e.getBool();var r=e.getInt32();for(n.j=new Array(r),i=0;i<r;++i)n.j[i]=e.getInt32();var o=e.getInt32();for(n.c=new Array(o),i=0;i<o;++i)n.c[i]=n.d(e)}}class Di extends Do{constructor(e){super(),this.ba=M(),this.h(e)}k(){return M()}f(e,i,n,r){return De(r,e,i,n)}l(e,i){return z(e,i),e}d(e){return Y(M(),e.getFloat(),e.getFloat(),e.getFloat())}}class Fa extends Do{constructor(e){super(),this.h(e),this.ba=ki()}k(){return ki()}f(e,i,n,r){return sl(r,e,i,n)}l(e,i){return dl(e,i),e}d(e){let i=e.getFloat(),n=e.getFloat(),r=e.getFloat(),o=e.getFloat();const l=Da(ki(),-i,-n,-r,o);return fl(l,l),l}}class Yn extends Do{constructor(e){super(),this.h(e)}d(e){return e.getUint16()}k(){return 0}f(e,i,n,r){return e+(i-e)*n}l(e,i){return i}}class me extends Yn{d(e){return e.getFloat()}}class Fo extends Yn{d(e){return e.getUint8()}}class Io{f(){for(var e=this,i=0;i<e.h.length;++i)e.h[i]=null;return e.i=null,e.h=null,e.c=null,null}j(e,i,n,r){let o=this;n||(n=this.d());let l=r||o.h;if(o.h.length>1&&o.i.length>1){for(var h=-1,d=o.i.length,u=0;u<d-1;++u)if(e>=o.i[u]&&e<=o.i[u+1]){h=u;break}h==-1&&(h=o.i.length-1);var g=o.i[h],b=o.i[h+1],_=0;return g!=b&&(_=(e-g)/(b-g)),o.b(l[h],l[h+1],_,n)}return l.length>0?n=o.e(n,l[0]):i}g(e){var i,n=this,r=e.getInt32();for(n.i=new Array(r),i=0;i<r;++i)n.i[i]=e.getInt16()/32767;var o=e.getInt32();for(n.h=new Array(o),i=0;i<o;++i)n.h[i]=n.a(e)}}class pl extends Io{constructor(e){super(),this.ba=Ae(),this.g(e)}d(){return Ae()}b(e,i,n,r){return o=r,h=i,d=n,u=(l=e)[0],g=l[1],o[0]=u+d*(h[0]-u),o[1]=g+d*(h[1]-g),o;var o,l,h,d,u,g}e(e,i){var n,r;return r=i,(n=e)[0]=r[0],n[1]=r[1],e}a(e){return Ds(Ae(),e.getFloat(),e.getFloat())}}class gl extends Io{constructor(e){super(),this.g(e)}d(){return M()}b(e,i,n,r){return De(r,e,i,n)}e(e,i){return z(e,i),e}a(e){return Y(M(),e.getFloat(),e.getFloat(),e.getFloat())}}class Os extends Io{constructor(e){super(),this.g(e)}d(){return 0}b(e,i,n,r){return e+(i-e)*n}e(e,i){return e}a(e){return e.getUint16()}}class Ct{constructor(e,i){this.b(e,i)}b(e,i){var n=e.getInt32();this.a=new Array(n);for(let r=0;r<n;++r)this.a[r]=new i(e)}d(e){return!(!this.a||this.a.length==0)&&(e>=this.a.length&&(e=0),this.a[e].b)}c(e,i,n,r){if(!this.a||this.a.length==0)return n;let o=e.e.d;o>=this.a.length&&(o=0);let l=this.a[o].i(e.e.e,i,n,r);if(e.b>0&&e.b<1){let h=this.a[0].k(),d=e.d.d;d>=this.a.length&&(d=0);let u=this.a[d].i(e.d.e,i,n,h);u||(u=h),h=this.a[0].k(),l=u}return l}e(){if(this.a&&this.a.length!=0){for(var e=0;e<this.a.length;++e)this.a[e].e(),this.a[e]=null;return null}}}function Rt(t,e){return mt(t[4*e+0],t[4*e+1],t[4*e+2],0)}function Dt(t,e,i){for(let n=0;n<4;n++)t[4*e+n]=i[n]}const ml=class{constructor(t,e,i){this.m=t,this.i=i,this.z=null,this.n=null,this.a=null,this.k=rt(),this.f=rt(),this.d=rt();const n=this;n.p=e,n.c=M(),n.q=rt(),n.t=rt(),n.h=rt(),n.o=M(),n.A=ki(),n.e=rt(),n.v=!1,n.w=!1,n.l=!1}j(){var t=this;t.c=null,t.q=null,t.o=null,t.A=null,t.e=null}x(){this.v=!0;for(var t=0;t<16;++t)this.q[t]=0}g(t){t?(this.z==null&&(this.z=new ko),this.m.aI(t,this.z)):this.z=null;let e=this.m.F[this.p];for(let i=0;i<e.length;i++)this.m.aJ[e[i]].g(t)}y(t){t?(this.n==null&&(this.n=new ko),this.m.aI(t,this.n)):this.n=null;let e=this.m.F[this.p];for(let i=0;i<e.length;i++)this.m.aJ[e[i]].y(t)}r(t){const e=this.i;var i=this;if(i.v)return void i.x();if(this.z!=null&&this.m.aG(this.z,t),i.w||i.l||(i.w=!0,!i.m))return;$t(i.q);var n=i.m.r;if(!n)return;let r=this.f;if($t(r),st(r,r,this.m.aO.viewMatrix),st(r,r,this.m.O),st(i.q,i.q,r),e.a>-1){i.m.aJ[e.a].r(t);let g=this.d;if(Ot(g,i.m.aJ[e.a].q),st(g,r,g),1&e.i||2&e.i||4&e.i){if(4&e.i&&2&e.i)Dt(g,0,Rt(r,0)),Dt(g,1,Rt(r,1)),Dt(g,2,Rt(r,2));else if(4&e.i){{let _=Rt(r,0),y=Kt(_);Ft(_,_,Kt(Rt(g,0))/y),Dt(g,0,_)}{let _=Rt(r,1),y=Kt(_);Ft(_,_,Kt(Rt(g,1))/y),Dt(g,1,_)}{let _=Rt(r,2),y=Kt(_);Ft(_,_,Kt(Rt(g,2))/y),Dt(g,2,_)}}else if(2&e.i){{let _=Rt(r,0);Ft(_,_,1/Kt(Rt(g,0))),Ft(_,_,Kt(Rt(r,0))),Dt(g,0,_)}{let _=Rt(r,1);Ft(_,_,1/Kt(Rt(g,1))),Ft(_,_,Kt(Rt(r,1))),Dt(g,1,_)}{let _=Rt(r,2);Ft(_,_,1/Kt(Rt(g,2))),Ft(_,_,Kt(Rt(r,2))),Dt(g,2,_)}}if(1&e.i)Dt(g,3,Rt(r,3));else{let _=mt(e.e[0],e.e[1],e.e[2],1),y=yt();Jt(y,_),y[3]=0;let I=yt(),S=yt();ae(I,_,i.m.aJ[i.i.a].q),ae(I,I,r),ae(S,y,g),Je(I,I,S),I[3]=1,Dt(g,3,I)}}let b=this.k;it(b,r),st(g,b,g),st(i.q,i.q,g)}let o=null;if(this.z!=null){let g=this.s(this.z);this.m.u||(this.b=g),this.m.y||(o=this.m.u?this.b:g)}else{let g=this.s(n);this.m.u||(this.b=g),this.m.y||(o=this.m.u?this.b:g)}let l=null;if(this.n!=null){let g=this.s(this.n);this.m.u||(this.u=g),l=this.m.u?this.u:g}let h=o!=null||l!=null,d=rt();h&&(o!=null&&st(d,d,o),l!=null&&st(d,d,l)),this.a!=null&&(xt(d,d,this.i.e),st(d,d,this.a),xt(d,d,Tt(this.o,this.i.e))),st(i.q,i.q,d);let u=120&e.i;if(u){let g=rt();Ot(g,i.q);let b=i.q,_=M();Hn(_,i.q);let y=yt();if(u==16){let P=Rt(i.q,0);Ft(P,P,1/L(P)),Dt(i.q,0,P);let T=mt(b[4],-b[0],0,0);Dt(b,1,Ke(T,T)),Ln(y,T,P),y[3]=0,Dt(b,2,y)}else if(u>16){if(u==32){let P=Rt(b,1);Ft(P,P,1/Kt(P)),Dt(i.q,1,P);let T=mt(-b[5],b[1],0,0);Dt(b,0,Ke(T,T)),y[3]=0,Dt(b,2,y)}else if(u==64){let P=Rt(b,2);Ke(P,P),Dt(b,2,P);let T=mt(P[1],-P[0],0,0);Ke(T,T),Dt(b,1,T),Ln(y,P,T),y[3]=0,Dt(b,0,y)}}else if(u==8){let P=this.m.isMirrored;if(h){let T=Rt(d,0);T=mt(T[1],T[2],-T[0],0),Ke(T,T),Dt(b,0,T);let C=Rt(d,1);C=mt(P?-C[1]:C[1],P?-C[2]:C[2],P?C[0]:-C[0],0),Ke(C,C),Dt(b,1,C);let N=Rt(d,2);N=mt(N[1],N[2],-N[0],0),Ke(N,N),Dt(b,2,N)}else Dt(b,0,mt(0,0,-1,0)),Dt(b,1,mt(P?-1:1,0,0,0)),Dt(b,2,mt(0,1,0,0))}let I=mt(this.i.e[0],this.i.e[1],this.i.e[2],1),S=mt(this.i.e[0],this.i.e[1],this.i.e[2],0),k=Rt(b,0),U=Rt(b,1),G=Rt(b,2);Ft(k,k,_[0]),Ft(U,U,_[1]),Ft(G,G,_[2]),Dt(b,0,k),Dt(b,1,U),Dt(b,2,G),ae(I,I,g),ae(S,S,b);let F=yt();Je(F,I,S),F[3]=1,Dt(b,3,F)}it(r,r),st(i.q,r,i.q),it(i.t,i.q),oe(i.h,i.t),Fe(i.c,i.i.e,i.q)}s(t){const e=this.i;var i=e.d.d(t.e.d),n=e.b.d(t.e.d),r=e.h.d(t.e.d);if((640&e.i)!=0){let N=rt();return $t(N),xt(N,N,this.i.e),i&&(this.o=e.d.c(t,this.m.C),xt(N,N,this.o)),n&&(this.A=e.b.c(t,this.m.C,ki()),o=this.e,l=this.A,h=l[0],d=l[1],u=l[2],g=l[3],I=h*(b=h+h),S=d*b,k=d*(_=d+d),U=u*b,G=u*_,F=u*(y=u+u),P=g*b,T=g*_,C=g*y,o[0]=1-k-F,o[1]=S+C,o[2]=U-T,o[3]=0,o[4]=S-C,o[5]=1-I-F,o[6]=G+P,o[7]=0,o[8]=U+T,o[9]=G-P,o[10]=1-I-k,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,st(N,N,this.e)),r&&(this.o=e.h.c(t,this.m.C),At(N,N,this.o)),xt(N,N,Tt(this.o,this.i.e)),N}var o,l,h,d,u,g,b,_,y,I,S,k,U,G,F,P,T,C;return null}},Oo=class{constructor(t){this.b=t,this.d=267320826^t;let e=new ArrayBuffer(4);this.c=new DataView(e)}e(){let t=this.d;return t^=t<<13,t^=t>>17,t^=t<<5,this.d=t,t}f(){let t,e=this.e();return this.c.setInt32(0,1065353216|8388607&e),t=2147483648&e?2-this.c.getFloat32(0):this.c.getFloat32(0)-2,t}a(){let t=this.e();return this.c.setInt32(0,1065353216|8388607&t),this.c.getFloat32(0)-1}},bl=class{constructor(){this.a=0,this.h=0,this.f=0,this.e=0,this.i=M(),this.j=0,this.g=0,this.c=0,this.d=0,this.b=0}},Ia=class{constructor(t,e){this.c=t,this.d=e,this.i=new bl}f(){return this.i.e+this.c.f()*this.d.J}e(){return this.i.e+this.d.J}a(){return this.i.f+this.d.N}h(t){return this.i.f+30518509e-12*t*this.d.N}g(){let t=this.i.a;return t*=1+this.i.h*this.c.f(),t}k(){return this.i}b(t){z(t,this.i.i)}},vl=class extends Ia{j(t,e){let i,n=e*this.c.a(),r=this.c.f();i=r<1?r>-1?Math.trunc(32767*r+.5):-32767:32767,t.a=i;let o=this.h(i);o<.001&&(o=.001),t.c=function(d,u){let g=Math.abs(d),b=Math.abs(u);return Number((g-Math.floor(g/b)*b).toPrecision(8))*Math.sign(d)}(n,o),t.e=65535&this.c.e(),Y(t.d,this.c.f()*this.i.g*.5,this.c.f()*this.i.c*.5,0);let l=this.g(),h=this.i.j;if(h<.001){let d=this.i.d*this.c.f(),u=this.i.b*this.c.f(),g=Math.sin(d),b=Math.sin(u),_=Math.cos(d),y=Math.cos(u);Y(t.f,y*g*l,b*g*l,_*l)}else{let d=M();z(d,t.d),d[2]=d[2]-h,L(d)>1e-4&&(Mt(d,d),gt(t.f,d,l))}}},_l=class extends Ia{constructor(t,e,i){super(t,e),this.ba=i}j(t,e){let i,n=e*this.c.a(),r=this.c.f();i=r<1?r>-1?Math.trunc(32767*r+.5):-32767:32767,t.a=i;let o=this.h(i);o<.001&&(o=.001),t.c=function(S,k){let U=Math.abs(S),G=Math.abs(k);return Number((U-Math.floor(U/G)*G).toPrecision(8))*Math.sign(S)}(n,o),t.e=65535&this.c.e();let l=this.i.c-this.i.g,h=this.i.g+l*this.c.a(),d=this.i.d*this.c.f(),u=this.i.b*this.c.f(),g=Math.cos(d),b=E(g*Math.cos(u),g*Math.sin(u),Math.sin(d));gt(t.d,b,h);let _=this.g(),y=this.i.j,I=E(.5,.5,.5);y==0?this.ba?Y(I,0,0,1):Y(I,g*Math.cos(u),g*Math.sin(u),Math.sin(d)):(Y(I,0,0,y),nt(I,t.d,I),L(I)>1e-4&&Mt(I,I)),gt(t.f,I,_)}},xl=class{constructor(){this.d=M(),this.c=0,this.f=M(),this.a=0,this.e=2147483647*Math.random()>>0,this.g=[Ae(),Ae()],this.b=[Ae(),Ae()]}},Ro=class{constructor(t,e,i,n,r,o){this.b=t,this.d=e,this.a=i,this.f=n,this.e=r,this.c=o}},Uo=class{constructor(t,e,i){this.b=t,this.c=e,this.a=i}};let Po=new Array(128);for(let t=0;t<128;t++)Po[t]=Math.random();const yl=se(0,1,0,0,-1,0,0,0,0,0,1,0,0,0,0,1),Oa=1e3;class Tl{}class wl{constructor(){this.b=M(),this.c=0,this.a={b:Ae(),d:M(),f:0,a:0,e:1,c:0}}}function Bo(t){return mt((t>>16&255)/255,(t>>8&255)/255,(t>>0&255)/255,(t>>24&255)/255)}const Al=[0,0,1,2,3,4],El=class{constructor(t,e){this.ah=t,this.aj=e,this.Q=null,this.af=0,this.ap=!0,this.C=null,this.S=new Date().getTime(),this.p=e,this.L=rt(),this.G=rt(),this.T=rt(),this.an=rt(),this.g=yt(),this.d=bn(),this.ai=M(),this.I=1,this.O=M(),this.au=0,this.l=M(),this.w=M(),this.X=[],this.ad=M(),this.Z=0,this.e=0,this.ag=0,this.r=0,this.K=M(),this.N=M(),this.am=0,this.n=0,this.ao=0,this.Y=0,this.o=0,this.h=0,this.M=0,this.b=[],this.R=[];for(let g=0;g<Oa;g++)this.R.push(4*g+0),this.R.push(4*g+1),this.R.push(4*g+2),this.R.push(4*g+3),this.R.push(4*g+2),this.R.push(4*g+1);switch(this.y=new Oo(2147483647*Math.random()>>0),this.p.r){case 1:this.F=new vl(this.y,e);break;case 2:this.F=new _l(this.y,e,(256&this.p.e)!=0);break;default:this.F=null,WH.debug("Found unimplemented generator ",this.p.r)}const i=this.p.Z-this.p.T;i!=0?(this.e=(this.p.aa-this.p.u)/i,this.ag=this.p.u-this.p.T*this.e):(this.e=0,this.ag=0);let n=this.p.x;n<=0&&(n=1);let r=this.p.c;r<=0&&(r=1),this.n=n*r-1,this.ao=0;let o=n,l=-1;do++l,o>>=1;while(o);if(this.Y=l,this.o=n-1,this.ao=0,(32768&this.p.e)>0){let g=(this.n+1)*this.y.e();this.ao=g/4294967296|0}this.h=1/n,this.M=1/r;let h=!1;(269484032&this.p.e)>0?(h=(1&this.p.e>>28)!=0,this.Z=h?2:3):this.Z=0;let d=!1,u=!1;(268435456&this.p.e)>0?u=(1073741824&this.p.e)>0:(1048576&this.p.e)==0&&(d=(1&this.p.e)==0),this.Z==2||this.Z==4&&h?this.ac=u?3:2:this.Z==3?this.ac=5:this.ac=d?1:0,this.P=e.q>1,this.al=this.ah.H.c(224e3),this.m=this.ah.H.b(8e3),this.J=this.ah.H.j(this.al,this.m)}aq(){var t=this;t.p.k=null,t.p.Q=null,t.p.O=null,t.p.P=t.p.P.e(),t.p.p=t.p.p.e(),t.p.H=t.p.H.e(),t.p.K=t.p.K.e(),t.p.i=t.p.i.e(),t.p.a=t.p.a.e(),t.p.o=t.p.o.e(),t.p.R=t.p.R.e(),t.p.W=t.p.W.e(),t.p.F=t.p.F.e(),t.p.Y=t.p.Y.e(),t.p.w=t.p.w.f(),t.p.M=t.p.M.f(),t.p.A=t.p.A.f(),t.p.z=t.p.z.f(),t.p.g=t.p.g.f(),t.X=null}v(t){const e=this.aj;e.b>=11&&e.b<=13&&t&&(this.at=[yt(),yt(),yt()],Jt(this.at[0],Bo(t.Start[e.b-11])),Jt(this.at[1],Bo(t.Mid[e.b-11])),Jt(this.at[2],Bo(t.End[e.b-11])))}z(t){this.Q=t}as(){if(this.C)return;if(this.ah.aO.context,!this.ae)if(this.ae=[null,null,null],(268435456&this.p.e)!=0)for(let h=0;h<this.p.f.length;h++){const d=this.p.f[h];d>-1&&d<this.ah.aD.length&&(this.ae[h]=this.ah.aD[d])}else this.p.C>-1&&this.p.C<this.ah.aD.length&&(this.ae[0]=this.ah.aD[this.p.C]);let t=!0;for(let h of this.ae)t=t&&(!h||h.c&&h.c.f);if(!t)return;const e=this.ah.H;let i=this.p.q;i==4&&(i=3);let n={};n.uViewMatrix=this.ah.aO.viewMatrix,n.uProjMatrix=this.ah.aO.projMatrix,n.uBlendMode=this.p.q,n.uPixelShader=Al[this.ac],n.colorMult=this.Q?this.Q.a:1,n.alphaMult=this.Q?this.Q.c:1;let r=[this.ae[0]&&this.ae[0].c&&this.ae[0].c.f,this.ae[1]&&this.ae[1].c&&this.ae[1].c.f,this.ae[2]&&this.ae[2].c&&this.ae[2].c.f];n.uTexture=this.ae[0].c.c,n.uTexture2=r[1]?this.ae[1].c.c:null,n.uTexture3=r[2]?this.ae[2].c.c:null,n.uHasTexture=r[0]?1:0,n.uHasTexture2=r[1]?1:0,n.uHasTexture3=r[2]?1:0;let o=-1;i==1?o=.501960814:i>1&&(o=1/255),n.uAlphaTreshold=o;const l=e.k(this.ah.I,new Ro(!1,!this.ah.aH,i,!0,!1,15),new j(this.ae.map(h=>h&&h.c),n));this.C=e.n(new Uo(this.J,0,0),l,0,this.p.U)}W(t,e){if(!this.F)return;let i=rt(),n=this.F.k(),r=!0;this.p.Y.d(t.e.d)&&(r=this.p.Y.c(t,this.ah.C)>0),this.s=r;const o=E(0,0,0);r&&(n.a=this.p.P.c(t,this.ah.C,0),n.h=this.p.p.c(t,this.ah.C,0),n.d=this.p.H.c(t,this.ah.C,0),n.b=this.p.K.c(t,this.ah.C,0),this.p.i.c(t,this.ah.C,o,n.i),n.f=this.p.a.c(t,this.ah.C,0),n.e=this.p.o.c(t,this.ah.C,0),n.c=this.p.W.c(t,this.ah.C,0),n.g=this.p.R.c(t,this.ah.C,0),this.Q?n.j=this.Q.b:n.j=this.p.F.c(t,this.ah.C,0)),st(i,i,this.ah.O),st(i,i,this.ah.aJ[this.p.d].q);let l=rt();var h,d;h=l,d=E(this.p.k[0],this.p.k[1],this.p.k[2]),h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=d[0],h[13]=d[1],h[14]=d[2],h[15]=1,st(i,i,l),st(i,i,yl);let u=rt(),g=M();it(u,this.ah.aO.viewMatrix),fe(g,u),this.U(e,i,g,null,this.ah.aO.viewMatrix),this.E(this.ah.aO.viewMatrix),this.al.b(new Float32Array(this.b)),this.m.b(new Uint16Array(this.R)),this.C&&(this.C.g=6*this.af>>0,this.C.e=0)}j(t){this.X.length<=0||(this.C||this.as(),this.C&&(!t&&this.C.f.b()>Wn.GxBlend_AlphaKey||this.ah.H.o().d(this.C)))}V(t,e){if((16&this.p.e)==0)for(let i=0;i<this.X.length;i++){const n=this.X[i];Fe(n.d,n.d,t),ue(n.f,n.f,e)}}U(t,e,i,n,r){if(this.F==null||this.ah.u)return;fe(this.O,this.L);let o=yt();fe(o,e),o[3]=1,ae(o,o,r),this.au=o[2];let l=M();if(fe(l,r),this.ak(e,l,n),t>0){let h=M();if(fe(h,this.L),16384&this.p.e){nt(this.w,h,this.O);let d=this.e*(L(this.w)/t)+this.ag;d>=0&&(d=Math.min(d,1)),gt(this.l,this.w,d)}if(64&this.p.e){this.r+=t;let d=.03;if(this.r>d)if(this.r=0,this.X.length==0){let u=d/this.r,g=M();nt(g,h,this.O);let b=u*this.p.L;Pt(this.K,g,E(b,b,b))}else Y(this.K,0,0,0)}this.x(t)}}ak(t,e,i){if(z(this.N,e),i==null||16&this.p.e)Ot(this.L,t);else{let r=rt();it(r,i),st(this.L,r,t)}let n=M();Hn(n,t),this.I=n[0]}x(t){if((t=Math.max(t,0))<.1)z(this.l,this.w);else{let e=Math.floor(t/.1);t=-.1*e+t;let i=Math.min(Math.floor(this.F.k().f/.1),e),n=i+1,r=1;r=n<0?(1&n|n>>1)+(1&n|n>>1):n,gt(this.l,this.w,1/r);for(let o=0;o<i;o++)this.k(.1)}this.k(t)}k(t){let e=new Tl;if(t<0)return;this.p.e,this.i(e,t),this.a(t);let i=0;for(;i<this.X.length;){let n=this.X[i];n.c=n.c+t,n.c>Math.max(this.F.h(n.e),.001)?(this.t(i),i--):this.aa(n,t,e)||(this.t(i),i--),i++}}i(t,e){t.c=M(),t.b=M(),t.d=M(),t.a=0;let i=E(e,e,e),n=e*e*.5,r=E(n,n,n);Pt(t.c,this.p.n,i);let o=M();this.F.b(o),Pt(t.b,o,i),Pt(t.d,o,r),t.a=this.p.v*e}a(t){if(!this.s&&this.ap)return;let e=this.F.f();for(this.am=this.am+t*e;this.am>1;)this.A(t),this.am-=1}A(t){let e=this.ar();if(this.F.j(e,t),!(16&this.p.e)){let o=mt(e.d[0],e.d[1],e.d[2],1),l=mt(e.f[0],e.f[1],e.f[2],0);ae(o,o,this.L),ae(l,l,this.L),z(e.d,o),z(e.f,l),8192&this.p.e&&(e.d[2]=0)}if(64&this.p.e){let o=1+this.F.k().h*this.y.f(),l=M();gt(l,this.K,o),tt(e.f,e.f,l)}if(this.Z>=2)for(let o=0;o<2;o++){e.g[o][0]=this.y.a(),e.g[o][1]=this.y.a();let l=Ae();Fs(l,this.p.D[o],this.y.f()),i=e.b[o],n=l,r=this.p.V[o],i[0]=n[0]+r[0],i[1]=n[1]+r[1]}var i,n,r}ar(){let t=new xl;return this.X.push(t),t}t(t){this.X.splice(t,1)}aa(t,e,i){if(this.Z>=2)for(let o=0;o<2;o++){let l=t.g[o][0]+e*t.b[o][0];t.g[o][0]=l-Math.floor(l),l=t.g[o][1]+e*t.b[o][1],t.g[o][1]=l-Math.floor(l)}tt(t.f,t.f,i.c),16384&this.p.e&&2*e<t.c&&tt(t.d,t.d,this.l);let n=E(e,e,e),r=M();if(Pt(r,t.f,n),tt(t.f,t.f,i.b),gt(t.f,t.f,1-i.a),tt(t.d,t.d,r),tt(t.d,t.d,i.d),this.p.r==2&&128&this.p.e){let o=M();if(z(o,t.d),16&this.p.e){if(Ei(o,r)>0)return!1}else{let l=M();if(fe(l,this.L),nt(o,t.d,l),Ei(o,r)>0)return!1}}return!0}E(t){if(this.b.length=0,this.X.length==0&&this.F!=null)return;it(this.T,t),Is(bn(),t),this.av(null,t);let e=0;for(let i=0;i<this.X.length;i++){let n=this.X[i],r=new wl;if(this.q(n,r)&&(131072&this.p.e&&(this.B(n,r),e++),262144&this.p.e&&(this.f(n,r),e++)),e>=Oa)break}this.af=e}av(t,e){var i,n,r;16&this.p.e?st(this.an,e,this.L):t!=null?st(this.an,e,t):Ot(this.an,e),fe(this.g,e),4096&this.p.e&&(Is(this.d,this.an),16&this.p.e&&Math.abs(this.I)>0&&(i=this.d,n=this.d,r=1/this.I,i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[3]=n[3]*r,i[4]=n[4]*r,i[5]=n[5]*r,i[6]=n[6]*r,i[7]=n[7]*r,i[8]=n[8]*r),Y(this.ai,this.d[6],this.d[7],this.d[8]),Te(this.ai)<=23841858e-14?Y(this.ai,0,0,1):Mt(this.ai,this.ai))}u(t){let e=0,i=0;if(this.p.I!=0||this.p.G!=0){let n=new Oo(t.e);e=this.p.X==0?this.p.I:this.p.I+n.f()*this.p.X,i=this.p.G==0?this.p.t:this.p.t+n.f()*this.p.G}else e=this.p.I,i=this.p.t;return{deltaSpin:i,baseSpin:e}}q(t,e){let i=this.p.B,n=this.p.l,r=n[0],o=n[1]-r,l=0,h=t.e,d=t.c;if((i<1||o!=0)&&(l=127&d*this.p.m+h),i<Po[l])return 0;this.c(t,e,h);let u=o*Po[l]+r;Fs(e.a.b,e.a.b,u),32&this.p.e&&Fs(e.a.b,e.a.b,this.I);let g=mt(t.d[0],t.d[1],t.d[2],1);return ae(g,g,this.an),z(e.b,g),e.c=1,1}c(t,e,i){let n=t.c/this.F.a(),r=new Oo(i);Math.min(n,1)<=0?n=0:n>=1&&(n=1);let o=E(255,255,255),l=Yi(1,1),h=1,d=e.a;this.p.w.j(n,o,d.d,this.at),this.at||gt(d.d,d.d,1/255),this.p.A.j(n,l,d.b),d.e=this.p.M.j(n,32767)/32767,this.Q?d.c=this.Q.d.j(n,0)/32767:d.c=0;let u=0;this.p.z.i.length>0?(h=0,d.f=this.p.z.j(n,h),d.f=this.n&d.f+this.ao):65536&this.p.e?(u=(this.n+1)*r.e(),d.f=u/4294967296|0):d.f=0,h=0,d.a=this.p.g.j(n,h),d.a=d.a+this.ao&this.n;let g=1;524288&this.p.e?(g=Math.max(1+r.f()*this.p.y[1],99999997e-12),d.b[0]=Math.max(1+r.f()*this.p.y[0],99999997e-12)*d.b[0]):(g=Math.max(1+r.f()*this.p.y[0],99999997e-12),d.b[0]=g*d.b[0]),d.b[1]=g*d.b[1]}B(t,e){let i=Yi((e.a.f&this.o)*this.h,(e.a.f>>this.Y)*this.M),n=0,r=0,o=this.u(t);n=o.baseSpin,r=o.deltaSpin;let l=0,h=E(0,0,0),d=E(0,0,0),u=!1,g=!1;if(4&this.p.e&&Te(t.f)>23841858e-14)if(l=1,4096&this.p.e)u=!0;else{let y=mt(-t.f[0],-t.f[1],-t.f[2],0);ae(y,y,this.an);let I=M();z(I,y);let S=0,k=Te(I);S=k<=23841858e-14?0:1/Math.sqrt(k);let U=M();z(U,I),gt(U,U,S),z(h,U),gt(h,h,e.a.b[0]),d=E(U[1],-U[0],0),gt(d,d,e.a.b[1]),g=!0,u=!1}if((4096&this.p.e||u)&&!g){let y=bn();b=y,_=this.d,b[0]=_[0],b[1]=_[1],b[2]=_[2],b[3]=_[3],b[4]=_[4],b[5]=_[5],b[6]=_[6],b[7]=_[7],b[8]=_[8];let I=e.a.b[0];if(l){let S=0,k=E(-t.f[0],-t.f[1],-t.f[2]),U=Te(k);S=U<=23841858e-14?0:1/Math.sqrt(U),nl(y,this.d,function(G,F,P,T,C,N,V,W,J){var at=new O(9);return at[0]=G,at[1]=F,at[2]=P,at[3]=T,at[4]=C,at[5]=N,at[6]=V,at[7]=W,at[8]=J,at}(k[0]*S,k[1]*S,0,-k[1]*S,k[0]*S,0,0,0,1)),S>23841858e-14&&(I=e.a.b[0]*(1/Math.sqrt(Te(t.f))/S))}if(this.Z,Y(h,y[0],y[1],y[2]),gt(h,h,I),Y(d,y[3],y[4],y[5]),gt(d,d,e.a.b[1]),r=d[0],g=!0,this.p.t!=0||this.p.G!=0){let S=n+r*t.c;512&this.p.e&&1&t.e&&(S=-S);let k=M();z(k,this.ai),this.Z;let U=bn(),G=ki();rl(G,k,S),function(F,P){var T=P[0],C=P[1],N=P[2],V=P[3],W=T+T,J=C+C,at=N+N,St=T*W,Ut=C*W,vt=C*J,ee=N*W,le=N*J,be=N*at,ve=V*W,_e=V*J,xe=V*at;F[0]=1-vt-be,F[3]=Ut-xe,F[6]=ee+_e,F[1]=Ut+xe,F[4]=1-St-be,F[7]=le-ve,F[2]=ee-_e,F[5]=le+ve,F[8]=1-St-vt}(U,G),ue(h,h,U),Y(d,r,d[1],d[2]),ue(d,d,U)}}var b,_;if(!g)if(this.p.t!=0||this.p.G!=0){let y=n+r*t.c;512&this.p.e&&1&t.e&&(y=-y);let I=Math.cos(y),S=Math.sin(y);Y(h,I,S,0),gt(h,h,e.a.b[0]),Y(d,-S,I,0),gt(d,d,e.a.b[1]),134217728&this.p.e&&tt(e.b,e.b,E(d[0],d[1],0))}else Y(h,e.a.b[0],0,0),Y(d,0,e.a.b[1],0);return this.H(h,d,e.b,e.a.d,e.a.e,e.a.c,i[0],i[1],t.g),0}f(t,e){let i=Yi((e.a.a&this.o)*this.h,(e.a.a>>this.Y)*this.M),n=E(0,0,0),r=E(0,0,0),o=this.p.j;1024&this.p.e&&(o=Math.min(t.c,o));let l=yt();gt(l,t.f,-1),l[3]=0,ae(l,l,this.an),gt(l,l,o);let h=E(l[0],l[1],0);if(Ei(h,h)>1e-4){let d=1/L(h);Fs(e.a.b,e.a.b,d),il(h,h,e.a.b),r=E(-h[1],h[0],0),gt(n,l,.5),tt(e.b,e.b,n)}else n=E(.05*e.a.b[0],0,0),r=E(0,.05*e.a.b[1],0);return this.H(n,r,e.b,e.a.d,e.a.e,e.a.c,i[0],i[1],t.g),1}H(t,e,i,n,r,o,l,h,d){const u=[-1,-1,1,1],g=[1,-1,1,-1],b=[0,0,1,1],_=[0,1,0,1];let y=M(),I=Ae(),S=Ae(),k=Ae();for(let U=0;U<4;U++)Y(y,0,0,0),bt(y,y,t,u[U]),bt(y,y,e,g[U]),tt(y,y,i),Ds(I,b[U]*this.h+l,_[U]*this.M+h),Ds(S,b[U]*this.p.s[0]+d[0][0],_[U]*this.p.s[0]+d[0][1]),Ds(k,b[U]*this.p.s[1]+d[1][0],_[U]*this.p.s[1]+d[1][1]),this.b.push(y[0]),this.b.push(y[1]),this.b.push(y[2]),this.b.push(n[0]),this.b.push(n[1]),this.b.push(n[2]),this.b.push(r),this.b.push(I[0]),this.b.push(I[1]),this.b.push(S[0]),this.b.push(S[1]),this.b.push(k[0]),this.b.push(k[1]),this.b.push(o)}};class Cl{constructor(){this.b=M(),this.a=yt(),this.c=Ae()}}class Ra{}const Sl=[0,1,2,10,3,4,5,13];function Rs(t,e){return E(t[4*e+0],t[4*e+1],t[4*e+2])}const Ml=class{constructor(t,e){this.ai=t,this.v=e,this.G=M(),this.af=M(),this.L=new Ra,this.q=M(),this.Y=M(),this.j=M(),this.d=M(),this.M=M(),this.ab=M(),this.r=M(),this.B=M(),this.S=M(),this.A=M(),this.ag=M(),this.ad=M(),this.au=M(),this.a=t.aO.context,this.e=new Array(e.a.length),this.T=new Array(e.a.length);for(let r=0;r<e.a.length;r++)this.T[r]=t.c.I[e.a[r]];let i=mt(255,255,255,255),n=new Ra;n.d=0,n.a=0,n.b=1,n.c=1,this.t(e.i,e.r,i,n,e.j,e.k),this.s(e.d),this.R(!1)}R(t){this.am=t,this.am||(this.c=!1)}s(t){this.y=t}F(){return this.m==this.i}k(t){this.aj=t}H(t){this.l=t}n(t){this.N[3]=Math.max(t,0)}ah(){let t=M();Xi(t,this.G,this.au);let e=Te(t);gt(t,this.q,this.aj),nt(this.r,this.G,t),gt(t,this.Y,this.aj),nt(this.B,this.au,t),gt(t,this.q,this.l),tt(this.S,this.G,t),gt(t,this.Y,this.l),tt(this.A,this.au,t),gt(this.M,this.j,e),gt(this.ab,this.d,e)}U(t,e,i){let n;if(this.P&&this.am){n=t;let r=M();fe(r,n),tt(r,r,e),z(this.af,e),this.c?(z(this.G,this.au),z(this.j,this.d),z(this.q,this.Y)):(z(this.G,r),this.j=Rs(n,2),this.q=Rs(n,1),this.Z=0,this.c=!0),this.au=r,this.d=Rs(n,2),this.Y=Rs(n,1)}}o(t){var e=bn();Is(e,t),this.j=ue(this.j,this.j,e),this.q=ue(this.q,this.q,e),this.d=ue(this.d,this.d,e),this.Y=ue(this.Y,this.Y,e),this.G=Fe(this.G,this.G,t),this.au=Fe(this.au,this.au,t);for(var i=0;i<this.O.length;i++)Fe(this.O[i].b,this.O[i].b,t)}an(t,e,i){this.N[2]=i,this.N[1]=e,this.N[0]=t}Q(t){if(this.al!=t){this.al=t;let e=t%this.b,i=e;(2147483648&e)!=0&&(i=(1&e|e>>1)+(1&e|e>>1));let n=i*this.h+this.ae.a;this.L.a=n;let r=t/this.b,o=r;(2147483648&r)!=0&&(r=1&r|r>>1,o=r+r,n=this.L.a);let l=o*this.aa+this.ae.d;this.L.d=l,this.L.c=n+this.h,this.L.b=l+this.aa}}E(t,e,i){let n,r=this.O[2*this.i],o=this.O[2*this.i+1],l=M();gt(l,this.ab,1-e),nt(l,this.B,l),gt(r.b,l,e),gt(l,this.M,e),tt(l,this.r,l),gt(l,l,1-e),tt(r.b,r.b,l),gt(l,this.ab,1-e),nt(l,this.A,l),gt(o.b,l,e),gt(l,this.M,e),tt(l,this.S,l),gt(l,l,1-e),tt(o.b,o.b,l),this.ac[this.i]=t,n=i,this.i=this.i+n,this.i>=this.ac.length&&(this.i-=this.ac.length)}aq(t,e){if(this.ai.u)return;let i=M(),n=1;i=this.v.n.c(t,this.ai.C,i),n=this.v.m.c(t,this.ai.C),this.an(i[0],i[1],i[2]),this.n(n/32767);let r=this.v.q.c(t,this.ai.C);this.H(r);let o=this.v.e.c(t,this.ai.C);this.k(o);let l=this.v.p.c(t,this.ai.C);this.Q(l);let h=this.v.l.c(t,this.ai.C,1);this.R(h!=0);let d=rt();Ms(d,this.ai.O,this.ai.aJ[this.v.b].q),xt(d,d,this.v.h);let u=M();this.U(d,u,null),this.p(e,!1)}p(t,e){let i,n,r,o,l,h,d,u,g,b,_,y,I,S,k,U,G,F,P,T,C,N,V,W,J,at,St,Ut,vt,ee,le,be,ve,_e,xe,Ge,Wt,ei,bi,vi,Qi,tn,en,nn,Vt,$r,Ri,Ui;for(this.z||this.ao>0&&(t=1/this.ao+99999997e-12),t>=0?this.at<=t&&(t=this.at):t=0,F=this.m;F!=this.i&&!(t+this.ac[F]<=this.at);F=this.m)this.m=this.C(this.m,1);if(!e&&this.P&&this.am&&this.c){le=t*this.ao+this.Z,Ui=this.N,this.ah();let Se=!1;if(_e=0,le<1?Se=!0:(Ri=this.Z,ve=1/(le-Ri),G=Math.floor(le-1),_e=Math.ceil(Math.max(G,0))),!(_e==-1||Se))for(be=1,F=1;ee=this.i,ei=this.O.length,this.O[2*ee].a=Ui,P=2*this.i+1,bi=this.O.length,this.O[P].a=Ui,this.E((F-Ri)*ve*-t,(F-Ri)*ve,1),--_e!=-1;F=be)be+=1,Ri=this.Z;T=Math.floor(le),this.Z=le-T,this.E(0,1,0),vt=this.i,vi=this.O.length,C=this.O[2*vt],N=this.L.a,C.c[1]=this.L.d,C.c[0]=N,V=2*this.i+1,Qi=this.O.length,W=this.O[V],J=this.L.a,W.c[1]=this.L.b,W.c[0]=J,Ut=this.i,tn=this.O.length,this.O[2*Ut].a=Ui,at=2*this.i+1,en=this.O.length,this.O[at].a=Ui}this.ag[2]=34028235e31,this.ag[1]=34028235e31,this.ag[0]=34028235e31,this.ad[2]=-34028235e31,this.ad[1]=-34028235e31,this.ad[0]=-34028235e31,xe=this.m;for(let Se=this.m;Se!=this.i;xe=Se)U=2*Se,$r=this.O.length,St=xe,Wt=this.O[2*Se],i=U+1,n=this.O[2*Se+1],r=(this.y+this.y)*this.ac[St]*t+t*this.y*t,Wt.b[2]=Wt.b[2]+r,n.b[2]=r+n.b[2],o=Wt.b[0],l=this.ag[0],l>Wt.b[0]&&(l=Wt.b[0],this.ag[0]=o,o=Wt.b[0]),h=Wt.b[1],d=this.ag[1],d>h&&(d=Wt.b[1],this.ag[1]=h,h=Wt.b[1]),u=Wt.b[2],g=this.ag[2],g>u&&(g=Wt.b[2],this.ag[2]=u,u=Wt.b[2]),o>this.ad[0]&&(this.ad[0]=o),h>this.ad[1]&&(this.ad[1]=h),u>this.ad[2]&&(this.ad[2]=u),b=n.b[0],l>n.b[0]&&(this.ag[0]=b,b=n.b[0]),_=n.b[1],d>_&&(this.ag[1]=_,_=n.b[1]),y=n.b[2],g>y&&(this.ag[2]=y,y=n.b[2]),b>this.ad[0]&&(this.ad[0]=b),_>this.ad[1]&&(this.ad[1]=_),y>this.ad[2]&&(this.ad[2]=y),nn=this.ac.length,this.ac[St]=t+this.ac[St],I=this.h,Vt=this.ac.length,S=I*this.ac[St]*this.W+this.L.a,Wt.c[1]=this.L.d,Wt.c[0]=S,n.c[1]=this.L.b,n.c[0]=S,k=this.ac.length,Ge=xe+1,Se=Ge-k,k>Ge&&(Se=Ge);this.z=!0}C(t,e){let i=e+t;t=i;let n=this.ac.length;return i>=n&&(t=i-n),t}t(t,e,i,n,r,o){let l,h,d,u,g,b,_,y;_=Math.ceil(t),y=Math.max(.25,e),l=Math.ceil(y*_),h=Math.ceil(Math.max(l+1+1,0)),this.ac=new Array(h),this.m=0,this.i=0,this.Z=0,this.c=!1,this.O=new Array(2*h);for(let I=0;I<this.O.length;I++){this.O[I]=new Cl;let S=this.O[I];S.b[0]=0,S.b[1]=0,S.b[2]=0,S.a=mt(0,0,0,0),S.c[0]=0,S.c[1]=0}this.av=new Array(4*h);for(let I=0;I<this.av.length;I++)this.av[I]=I%(2*h);this.W=1/y,d=o,(2147483648&o)!=0&&(d=(1&o|o>>1)+(1&o|o>>1)),this.h=(n.c-n.a)/d,u=r,(2147483648&r)!=0&&(u=(1&r|r>>1)+(1&r|r>>1)),this.aa=(n.b-n.d)/u,this.ar=1/this.h,this.I=1/this.aa,this.ao=_,this.at=y,Ft(i,i,1/255),this.N=i,this.ae=n,this.f=r,this.b=o,this.al=0,g=0*this.h+this.ae.a,this.L.a=g,b=0*this.aa+this.ae.d,this.L.d=b,this.L.c=g+this.h,this.L.b=b+this.aa,this.l=10,this.aj=10,this.y=0,this.P=!0,this.am=!0,this.ak=!0,this.V=this.ai.H.h(0),this.K=this.ai.H.b(0),this.D=this.ai.H.l(this.V,this.K)}w(){let t=new Array(this.O.length);for(let e=0,i=0;e<this.O.length;++e)t[i++]=this.O[e].b[0],t[i++]=this.O[e].b[1],t[i++]=this.O[e].b[2],t[i++]=this.O[e].a[0],t[i++]=this.O[e].a[1],t[i++]=this.O[e].a[2],t[i++]=this.O[e].a[3],t[i++]=this.O[e].c[0],t[i++]=this.O[e].c[1];this.F()||(this.V.b(new Float32Array(t)),this.K.b(new Uint16Array(this.av)))}u(t){const e=this.ai.H;var i=this.v.c[t];if(i<=-1||i>this.ai.aD.length)return null;let n=this.ai.aD[i];if(!n.c||!n.c.f)return null;let r=t;r>=this.v.a.length&&(r=0);let o=this.ai.c.I[this.v.a[r]],l=Object.assign({},this.ai.R);const h=e.e(this.ai.I,new Ro(!1,!this.ai.aH,Sl[o.a],!0,!1,15),new q([n.c],l));return e.g(new Uo(this.D,0,0),h,0,0)}X(t){if(this.F())return;const e=this.ai.H.o();for(let i=0;i<this.v.c.length;i++){if(this.e[i]||(this.e[i]=this.u(i)),!this.e[i]||!t&&this.e[i].f.b()>Wn.GxBlend_AlphaKey)continue;let n=this.i>this.m?2*(this.i-this.m)+2:2*(this.ac.length+this.i-this.m)+2;this.e[i].g=n,this.e[i].e=2*this.m*2,e.d(this.e[i])}}},kl=class{constructor(t){var e=this;e.g=E(t.getFloat(),t.getFloat(),t.getFloat()),e.c=mt(t.getFloat(),t.getFloat(),t.getFloat(),0),e.i=t.getFloat(),e.a=t.getFloat(),e.b=t.getFloat(),e.e=t.getFloat(),e.f=[t.getUint8(),t.getUint8(),t.getUint8(),t.getUint8()],e.d=[t.getUint8(),t.getUint8(),t.getUint8(),t.getUint8()]}h(){var t=this;t.g=null,t.c=null,t.f=null,t.d=null}},Dl=class{constructor(t){var e=this;e.d=t.getUint16(),e.k=t.getUint16(),e.g=t.getUint16(),e.e=t.getUint16(),e.f=t.getUint16()+65536*e.k,e.b=t.getUint16(),e.c=t.getUint16(),e.a=E(t.getFloat(),t.getFloat(),t.getFloat()),e.j=E(t.getFloat(),t.getFloat(),t.getFloat()),e.h=t.getFloat()}i(){this.a=null,this.j=null}},Ua=class{constructor(t){this.b=t.getUint16(),this.a=t.getUint16()}static c(t){const e=t.u.c,i=t.F;e.I&&i.i<e.I.length?t.e=e.I[i.i]:t.e={b:0,a:0},t.v=(1&t.e.b)!=0,t.l=(4&t.e.b)==0,t.w=(16&t.e.b)!=0}},Fl=class{constructor(t){this.b=new Ct(t,Di),this.c=new Ct(t,Fa),this.a=new Ct(t,Di)}d(){var t=this;t.b&&(t.b.e(),t.b=null),t.c&&(t.c.e(),t.c=null),t.a&&(t.a.e(),t.a=null)}},Il=class{constructor(t){var e=this;e.d=t.getInt32(),e.a=t.getInt32(),e.c=E(t.getFloat(),t.getFloat(),t.getFloat()),e.b=-1}e(){this.c=null}},Ol=class{constructor(t){this.g=new Ct(t,Di),this.a=new Ct(t,Yn)}d(){var t=this;t.g&&t.g.e(),t.a&&t.a.e()}e(t){return!!this.g&&this.g.d(t)}f(t){return!!this.a&&this.a.d(t)}b(t){return this.e(t)||this.f(t)}c(t,e,i){var n=this;i?i[0]=i[1]=i[2]=i[3]=1:i=mt(1,1,1,1);let r=E(1,1,1);return n.e(t.e.d)&&n.g.c(t,e,r,r),n.f(t.e.d)&&(i[3]=n.a.c(t,e,32767)/32767),i[0]=r[0],i[1]=r[1],i[2]=r[2],i}},Rl=class{constructor(t){this.b=new Ct(t,Yn)}d(){this.b.e(),this.b=null}a(t){return this.b.d(t)}c(t,e){var i=1;return this.a(t.e.d)&&(i=this.b.c(t,e,i)/32767),i>1?i=1:i<0&&(i=0),i}},Ul=class{constructor(t){var e=this;e.b=t.getFloat(),e.a=t.getFloat(),e.c=t.getFloat(),e.d=new Os(t)}},Pl=class{constructor(t){this.S=t.getInt32(),this.e=t.getUint32(),this.k=E(t.getFloat(),t.getFloat(),t.getFloat()),this.d=t.getInt16(),this.C=t.getInt16(),(268435456&this.e)!=0&&(this.f=[0,0,0],this.f[0]=31&this.C,this.f[1]=this.C>>5&31,this.f[2]=this.C>>10&31),this.q=t.getUint8(),this.r=t.getUint8(),this.b=t.getUint16(),this.U=t.getUint16(),this.c=t.getUint16(),this.x=t.getUint16(),this.P=new Ct(t,me),this.p=new Ct(t,me),this.H=new Ct(t,me),this.K=new Ct(t,me),this.i=new Ct(t,Di),this.a=new Ct(t,me),this.N=t.getFloat(),this.o=new Ct(t,me),this.J=t.getFloat(),this.R=new Ct(t,me),this.W=new Ct(t,me),this.F=new Ct(t,me),this.w=new gl(t),this.M=new Os(t),this.A=new pl(t),this.y=[t.getFloat(),t.getFloat()],this.z=new Os(t),this.g=new Os(t),this.j=t.getFloat(),this.m=t.getFloat(),this.B=t.getFloat(),this.l=[t.getFloat(),t.getFloat()],this.L=t.getFloat(),this.v=t.getFloat(),this.I=t.getFloat(),this.X=t.getFloat(),this.t=t.getFloat(),this.G=t.getFloat(),this.Q=E(t.getFloat(),t.getFloat(),t.getFloat()),this.O=E(t.getFloat(),t.getFloat(),t.getFloat()),this.n=E(t.getFloat(),t.getFloat(),t.getFloat()),this.E=t.getFloat(),this.T=t.getFloat(),this.u=t.getFloat(),this.Z=t.getFloat(),this.aa=t.getFloat();var e=t.getInt32();this.h=new Array(e);for(var i=0;i<e;i++)this.h[i]=E(t.getFloat(),t.getFloat(),t.getFloat());this.Y=new Ct(t,Fo),this.s=Yi(t.getFloat(),t.getFloat()),this.V=[Yi(t.getFloat(),t.getFloat()),Yi(t.getFloat(),t.getFloat())],this.D=[Yi(t.getFloat(),t.getFloat()),Yi(t.getFloat(),t.getFloat())]}};class Bl{constructor(e){this.g=e.getInt32(),this.i=e.getUint32(),this.a=e.getInt16(),this.f=e.getUint16(),this.c=e.getUint32(),this.e=E(e.getFloat(),e.getFloat(),e.getFloat()),this.d=new Ct(e,Di),this.b=new Ct(e,Fa),this.h=new Ct(e,Di)}}const No=class{constructor(t){this.buffer=new DataView(t),this.position=0}getBool(){var t=this.buffer.getUint8(this.position)!=0;return this.position+=1,t}getUint8(){var t=this.buffer.getUint8(this.position);return this.position+=1,t}getInt8(){var t=this.buffer.getInt8(this.position);return this.position+=1,t}getUint16(){var t=this.buffer.getUint16(this.position,!0);return this.position+=2,t}getInt16(){var t=this.buffer.getInt16(this.position,!0);return this.position+=2,t}getUint32(){var t=this.buffer.getUint32(this.position,!0);return this.position+=4,t}getInt32(){var t=this.buffer.getInt32(this.position,!0);return this.position+=4,t}getFloat(){var t=this.buffer.getFloat32(this.position,!0);return this.position+=4,t}getString(t){t===void 0&&(t=this.getUint16());for(var e="",i=0;i<t;++i)e+=String.fromCharCode(this.getUint8());return e}setBool(t){this.buffer.setUint8(this.position,t?1:0),this.position+=1}setUint8(t){this.buffer.setUint8(this.position,t),this.position+=1}setInt8(t){this.buffer.setInt8(this.position,t),this.position+=1}setUint16(t){this.buffer.setUint16(this.position,t,!0),this.position+=2}setInt16(t){this.buffer.setInt16(this.position,t,!0),this.position+=2}setUint32(t){this.buffer.setUint32(this.position,t,!0),this.position+=4}setInt32(t){this.buffer.setInt32(this.position,t,!0),this.position+=4}setFloat(t){this.buffer.setFloat32(this.position,t,!0),this.position+=4}};function Zn(t){let e=t.length;for(;--e>=0;)t[e]=0}const jo=256,Pa=286,kr=30,Dr=15,Lo=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Us=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Nl=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Ba=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fi=new Array(576);Zn(Fi);const Fr=new Array(60);Zn(Fr);const Ir=new Array(512);Zn(Ir);const Or=new Array(256);Zn(Or);const zo=new Array(29);Zn(zo);const Ps=new Array(kr);function Ho(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}let Na,ja,La;function Go(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}Zn(Ps);const za=t=>t<256?Ir[t]:Ir[256+(t>>>7)],Rr=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},Ee=(t,e,i)=>{t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,Rr(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},fi=(t,e,i)=>{Ee(t,i[2*e],i[2*e+1])},Ha=(t,e)=>{let i=0;do i|=1&t,t>>>=1,i<<=1;while(--e>0);return i>>>1},Ga=(t,e,i)=>{const n=new Array(16);let r,o,l=0;for(r=1;r<=Dr;r++)l=l+i[r-1]<<1,n[r]=l;for(o=0;o<=e;o++){let h=t[2*o+1];h!==0&&(t[2*o]=Ha(n[h]++,h))}},qa=t=>{let e;for(e=0;e<Pa;e++)t.dyn_ltree[2*e]=0;for(e=0;e<kr;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Wa=t=>{t.bi_valid>8?Rr(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},Va=(t,e,i,n)=>{const r=2*e,o=2*i;return t[r]<t[o]||t[r]===t[o]&&n[e]<=n[i]},qo=(t,e,i)=>{const n=t.heap[i];let r=i<<1;for(;r<=t.heap_len&&(r<t.heap_len&&Va(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!Va(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n},Xa=(t,e,i)=>{let n,r,o,l,h=0;if(t.sym_next!==0)do n=255&t.pending_buf[t.sym_buf+h++],n+=(255&t.pending_buf[t.sym_buf+h++])<<8,r=t.pending_buf[t.sym_buf+h++],n===0?fi(t,r,e):(o=Or[r],fi(t,o+jo+1,e),l=Lo[o],l!==0&&(r-=zo[o],Ee(t,r,l)),n--,o=za(n),fi(t,o,i),l=Us[o],l!==0&&(n-=Ps[o],Ee(t,n,l)));while(h<t.sym_next);fi(t,256,e)},Wo=(t,e)=>{const i=e.dyn_tree,n=e.stat_desc.static_tree,r=e.stat_desc.has_stree,o=e.stat_desc.elems;let l,h,d,u=-1;for(t.heap_len=0,t.heap_max=573,l=0;l<o;l++)i[2*l]!==0?(t.heap[++t.heap_len]=u=l,t.depth[l]=0):i[2*l+1]=0;for(;t.heap_len<2;)d=t.heap[++t.heap_len]=u<2?++u:0,i[2*d]=1,t.depth[d]=0,t.opt_len--,r&&(t.static_len-=n[2*d+1]);for(e.max_code=u,l=t.heap_len>>1;l>=1;l--)qo(t,i,l);d=o;do l=t.heap[1],t.heap[1]=t.heap[t.heap_len--],qo(t,i,1),h=t.heap[1],t.heap[--t.heap_max]=l,t.heap[--t.heap_max]=h,i[2*d]=i[2*l]+i[2*h],t.depth[d]=(t.depth[l]>=t.depth[h]?t.depth[l]:t.depth[h])+1,i[2*l+1]=i[2*h+1]=d,t.heap[1]=d++,qo(t,i,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((g,b)=>{const _=b.dyn_tree,y=b.max_code,I=b.stat_desc.static_tree,S=b.stat_desc.has_stree,k=b.stat_desc.extra_bits,U=b.stat_desc.extra_base,G=b.stat_desc.max_length;let F,P,T,C,N,V,W=0;for(C=0;C<=Dr;C++)g.bl_count[C]=0;for(_[2*g.heap[g.heap_max]+1]=0,F=g.heap_max+1;F<573;F++)P=g.heap[F],C=_[2*_[2*P+1]+1]+1,C>G&&(C=G,W++),_[2*P+1]=C,P>y||(g.bl_count[C]++,N=0,P>=U&&(N=k[P-U]),V=_[2*P],g.opt_len+=V*(C+N),S&&(g.static_len+=V*(I[2*P+1]+N)));if(W!==0){do{for(C=G-1;g.bl_count[C]===0;)C--;g.bl_count[C]--,g.bl_count[C+1]+=2,g.bl_count[G]--,W-=2}while(W>0);for(C=G;C!==0;C--)for(P=g.bl_count[C];P!==0;)T=g.heap[--F],T>y||(_[2*T+1]!==C&&(g.opt_len+=(C-_[2*T+1])*_[2*T],_[2*T+1]=C),P--)}})(t,e),Ga(i,u,t.bl_count)},Ya=(t,e,i)=>{let n,r,o=-1,l=e[1],h=0,d=7,u=4;for(l===0&&(d=138,u=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=l,l=e[2*(n+1)+1],++h<d&&r===l||(h<u?t.bl_tree[2*r]+=h:r!==0?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[32]++):h<=10?t.bl_tree[34]++:t.bl_tree[36]++,h=0,o=r,l===0?(d=138,u=3):r===l?(d=6,u=3):(d=7,u=4))},Za=(t,e,i)=>{let n,r,o=-1,l=e[1],h=0,d=7,u=4;for(l===0&&(d=138,u=3),n=0;n<=i;n++)if(r=l,l=e[2*(n+1)+1],!(++h<d&&r===l)){if(h<u)do fi(t,r,t.bl_tree);while(--h!=0);else r!==0?(r!==o&&(fi(t,r,t.bl_tree),h--),fi(t,16,t.bl_tree),Ee(t,h-3,2)):h<=10?(fi(t,17,t.bl_tree),Ee(t,h-3,3)):(fi(t,18,t.bl_tree),Ee(t,h-11,7));h=0,o=r,l===0?(d=138,u=3):r===l?(d=6,u=3):(d=7,u=4)}};let $a=!1;const Ja=(t,e,i,n)=>{Ee(t,0+(n?1:0),3),Wa(t),Rr(t,i),Rr(t,~i),i&&t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i};var jl=t=>{$a||((()=>{let e,i,n,r,o;const l=new Array(16);for(n=0,r=0;r<28;r++)for(zo[r]=n,e=0;e<1<<Lo[r];e++)Or[n++]=r;for(Or[n-1]=r,o=0,r=0;r<16;r++)for(Ps[r]=o,e=0;e<1<<Us[r];e++)Ir[o++]=r;for(o>>=7;r<kr;r++)for(Ps[r]=o<<7,e=0;e<1<<Us[r]-7;e++)Ir[256+o++]=r;for(i=0;i<=Dr;i++)l[i]=0;for(e=0;e<=143;)Fi[2*e+1]=8,e++,l[8]++;for(;e<=255;)Fi[2*e+1]=9,e++,l[9]++;for(;e<=279;)Fi[2*e+1]=7,e++,l[7]++;for(;e<=287;)Fi[2*e+1]=8,e++,l[8]++;for(Ga(Fi,287,l),e=0;e<kr;e++)Fr[2*e+1]=5,Fr[2*e]=Ha(e,5);Na=new Ho(Fi,Lo,257,Pa,Dr),ja=new Ho(Fr,Us,0,kr,Dr),La=new Ho(new Array(0),Nl,0,19,7)})(),$a=!0),t.l_desc=new Go(t.dyn_ltree,Na),t.d_desc=new Go(t.dyn_dtree,ja),t.bl_desc=new Go(t.bl_tree,La),t.bi_buf=0,t.bi_valid=0,qa(t)},Ll=(t,e,i,n)=>{let r,o,l=0;t.level>0?(t.strm.data_type===2&&(t.strm.data_type=(h=>{let d,u=4093624447;for(d=0;d<=31;d++,u>>>=1)if(1&u&&h.dyn_ltree[2*d]!==0)return 0;if(h.dyn_ltree[18]!==0||h.dyn_ltree[20]!==0||h.dyn_ltree[26]!==0)return 1;for(d=32;d<jo;d++)if(h.dyn_ltree[2*d]!==0)return 1;return 0})(t)),Wo(t,t.l_desc),Wo(t,t.d_desc),l=(h=>{let d;for(Ya(h,h.dyn_ltree,h.l_desc.max_code),Ya(h,h.dyn_dtree,h.d_desc.max_code),Wo(h,h.bl_desc),d=18;d>=3&&h.bl_tree[2*Ba[d]+1]===0;d--);return h.opt_len+=3*(d+1)+5+5+4,d})(t),r=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=r&&(r=o)):r=o=i+5,i+4<=r&&e!==-1?Ja(t,e,i,n):t.strategy===4||o===r?(Ee(t,2+(n?1:0),3),Xa(t,Fi,Fr)):(Ee(t,4+(n?1:0),3),((h,d,u,g)=>{let b;for(Ee(h,d-257,5),Ee(h,u-1,5),Ee(h,g-4,4),b=0;b<g;b++)Ee(h,h.bl_tree[2*Ba[b]+1],3);Za(h,h.dyn_ltree,d-1),Za(h,h.dyn_dtree,u-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,l+1),Xa(t,t.dyn_ltree,t.dyn_dtree)),qa(t),n&&Wa(t)},zl=(t,e,i)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=i,e===0?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(Or[i]+jo+1)]++,t.dyn_dtree[2*za(e)]++),t.sym_next===t.sym_end),Hl={_tr_init:jl,_tr_stored_block:Ja,_tr_flush_block:Ll,_tr_tally:zl,_tr_align:t=>{Ee(t,2,3),fi(t,256,Fi),(e=>{e.bi_valid===16?(Rr(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(t)}},Ur=(t,e,i,n)=>{let r=65535&t|0,o=t>>>16&65535|0,l=0;for(;i!==0;){l=i>2e3?2e3:i,i-=l;do r=r+e[n++]|0,o=o+r|0;while(--l);r%=65521,o%=65521}return r|o<<16|0};const Gl=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());var he=(t,e,i,n)=>{const r=Gl,o=n+i;t^=-1;for(let l=n;l<o;l++)t=t>>>8^r[255&(t^e[l])];return-1^t},vn={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},$n={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ql,_tr_stored_block:Vo,_tr_flush_block:Wl,_tr_tally:Zi,_tr_align:Vl}=Hl,{Z_NO_FLUSH:$i,Z_PARTIAL_FLUSH:Xl,Z_FULL_FLUSH:Yl,Z_FINISH:ze,Z_BLOCK:Ka,Z_OK:ce,Z_STREAM_END:Qa,Z_STREAM_ERROR:pi,Z_DATA_ERROR:Zl,Z_BUF_ERROR:Xo,Z_DEFAULT_COMPRESSION:$l,Z_FILTERED:Jl,Z_HUFFMAN_ONLY:Bs,Z_RLE:Kl,Z_FIXED:Ql,Z_DEFAULT_STRATEGY:tu,Z_UNKNOWN:eu,Z_DEFLATED:Ns}=$n,_n=258,gi=262,Jn=42,xn=113,Pr=666,yn=(t,e)=>(t.msg=vn[e],e),th=t=>2*t-(t>4?9:0),Ji=t=>{let e=t.length;for(;--e>=0;)t[e]=0},iu=t=>{let e,i,n,r=t.w_size;e=t.hash_size,n=e;do i=t.head[--n],t.head[n]=i>=r?i-r:0;while(--e);e=r,n=e;do i=t.prev[--n],t.prev[n]=i>=r?i-r:0;while(--e)};let Ki=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask;const Re=t=>{const e=t.state;let i=e.pending;i>t.avail_out&&(i=t.avail_out),i!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,e.pending===0&&(e.pending_out=0))},Ue=(t,e)=>{Wl(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Re(t.strm)},kt=(t,e)=>{t.pending_buf[t.pending++]=e},Br=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Yo=(t,e,i,n)=>{let r=t.avail_in;return r>n&&(r=n),r===0?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),i),t.state.wrap===1?t.adler=Ur(t.adler,e,r,i):t.state.wrap===2&&(t.adler=he(t.adler,e,r,i)),t.next_in+=r,t.total_in+=r,r)},eh=(t,e)=>{let i,n,r=t.max_chain_length,o=t.strstart,l=t.prev_length,h=t.nice_match;const d=t.strstart>t.w_size-gi?t.strstart-(t.w_size-gi):0,u=t.window,g=t.w_mask,b=t.prev,_=t.strstart+_n;let y=u[o+l-1],I=u[o+l];t.prev_length>=t.good_match&&(r>>=2),h>t.lookahead&&(h=t.lookahead);do if(i=e,u[i+l]===I&&u[i+l-1]===y&&u[i]===u[o]&&u[++i]===u[o+1]){o+=2,i++;do;while(u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&o<_);if(n=_n-(_-o),o=_-_n,n>l){if(t.match_start=e,l=n,n>=h)break;y=u[o+l-1],I=u[o+l]}}while((e=b[e&g])>d&&--r!=0);return l<=t.lookahead?l:t.lookahead},Kn=t=>{const e=t.w_size;let i,n,r;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-gi)&&(t.window.set(t.window.subarray(e,e+e-n),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),iu(t),n+=e),t.strm.avail_in===0)break;if(i=Yo(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=i,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=Ki(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=Ki(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<gi&&t.strm.avail_in!==0)},ih=(t,e)=>{let i,n,r,o=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,l=0,h=t.strm.avail_in;do{if(i=65535,r=t.bi_valid+42>>3,t.strm.avail_out<r||(r=t.strm.avail_out-r,n=t.strstart-t.block_start,i>n+t.strm.avail_in&&(i=n+t.strm.avail_in),i>r&&(i=r),i<o&&(i===0&&e!==ze||e===$i||i!==n+t.strm.avail_in)))break;l=e===ze&&i===n+t.strm.avail_in?1:0,Vo(t,0,0,l),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,Re(t.strm),n&&(n>i&&(n=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+n),t.strm.next_out),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n,t.block_start+=n,i-=n),i&&(Yo(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(l===0);return h-=t.strm.avail_in,h&&(h>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=h&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-h,t.strm.next_in),t.strstart),t.strstart+=h,t.insert+=h>t.w_size-t.insert?t.w_size-t.insert:h),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),l?4:e!==$i&&e!==ze&&t.strm.avail_in===0&&t.strstart===t.block_start?2:(r=t.window_size-t.strstart,t.strm.avail_in>r&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,r+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),r>t.strm.avail_in&&(r=t.strm.avail_in),r&&(Yo(t.strm,t.window,t.strstart,r),t.strstart+=r,t.insert+=r>t.w_size-t.insert?t.w_size-t.insert:r),t.high_water<t.strstart&&(t.high_water=t.strstart),r=t.bi_valid+42>>3,r=t.pending_buf_size-r>65535?65535:t.pending_buf_size-r,o=r>t.w_size?t.w_size:r,n=t.strstart-t.block_start,(n>=o||(n||e===ze)&&e!==$i&&t.strm.avail_in===0&&n<=r)&&(i=n>r?r:n,l=e===ze&&t.strm.avail_in===0&&i===n?1:0,Vo(t,t.block_start,i,l),t.block_start+=i,Re(t.strm)),l?3:1)},Zo=(t,e)=>{let i,n;for(;;){if(t.lookahead<gi){if(Kn(t),t.lookahead<gi&&e===$i)return 1;if(t.lookahead===0)break}if(i=0,t.lookahead>=3&&(t.ins_h=Ki(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),i!==0&&t.strstart-i<=t.w_size-gi&&(t.match_length=eh(t,i)),t.match_length>=3)if(n=Zi(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do t.strstart++,t.ins_h=Ki(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!=0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Ki(t,t.ins_h,t.window[t.strstart+1]);else n=Zi(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Ue(t,!1),t.strm.avail_out===0))return 1}return t.insert=t.strstart<2?t.strstart:2,e===ze?(Ue(t,!0),t.strm.avail_out===0?3:4):t.sym_next&&(Ue(t,!1),t.strm.avail_out===0)?1:2},Qn=(t,e)=>{let i,n,r;for(;;){if(t.lookahead<gi){if(Kn(t),t.lookahead<gi&&e===$i)return 1;if(t.lookahead===0)break}if(i=0,t.lookahead>=3&&(t.ins_h=Ki(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,i!==0&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-gi&&(t.match_length=eh(t,i),t.match_length<=5&&(t.strategy===Jl||t.match_length===3&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=Zi(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=r&&(t.ins_h=Ki(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!=0);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(Ue(t,!1),t.strm.avail_out===0))return 1}else if(t.match_available){if(n=Zi(t,0,t.window[t.strstart-1]),n&&Ue(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=Zi(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===ze?(Ue(t,!0),t.strm.avail_out===0?3:4):t.sym_next&&(Ue(t,!1),t.strm.avail_out===0)?1:2};function mi(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}const Nr=[new mi(0,0,0,0,ih),new mi(4,4,8,4,Zo),new mi(4,5,16,8,Zo),new mi(4,6,32,32,Zo),new mi(4,4,16,16,Qn),new mi(8,16,32,32,Qn),new mi(8,16,128,128,Qn),new mi(8,32,128,256,Qn),new mi(32,128,258,1024,Qn),new mi(32,258,258,4096,Qn)];function nu(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ns,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Ji(this.dyn_ltree),Ji(this.dyn_dtree),Ji(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Ji(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Ji(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const jr=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==Jn&&e.status!==57&&e.status!==69&&e.status!==73&&e.status!==91&&e.status!==103&&e.status!==xn&&e.status!==Pr?1:0},nh=t=>{if(jr(t))return yn(t,pi);t.total_in=t.total_out=0,t.data_type=eu;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?57:e.wrap?Jn:xn,t.adler=e.wrap===2?0:1,e.last_flush=-2,ql(e),ce},rh=t=>{const e=nh(t);var i;return e===ce&&((i=t.state).window_size=2*i.w_size,Ji(i.head),i.max_lazy_match=Nr[i.level].max_lazy,i.good_match=Nr[i.level].good_length,i.nice_match=Nr[i.level].nice_length,i.max_chain_length=Nr[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),e},sh=(t,e,i,n,r,o)=>{if(!t)return pi;let l=1;if(e===$l&&(e=6),n<0?(l=0,n=-n):n>15&&(l=2,n-=16),r<1||r>9||i!==Ns||n<8||n>15||e<0||e>9||o<0||o>Ql||n===8&&l!==1)return yn(t,pi);n===8&&(n=9);const h=new nu;return t.state=h,h.strm=t,h.status=Jn,h.wrap=l,h.gzhead=null,h.w_bits=n,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=r+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+3-1)/3),h.window=new Uint8Array(2*h.w_size),h.head=new Uint16Array(h.hash_size),h.prev=new Uint16Array(h.w_size),h.lit_bufsize=1<<r+6,h.pending_buf_size=4*h.lit_bufsize,h.pending_buf=new Uint8Array(h.pending_buf_size),h.sym_buf=h.lit_bufsize,h.sym_end=3*(h.lit_bufsize-1),h.level=e,h.strategy=o,h.method=i,rh(t)};var ru=(t,e)=>{if(jr(t)||e>Ka||e<0)return t?yn(t,pi):pi;const i=t.state;if(!t.output||t.avail_in!==0&&!t.input||i.status===Pr&&e!==ze)return yn(t,t.avail_out===0?Xo:pi);const n=i.last_flush;if(i.last_flush=e,i.pending!==0){if(Re(t),t.avail_out===0)return i.last_flush=-1,ce}else if(t.avail_in===0&&th(e)<=th(n)&&e!==ze)return yn(t,Xo);if(i.status===Pr&&t.avail_in!==0)return yn(t,Xo);if(i.status===Jn&&i.wrap===0&&(i.status=xn),i.status===Jn){let r=Ns+(i.w_bits-8<<4)<<8,o=-1;if(o=i.strategy>=Bs||i.level<2?0:i.level<6?1:i.level===6?2:3,r|=o<<6,i.strstart!==0&&(r|=32),r+=31-r%31,Br(i,r),i.strstart!==0&&(Br(i,t.adler>>>16),Br(i,65535&t.adler)),t.adler=1,i.status=xn,Re(t),i.pending!==0)return i.last_flush=-1,ce}if(i.status===57){if(t.adler=0,kt(i,31),kt(i,139),kt(i,8),i.gzhead)kt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),kt(i,255&i.gzhead.time),kt(i,i.gzhead.time>>8&255),kt(i,i.gzhead.time>>16&255),kt(i,i.gzhead.time>>24&255),kt(i,i.level===9?2:i.strategy>=Bs||i.level<2?4:0),kt(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(kt(i,255&i.gzhead.extra.length),kt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=he(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(kt(i,0),kt(i,0),kt(i,0),kt(i,0),kt(i,0),kt(i,i.level===9?2:i.strategy>=Bs||i.level<2?4:0),kt(i,3),i.status=xn,Re(t),i.pending!==0)return i.last_flush=-1,ce}if(i.status===69){if(i.gzhead.extra){let r=i.pending,o=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+o>i.pending_buf_size;){let h=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+h),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>r&&(t.adler=he(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex+=h,Re(t),i.pending!==0)return i.last_flush=-1,ce;r=0,o-=h}let l=new Uint8Array(i.gzhead.extra);i.pending_buf.set(l.subarray(i.gzindex,i.gzindex+o),i.pending),i.pending+=o,i.gzhead.hcrc&&i.pending>r&&(t.adler=he(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex=0}i.status=73}if(i.status===73){if(i.gzhead.name){let r,o=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>o&&(t.adler=he(t.adler,i.pending_buf,i.pending-o,o)),Re(t),i.pending!==0)return i.last_flush=-1,ce;o=0}r=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,kt(i,r)}while(r!==0);i.gzhead.hcrc&&i.pending>o&&(t.adler=he(t.adler,i.pending_buf,i.pending-o,o)),i.gzindex=0}i.status=91}if(i.status===91){if(i.gzhead.comment){let r,o=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>o&&(t.adler=he(t.adler,i.pending_buf,i.pending-o,o)),Re(t),i.pending!==0)return i.last_flush=-1,ce;o=0}r=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,kt(i,r)}while(r!==0);i.gzhead.hcrc&&i.pending>o&&(t.adler=he(t.adler,i.pending_buf,i.pending-o,o))}i.status=103}if(i.status===103){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Re(t),i.pending!==0))return i.last_flush=-1,ce;kt(i,255&t.adler),kt(i,t.adler>>8&255),t.adler=0}if(i.status=xn,Re(t),i.pending!==0)return i.last_flush=-1,ce}if(t.avail_in!==0||i.lookahead!==0||e!==$i&&i.status!==Pr){let r=i.level===0?ih(i,e):i.strategy===Bs?((o,l)=>{let h;for(;;){if(o.lookahead===0&&(Kn(o),o.lookahead===0)){if(l===$i)return 1;break}if(o.match_length=0,h=Zi(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++,h&&(Ue(o,!1),o.strm.avail_out===0))return 1}return o.insert=0,l===ze?(Ue(o,!0),o.strm.avail_out===0?3:4):o.sym_next&&(Ue(o,!1),o.strm.avail_out===0)?1:2})(i,e):i.strategy===Kl?((o,l)=>{let h,d,u,g;const b=o.window;for(;;){if(o.lookahead<=_n){if(Kn(o),o.lookahead<=_n&&l===$i)return 1;if(o.lookahead===0)break}if(o.match_length=0,o.lookahead>=3&&o.strstart>0&&(u=o.strstart-1,d=b[u],d===b[++u]&&d===b[++u]&&d===b[++u])){g=o.strstart+_n;do;while(d===b[++u]&&d===b[++u]&&d===b[++u]&&d===b[++u]&&d===b[++u]&&d===b[++u]&&d===b[++u]&&d===b[++u]&&u<g);o.match_length=_n-(g-u),o.match_length>o.lookahead&&(o.match_length=o.lookahead)}if(o.match_length>=3?(h=Zi(o,1,o.match_length-3),o.lookahead-=o.match_length,o.strstart+=o.match_length,o.match_length=0):(h=Zi(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++),h&&(Ue(o,!1),o.strm.avail_out===0))return 1}return o.insert=0,l===ze?(Ue(o,!0),o.strm.avail_out===0?3:4):o.sym_next&&(Ue(o,!1),o.strm.avail_out===0)?1:2})(i,e):Nr[i.level].func(i,e);if(r!==3&&r!==4||(i.status=Pr),r===1||r===3)return t.avail_out===0&&(i.last_flush=-1),ce;if(r===2&&(e===Xl?Vl(i):e!==Ka&&(Vo(i,0,0,!1),e===Yl&&(Ji(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Re(t),t.avail_out===0))return i.last_flush=-1,ce}return e!==ze?ce:i.wrap<=0?Qa:(i.wrap===2?(kt(i,255&t.adler),kt(i,t.adler>>8&255),kt(i,t.adler>>16&255),kt(i,t.adler>>24&255),kt(i,255&t.total_in),kt(i,t.total_in>>8&255),kt(i,t.total_in>>16&255),kt(i,t.total_in>>24&255)):(Br(i,t.adler>>>16),Br(i,65535&t.adler)),Re(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?ce:Qa)},su=(t,e)=>{let i=e.length;if(jr(t))return pi;const n=t.state,r=n.wrap;if(r===2||r===1&&n.status!==Jn||n.lookahead)return pi;if(r===1&&(t.adler=Ur(t.adler,e,i,0)),n.wrap=0,i>=n.w_size){r===0&&(Ji(n.head),n.strstart=0,n.block_start=0,n.insert=0);let d=new Uint8Array(n.w_size);d.set(e.subarray(i-n.w_size,i),0),e=d,i=n.w_size}const o=t.avail_in,l=t.next_in,h=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,Kn(n);n.lookahead>=3;){let d=n.strstart,u=n.lookahead-2;do n.ins_h=Ki(n,n.ins_h,n.window[d+3-1]),n.prev[d&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=d,d++;while(--u);n.strstart=d,n.lookahead=2,Kn(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=l,t.input=h,t.avail_in=o,n.wrap=r,ce},Lr={deflateInit:(t,e)=>sh(t,e,Ns,15,8,tu),deflateInit2:sh,deflateReset:rh,deflateResetKeep:nh,deflateSetHeader:(t,e)=>jr(t)||t.state.wrap!==2?pi:(t.state.gzhead=e,ce),deflate:ru,deflateEnd:t=>{if(jr(t))return pi;const e=t.state.status;return t.state=null,e===xn?yn(t,Zl):ce},deflateSetDictionary:su,deflateInfo:"pako deflate (from Nodeca project)"};const ou=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var js={assign:function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const i=e.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(const n in i)ou(i,n)&&(t[n]=i[n])}}return t},flattenChunks:t=>{let e=0;for(let n=0,r=t.length;n<r;n++)e+=t[n].length;const i=new Uint8Array(e);for(let n=0,r=0,o=t.length;n<o;n++){let l=t[n];i.set(l,r),r+=l.length}return i}};let oh=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{oh=!1}const zr=new Uint8Array(256);for(let t=0;t<256;t++)zr[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;zr[254]=zr[254]=1;var Hr={string2buf:t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,i,n,r,o,l=t.length,h=0;for(r=0;r<l;r++)i=t.charCodeAt(r),(64512&i)==55296&&r+1<l&&(n=t.charCodeAt(r+1),(64512&n)==56320&&(i=65536+(i-55296<<10)+(n-56320),r++)),h+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(h),o=0,r=0;o<h;r++)i=t.charCodeAt(r),(64512&i)==55296&&r+1<l&&(n=t.charCodeAt(r+1),(64512&n)==56320&&(i=65536+(i-55296<<10)+(n-56320),r++)),i<128?e[o++]=i:i<2048?(e[o++]=192|i>>>6,e[o++]=128|63&i):i<65536?(e[o++]=224|i>>>12,e[o++]=128|i>>>6&63,e[o++]=128|63&i):(e[o++]=240|i>>>18,e[o++]=128|i>>>12&63,e[o++]=128|i>>>6&63,e[o++]=128|63&i);return e},buf2string:(t,e)=>{const i=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,r;const o=new Array(2*i);for(r=0,n=0;n<i;){let l=t[n++];if(l<128){o[r++]=l;continue}let h=zr[l];if(h>4)o[r++]=65533,n+=h-1;else{for(l&=h===2?31:h===3?15:7;h>1&&n<i;)l=l<<6|63&t[n++],h--;h>1?o[r++]=65533:l<65536?o[r++]=l:(l-=65536,o[r++]=55296|l>>10&1023,o[r++]=56320|1023&l)}}return((l,h)=>{if(h<65534&&l.subarray&&oh)return String.fromCharCode.apply(null,l.length===h?l:l.subarray(0,h));let d="";for(let u=0;u<h;u++)d+=String.fromCharCode(l[u]);return d})(o,r)},utf8border:(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let i=e-1;for(;i>=0&&(192&t[i])==128;)i--;return i<0||i===0?e:i+zr[t[i]]>e?i:e}},ah=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const hh=Object.prototype.toString,{Z_NO_FLUSH:au,Z_SYNC_FLUSH:hu,Z_FULL_FLUSH:lu,Z_FINISH:uu,Z_OK:Ls,Z_STREAM_END:cu,Z_DEFAULT_COMPRESSION:du,Z_DEFAULT_STRATEGY:fu,Z_DEFLATED:pu}=$n;function Gr(t){this.options=js.assign({level:du,method:pu,chunkSize:16384,windowBits:15,memLevel:8,strategy:fu},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ah,this.strm.avail_out=0;let i=Lr.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==Ls)throw new Error(vn[i]);if(e.header&&Lr.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(n=typeof e.dictionary=="string"?Hr.string2buf(e.dictionary):hh.call(e.dictionary)==="[object ArrayBuffer]"?new Uint8Array(e.dictionary):e.dictionary,i=Lr.deflateSetDictionary(this.strm,n),i!==Ls)throw new Error(vn[i]);this._dict_set=!0}}function $o(t,e){const i=new Gr(e);if(i.push(t,!0),i.err)throw i.msg||vn[i.err];return i.result}Gr.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=e===~~e?e:e===!0?uu:au,typeof t=="string"?i.input=Hr.string2buf(t):hh.call(t)==="[object ArrayBuffer]"?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(i.avail_out===0&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(o===hu||o===lu)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(r=Lr.deflate(i,o),r===cu)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),r=Lr.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Ls;if(i.avail_out!==0){if(o>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(i.avail_in===0)break}else this.onData(i.output)}return!0},Gr.prototype.onData=function(t){this.chunks.push(t)},Gr.prototype.onEnd=function(t){t===Ls&&(this.result=js.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var gu={Deflate:Gr,deflate:$o,deflateRaw:function(t,e){return(e=e||{}).raw=!0,$o(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,$o(t,e)},constants:$n};const zs=16209;var mu=function(t,e){let i,n,r,o,l,h,d,u,g,b,_,y,I,S,k,U,G,F,P,T,C,N,V,W;const J=t.state;i=t.next_in,V=t.input,n=i+(t.avail_in-5),r=t.next_out,W=t.output,o=r-(e-t.avail_out),l=r+(t.avail_out-257),h=J.dmax,d=J.wsize,u=J.whave,g=J.wnext,b=J.window,_=J.hold,y=J.bits,I=J.lencode,S=J.distcode,k=(1<<J.lenbits)-1,U=(1<<J.distbits)-1;t:do{y<15&&(_+=V[i++]<<y,y+=8,_+=V[i++]<<y,y+=8),G=I[_&k];e:for(;;){if(F=G>>>24,_>>>=F,y-=F,F=G>>>16&255,F===0)W[r++]=65535&G;else{if(!(16&F)){if((64&F)==0){G=I[(65535&G)+(_&(1<<F)-1)];continue e}if(32&F){J.mode=16191;break t}t.msg="invalid literal/length code",J.mode=zs;break t}P=65535&G,F&=15,F&&(y<F&&(_+=V[i++]<<y,y+=8),P+=_&(1<<F)-1,_>>>=F,y-=F),y<15&&(_+=V[i++]<<y,y+=8,_+=V[i++]<<y,y+=8),G=S[_&U];i:for(;;){if(F=G>>>24,_>>>=F,y-=F,F=G>>>16&255,!(16&F)){if((64&F)==0){G=S[(65535&G)+(_&(1<<F)-1)];continue i}t.msg="invalid distance code",J.mode=zs;break t}if(T=65535&G,F&=15,y<F&&(_+=V[i++]<<y,y+=8,y<F&&(_+=V[i++]<<y,y+=8)),T+=_&(1<<F)-1,T>h){t.msg="invalid distance too far back",J.mode=zs;break t}if(_>>>=F,y-=F,F=r-o,T>F){if(F=T-F,F>u&&J.sane){t.msg="invalid distance too far back",J.mode=zs;break t}if(C=0,N=b,g===0){if(C+=d-F,F<P){P-=F;do W[r++]=b[C++];while(--F);C=r-T,N=W}}else if(g<F){if(C+=d+g-F,F-=g,F<P){P-=F;do W[r++]=b[C++];while(--F);if(C=0,g<P){F=g,P-=F;do W[r++]=b[C++];while(--F);C=r-T,N=W}}}else if(C+=g-F,F<P){P-=F;do W[r++]=b[C++];while(--F);C=r-T,N=W}for(;P>2;)W[r++]=N[C++],W[r++]=N[C++],W[r++]=N[C++],P-=3;P&&(W[r++]=N[C++],P>1&&(W[r++]=N[C++]))}else{C=r-T;do W[r++]=W[C++],W[r++]=W[C++],W[r++]=W[C++],P-=3;while(P>2);P&&(W[r++]=W[C++],P>1&&(W[r++]=W[C++]))}break}}break}}while(i<n&&r<l);P=y>>3,i-=P,y-=P<<3,_&=(1<<y)-1,t.next_in=i,t.next_out=r,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=r<l?l-r+257:257-(r-l),J.hold=_,J.bits=y};const Hs=15,bu=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),vu=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),_u=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),xu=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var qr=(t,e,i,n,r,o,l,h)=>{const d=h.bits;let u,g,b,_,y,I,S=0,k=0,U=0,G=0,F=0,P=0,T=0,C=0,N=0,V=0,W=null;const J=new Uint16Array(16),at=new Uint16Array(16);let St,Ut,vt,ee=null;for(S=0;S<=Hs;S++)J[S]=0;for(k=0;k<n;k++)J[e[i+k]]++;for(F=d,G=Hs;G>=1&&J[G]===0;G--);if(F>G&&(F=G),G===0)return r[o++]=20971520,r[o++]=20971520,h.bits=1,0;for(U=1;U<G&&J[U]===0;U++);for(F<U&&(F=U),C=1,S=1;S<=Hs;S++)if(C<<=1,C-=J[S],C<0)return-1;if(C>0&&(t===0||G!==1))return-1;for(at[1]=0,S=1;S<Hs;S++)at[S+1]=at[S]+J[S];for(k=0;k<n;k++)e[i+k]!==0&&(l[at[e[i+k]]++]=k);if(t===0?(W=ee=l,I=20):t===1?(W=bu,ee=vu,I=257):(W=_u,ee=xu,I=0),V=0,k=0,S=U,y=o,P=F,T=0,b=-1,N=1<<F,_=N-1,t===1&&N>852||t===2&&N>592)return 1;for(;;){St=S-T,l[k]+1<I?(Ut=0,vt=l[k]):l[k]>=I?(Ut=ee[l[k]-I],vt=W[l[k]-I]):(Ut=96,vt=0),u=1<<S-T,g=1<<P,U=g;do g-=u,r[y+(V>>T)+g]=St<<24|Ut<<16|vt|0;while(g!==0);for(u=1<<S-1;V&u;)u>>=1;if(u!==0?(V&=u-1,V+=u):V=0,k++,--J[S]==0){if(S===G)break;S=e[i+l[k]]}if(S>F&&(V&_)!==b){for(T===0&&(T=F),y+=U,P=S-T,C=1<<P;P+T<G&&(C-=J[P+T],!(C<=0));)P++,C<<=1;if(N+=1<<P,t===1&&N>852||t===2&&N>592)return 1;b=V&_,r[b]=F<<24|P<<16|y-o|0}}return V!==0&&(r[y+V]=S-T<<24|64<<16|0),h.bits=F,0};const{Z_FINISH:lh,Z_BLOCK:yu,Z_TREES:Gs,Z_OK:Tn,Z_STREAM_END:Tu,Z_NEED_DICT:wu,Z_STREAM_ERROR:He,Z_DATA_ERROR:uh,Z_MEM_ERROR:ch,Z_BUF_ERROR:Au,Z_DEFLATED:dh}=$n,qs=16180,Ws=16190,Ii=16191,Jo=16192,Ko=16194,Vs=16199,Xs=16200,Qo=16206,zt=16209,fh=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Eu(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const wn=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<qs||e.mode>16211?1:0},ph=t=>{if(wn(t))return He;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=qs,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,Tn},gh=t=>{if(wn(t))return He;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,ph(t)},mh=(t,e)=>{let i;if(wn(t))return He;const n=t.state;return e<0?(i=0,e=-e):(i=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?He:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,gh(t))},bh=(t,e)=>{if(!t)return He;const i=new Eu;t.state=i,i.strm=t,i.window=null,i.mode=qs;const n=mh(t,e);return n!==Tn&&(t.state=null),n};let ta,ea,vh=!0;const Cu=t=>{if(vh){ta=new Int32Array(512),ea=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(qr(1,t.lens,0,288,ta,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;qr(2,t.lens,0,32,ea,0,t.work,{bits:5}),vh=!1}t.lencode=ta,t.lenbits=9,t.distcode=ea,t.distbits=5},_h=(t,e,i,n)=>{let r;const o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(i-o.wsize,i),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>n&&(r=n),o.window.set(e.subarray(i-n,i-n+r),o.wnext),(n-=r)?(o.window.set(e.subarray(i-n,i),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var Su=(t,e)=>{let i,n,r,o,l,h,d,u,g,b,_,y,I,S,k,U,G,F,P,T,C,N,V=0;const W=new Uint8Array(4);let J,at;const St=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(wn(t)||!t.output||!t.input&&t.avail_in!==0)return He;i=t.state,i.mode===Ii&&(i.mode=Jo),l=t.next_out,r=t.output,d=t.avail_out,o=t.next_in,n=t.input,h=t.avail_in,u=i.hold,g=i.bits,b=h,_=d,N=Tn;t:for(;;)switch(i.mode){case qs:if(i.wrap===0){i.mode=Jo;break}for(;g<16;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}if(2&i.wrap&&u===35615){i.wbits===0&&(i.wbits=15),i.check=0,W[0]=255&u,W[1]=u>>>8&255,i.check=he(i.check,W,2,0),u=0,g=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&u)<<8)+(u>>8))%31){t.msg="incorrect header check",i.mode=zt;break}if((15&u)!==dh){t.msg="unknown compression method",i.mode=zt;break}if(u>>>=4,g-=4,C=8+(15&u),i.wbits===0&&(i.wbits=C),C>15||C>i.wbits){t.msg="invalid window size",i.mode=zt;break}i.dmax=1<<i.wbits,i.flags=0,t.adler=i.check=1,i.mode=512&u?16189:Ii,u=0,g=0;break;case 16181:for(;g<16;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}if(i.flags=u,(255&i.flags)!==dh){t.msg="unknown compression method",i.mode=zt;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=zt;break}i.head&&(i.head.text=u>>8&1),512&i.flags&&4&i.wrap&&(W[0]=255&u,W[1]=u>>>8&255,i.check=he(i.check,W,2,0)),u=0,g=0,i.mode=16182;case 16182:for(;g<32;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}i.head&&(i.head.time=u),512&i.flags&&4&i.wrap&&(W[0]=255&u,W[1]=u>>>8&255,W[2]=u>>>16&255,W[3]=u>>>24&255,i.check=he(i.check,W,4,0)),u=0,g=0,i.mode=16183;case 16183:for(;g<16;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}i.head&&(i.head.xflags=255&u,i.head.os=u>>8),512&i.flags&&4&i.wrap&&(W[0]=255&u,W[1]=u>>>8&255,i.check=he(i.check,W,2,0)),u=0,g=0,i.mode=16184;case 16184:if(1024&i.flags){for(;g<16;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}i.length=u,i.head&&(i.head.extra_len=u),512&i.flags&&4&i.wrap&&(W[0]=255&u,W[1]=u>>>8&255,i.check=he(i.check,W,2,0)),u=0,g=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(y=i.length,y>h&&(y=h),y&&(i.head&&(C=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(o,o+y),C)),512&i.flags&&4&i.wrap&&(i.check=he(i.check,n,y,o)),h-=y,o+=y,i.length-=y),i.length))break t;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(h===0)break t;y=0;do C=n[o+y++],i.head&&C&&i.length<65536&&(i.head.name+=String.fromCharCode(C));while(C&&y<h);if(512&i.flags&&4&i.wrap&&(i.check=he(i.check,n,y,o)),h-=y,o+=y,C)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(h===0)break t;y=0;do C=n[o+y++],i.head&&C&&i.length<65536&&(i.head.comment+=String.fromCharCode(C));while(C&&y<h);if(512&i.flags&&4&i.wrap&&(i.check=he(i.check,n,y,o)),h-=y,o+=y,C)break t}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;g<16;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}if(4&i.wrap&&u!==(65535&i.check)){t.msg="header crc mismatch",i.mode=zt;break}u=0,g=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Ii;break;case 16189:for(;g<32;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}t.adler=i.check=fh(u),u=0,g=0,i.mode=Ws;case Ws:if(i.havedict===0)return t.next_out=l,t.avail_out=d,t.next_in=o,t.avail_in=h,i.hold=u,i.bits=g,wu;t.adler=i.check=1,i.mode=Ii;case Ii:if(e===yu||e===Gs)break t;case Jo:if(i.last){u>>>=7&g,g-=7&g,i.mode=Qo;break}for(;g<3;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}switch(i.last=1&u,u>>>=1,g-=1,3&u){case 0:i.mode=16193;break;case 1:if(Cu(i),i.mode=Vs,e===Gs){u>>>=2,g-=2;break t}break;case 2:i.mode=16196;break;case 3:t.msg="invalid block type",i.mode=zt}u>>>=2,g-=2;break;case 16193:for(u>>>=7&g,g-=7&g;g<32;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",i.mode=zt;break}if(i.length=65535&u,u=0,g=0,i.mode=Ko,e===Gs)break t;case Ko:i.mode=16195;case 16195:if(y=i.length,y){if(y>h&&(y=h),y>d&&(y=d),y===0)break t;r.set(n.subarray(o,o+y),l),h-=y,o+=y,d-=y,l+=y,i.length-=y;break}i.mode=Ii;break;case 16196:for(;g<14;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}if(i.nlen=257+(31&u),u>>>=5,g-=5,i.ndist=1+(31&u),u>>>=5,g-=5,i.ncode=4+(15&u),u>>>=4,g-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=zt;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;g<3;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}i.lens[St[i.have++]]=7&u,u>>>=3,g-=3}for(;i.have<19;)i.lens[St[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,J={bits:i.lenbits},N=qr(0,i.lens,0,19,i.lencode,0,i.work,J),i.lenbits=J.bits,N){t.msg="invalid code lengths set",i.mode=zt;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;V=i.lencode[u&(1<<i.lenbits)-1],k=V>>>24,U=V>>>16&255,G=65535&V,!(k<=g);){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}if(G<16)u>>>=k,g-=k,i.lens[i.have++]=G;else{if(G===16){for(at=k+2;g<at;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}if(u>>>=k,g-=k,i.have===0){t.msg="invalid bit length repeat",i.mode=zt;break}C=i.lens[i.have-1],y=3+(3&u),u>>>=2,g-=2}else if(G===17){for(at=k+3;g<at;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}u>>>=k,g-=k,C=0,y=3+(7&u),u>>>=3,g-=3}else{for(at=k+7;g<at;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}u>>>=k,g-=k,C=0,y=11+(127&u),u>>>=7,g-=7}if(i.have+y>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=zt;break}for(;y--;)i.lens[i.have++]=C}}if(i.mode===zt)break;if(i.lens[256]===0){t.msg="invalid code -- missing end-of-block",i.mode=zt;break}if(i.lenbits=9,J={bits:i.lenbits},N=qr(1,i.lens,0,i.nlen,i.lencode,0,i.work,J),i.lenbits=J.bits,N){t.msg="invalid literal/lengths set",i.mode=zt;break}if(i.distbits=6,i.distcode=i.distdyn,J={bits:i.distbits},N=qr(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,J),i.distbits=J.bits,N){t.msg="invalid distances set",i.mode=zt;break}if(i.mode=Vs,e===Gs)break t;case Vs:i.mode=Xs;case Xs:if(h>=6&&d>=258){t.next_out=l,t.avail_out=d,t.next_in=o,t.avail_in=h,i.hold=u,i.bits=g,mu(t,_),l=t.next_out,r=t.output,d=t.avail_out,o=t.next_in,n=t.input,h=t.avail_in,u=i.hold,g=i.bits,i.mode===Ii&&(i.back=-1);break}for(i.back=0;V=i.lencode[u&(1<<i.lenbits)-1],k=V>>>24,U=V>>>16&255,G=65535&V,!(k<=g);){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}if(U&&(240&U)==0){for(F=k,P=U,T=G;V=i.lencode[T+((u&(1<<F+P)-1)>>F)],k=V>>>24,U=V>>>16&255,G=65535&V,!(F+k<=g);){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}u>>>=F,g-=F,i.back+=F}if(u>>>=k,g-=k,i.back+=k,i.length=G,U===0){i.mode=16205;break}if(32&U){i.back=-1,i.mode=Ii;break}if(64&U){t.msg="invalid literal/length code",i.mode=zt;break}i.extra=15&U,i.mode=16201;case 16201:if(i.extra){for(at=i.extra;g<at;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}i.length+=u&(1<<i.extra)-1,u>>>=i.extra,g-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;V=i.distcode[u&(1<<i.distbits)-1],k=V>>>24,U=V>>>16&255,G=65535&V,!(k<=g);){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}if((240&U)==0){for(F=k,P=U,T=G;V=i.distcode[T+((u&(1<<F+P)-1)>>F)],k=V>>>24,U=V>>>16&255,G=65535&V,!(F+k<=g);){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}u>>>=F,g-=F,i.back+=F}if(u>>>=k,g-=k,i.back+=k,64&U){t.msg="invalid distance code",i.mode=zt;break}i.offset=G,i.extra=15&U,i.mode=16203;case 16203:if(i.extra){for(at=i.extra;g<at;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}i.offset+=u&(1<<i.extra)-1,u>>>=i.extra,g-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=zt;break}i.mode=16204;case 16204:if(d===0)break t;if(y=_-d,i.offset>y){if(y=i.offset-y,y>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=zt;break}y>i.wnext?(y-=i.wnext,I=i.wsize-y):I=i.wnext-y,y>i.length&&(y=i.length),S=i.window}else S=r,I=l-i.offset,y=i.length;y>d&&(y=d),d-=y,i.length-=y;do r[l++]=S[I++];while(--y);i.length===0&&(i.mode=Xs);break;case 16205:if(d===0)break t;r[l++]=i.length,d--,i.mode=Xs;break;case Qo:if(i.wrap){for(;g<32;){if(h===0)break t;h--,u|=n[o++]<<g,g+=8}if(_-=d,t.total_out+=_,i.total+=_,4&i.wrap&&_&&(t.adler=i.check=i.flags?he(i.check,r,_,l-_):Ur(i.check,r,_,l-_)),_=d,4&i.wrap&&(i.flags?u:fh(u))!==i.check){t.msg="incorrect data check",i.mode=zt;break}u=0,g=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;g<32;){if(h===0)break t;h--,u+=n[o++]<<g,g+=8}if(4&i.wrap&&u!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=zt;break}u=0,g=0}i.mode=16208;case 16208:N=Tu;break t;case zt:N=uh;break t;case 16210:return ch;default:return He}return t.next_out=l,t.avail_out=d,t.next_in=o,t.avail_in=h,i.hold=u,i.bits=g,(i.wsize||_!==t.avail_out&&i.mode<zt&&(i.mode<Qo||e!==lh))&&_h(t,t.output,t.next_out,_-t.avail_out),b-=t.avail_in,_-=t.avail_out,t.total_in+=b,t.total_out+=_,i.total+=_,4&i.wrap&&_&&(t.adler=i.check=i.flags?he(i.check,r,_,t.next_out-_):Ur(i.check,r,_,t.next_out-_)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Ii?128:0)+(i.mode===Vs||i.mode===Ko?256:0),(b===0&&_===0||e===lh)&&N===Tn&&(N=Au),N},Oi={inflateReset:gh,inflateReset2:mh,inflateResetKeep:ph,inflateInit:t=>bh(t,15),inflateInit2:bh,inflate:Su,inflateEnd:t=>{if(wn(t))return He;let e=t.state;return e.window&&(e.window=null),t.state=null,Tn},inflateGetHeader:(t,e)=>{if(wn(t))return He;const i=t.state;return(2&i.wrap)==0?He:(i.head=e,e.done=!1,Tn)},inflateSetDictionary:(t,e)=>{const i=e.length;let n,r,o;return wn(t)?He:(n=t.state,n.wrap!==0&&n.mode!==Ws?He:n.mode===Ws&&(r=1,r=Ur(r,e,i,0),r!==n.check)?uh:(o=_h(t,e,i,i),o?(n.mode=16210,ch):(n.havedict=1,Tn)))},inflateInfo:"pako inflate (from Nodeca project)"},Mu=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const xh=Object.prototype.toString,{Z_NO_FLUSH:ku,Z_FINISH:Du,Z_OK:Wr,Z_STREAM_END:ia,Z_NEED_DICT:na,Z_STREAM_ERROR:Fu,Z_DATA_ERROR:yh,Z_MEM_ERROR:Iu}=$n;function Vr(t){this.options=js.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(15&e.windowBits)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ah,this.strm.avail_out=0;let i=Oi.inflateInit2(this.strm,e.windowBits);if(i!==Wr)throw new Error(vn[i]);if(this.header=new Mu,Oi.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Hr.string2buf(e.dictionary):xh.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=Oi.inflateSetDictionary(this.strm,e.dictionary),i!==Wr)))throw new Error(vn[i])}function ra(t,e){const i=new Vr(e);if(i.push(t),i.err)throw i.msg||vn[i.err];return i.result}Vr.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let o,l,h;if(this.ended)return!1;for(l=e===~~e?e:e===!0?Du:ku,xh.call(t)==="[object ArrayBuffer]"?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(i.avail_out===0&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),o=Oi.inflate(i,l),o===na&&r&&(o=Oi.inflateSetDictionary(i,r),o===Wr?o=Oi.inflate(i,l):o===yh&&(o=na));i.avail_in>0&&o===ia&&i.state.wrap>0&&t[i.next_in]!==0;)Oi.inflateReset(i),o=Oi.inflate(i,l);switch(o){case Fu:case yh:case na:case Iu:return this.onEnd(o),this.ended=!0,!1}if(h=i.avail_out,i.next_out&&(i.avail_out===0||o===ia))if(this.options.to==="string"){let d=Hr.utf8border(i.output,i.next_out),u=i.next_out-d,g=Hr.buf2string(i.output,d);i.next_out=u,i.avail_out=n-u,u&&i.output.set(i.output.subarray(d,d+u),0),this.onData(g)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(o!==Wr||h!==0){if(o===ia)return o=Oi.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(i.avail_in===0)break}}return!0},Vr.prototype.onData=function(t){this.chunks.push(t)},Vr.prototype.onEnd=function(t){t===Wr&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=js.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Ou={Inflate:Vr,inflate:ra,inflateRaw:function(t,e){return(e=e||{}).raw=!0,ra(t,e)},ungzip:ra,constants:$n};const{Deflate:cc,deflate:dc,deflateRaw:fc,gzip:pc}=gu,{Inflate:gc,inflate:Ru,inflateRaw:mc,ungzip:bc}=Ou;var Uu=Ru;class Pu{constructor(e){var i=this;i.i=e.getUint16(),i.g=e.getUint16(),i.b=e.getUint32(),i.l=e.getUint32(),i.h=e.getUint16(),i.c=e.getUint16(),i.m=e.getUint16(),i.a=E(e.getFloat(),e.getFloat(),e.getFloat()),i.e=E(e.getFloat(),e.getFloat(),e.getFloat()),i.d=e.getInt16(),i.f=e.getUint16(),e.getBool()&&(i.k=e.getString())}j(){}}class Bu{constructor(e){var i;if(this.g=e.getInt32(),this.b=e.getInt32(),this.h=E(e.getFloat(),e.getFloat(),e.getFloat()),(i=e.getInt32())>0){this.c=new Array(i);for(let n=0;n<i;++n)this.c[n]=e.getInt16()}if((i=e.getInt32())>0){this.a=new Array(i);for(let n=0;n<i;++n)this.a[n]=e.getInt16()}this.n=new Ct(e,Di),this.m=new Ct(e,Yn),this.q=new Ct(e,me),this.e=new Ct(e,me),this.i=e.getFloat(),this.r=e.getFloat(),this.d=e.getFloat(),this.k=e.getInt16(),this.j=e.getInt16(),this.p=new Ct(e,Yn),this.l=new Ct(e,Fo),this.f=e.getInt16()}}class Nu{constructor(e){this.c=e.getInt32(),this.b=e.getUint32(),this.a=e.getUint32()}}class ju{constructor(e){this.h=e.getUint8(),this.j=e.getInt8(),this.l=e.getUint16(),this.f=e.getUint16(),this.g=e.getUint16(),this.a=e.getInt16(),this.i=e.getUint16(),this.e=e.getUint16(),this.k=e.getUint16(),this.d=e.getInt16(),this.b=e.getUint16(),this.c=e.getInt16(),this.m=e.getInt16()}}class Lu{constructor(e){this.g=e.getInt16(),this.i=e.getInt16(),this.e=E(e.getFloat(),e.getFloat(),e.getFloat()),this.f=new Ct(e,Di),this.a=new Ct(e,me),this.b=new Ct(e,Di),this.j=new Ct(e,me),this.c=new Ct(e,me),this.h=new Ct(e,me),this.d=new Ct(e,Fo)}}const zu=class{constructor(t){var e=this;e.e=t.getInt16(),e.c=t.getFloat(),e.d=t.getFloat(),e.a=t.getUint16(),e.b=t.getUint32()}};class Hu{constructor(e){if(this.e=[],this.j=[],this.c=[],this.y=[],this.P=[],this.v=[],this.w=[],this.s=[],this.m=[],this.F=[],this.i=[],this.C=[],this.f=[],this.n=[],this.O=[],this.o=[],this.q=[],this.N=[],this.t=[],this.u=[],this.z=[],this.D=[],this.p=[],this.d=[],this.x=[],this.M=[],this.b=[],this.J=[],this.L=[],this.r=[],this.Q=[],this.A=[],this.l=[],this.E=[],this.G=[],!e)return void console.error("Bad buffer for DataView");let i=new No(e);if(i.getUint32()!=604210112)return void console.log("Bad magic value");if(i.getUint32()<2e3)return void console.log("Bad version");this.h=i.getUint32();var n=i.getUint32(),r=i.getUint32(),o=i.getUint32(),l=i.getUint32(),h=i.getUint32(),d=i.getUint32(),u=i.getUint32(),g=i.getUint32(),b=i.getUint32(),_=i.getUint32(),y=i.getUint32(),I=i.getUint32(),S=i.getUint32(),k=i.getUint32(),U=i.getUint32(),G=i.getUint32(),F=i.getUint32(),P=i.getUint32(),T=i.getUint32(),C=i.getUint32(),N=i.getUint32(),V=i.getUint32(),W=i.getUint32(),J=i.getUint32(),at=i.getUint32(),St=i.getUint32(),Ut=i.getUint32(),vt=i.getUint32(),ee=i.getUint32(),le=i.getUint32(),be=i.getUint32(),ve=i.getUint32(),_e=i.getUint32(),xe=i.getUint32(),Ge=i.getUint32();let Wt=new Uint8Array(e,i.position),ei=null;try{ei=Uu(Wt)}catch(H){return void console.log("Decompression error: "+H)}if(ei.length<Ge)console.log("Unexpected data size",ei.length,Ge);else{i=new No(ei.buffer),i.position=n;var bi=i.getInt32();if(bi>0){this.e=new Array(bi);for(let H=0;H<bi;++H)this.e[H]=new kl(i)}i.position=r;var vi=i.getInt32();if(vi>0){this.j=new Array(vi);for(let H=0;H<vi;++H)this.j[H]=i.getUint16()}i.position=o;var Qi=i.getInt32();if(Qi>0){this.c=new Array(Qi);for(let H=0;H<Qi;++H)this.c[H]=i.getUint32()}i.position=l;var tn=i.getInt32();if(tn>0){this.y=new Array(tn);for(let H=0;H<tn;++H)this.y[H]=new Pu(i)}i.position=h;var en=i.getInt32();if(en>0){this.P=new Array(en);for(let H=0;H<en;++H)this.P[H]=i.getInt16()}i.position=d;var nn=i.getInt32();if(nn>0){this.v=new Array(nn);for(let H=0;H<nn;++H)this.v[H]=new Bl(i)}i.position=u;var Vt=i.getInt32();if(Vt>0){this.w=new Array(Vt);for(let H=0;H<Vt;++H)this.w[H]=i.getInt16()}i.position=g;var $r=i.getInt32();if($r>0){this.s=new Array($r);for(let H=0;H<$r;++H)this.s[H]=i.getInt16()}i.position=b;var Ri=i.getInt32();if(Ri>0){this.m=new Array(Ri);for(let H=0;H<Ri;++H)this.m[H]=new Dl(i)}i.position=_;var Ui=i.getInt32();if(Ui>0){this.F=new Array(Ui);for(let H=0;H<Ui;++H)this.F[H]=new ju(i)}i.position=y;var Se=i.getInt32();if(Se>0){this.i=new Array(Se);for(let H=0;H<Se;++H)this.i[H]=i.getInt16()}i.position=I;var aa=i.getInt32();if(aa>0){this.I=new Array(aa);for(let H=0;H<aa;++H)this.I[H]=new Ua(i)}i.position=S;var ha=i.getInt32();if(ha>0){this.C=new Array(ha);for(let H=0;H<ha;++H)this.C[H]=new Nu(i)}i.position=k;var la=i.getInt32();if(la>0){this.f=new Array(la);for(let H=0;H<la;++H)this.f[H]=i.getInt16()}i.position=U;var ua=i.getInt32();if(ua>0){this.q=new Array(ua);for(let H=0;H<ua;++H)this.q[H]=new Fl(i)}i.position=G;var ca=i.getInt32();if(ca>0){this.N=new Array(ca);for(let H=0;H<ca;++H)this.N[H]=i.getInt16()}i.position=F,this.R=E(i.getFloat(),i.getFloat(),i.getFloat()),this.H=E(i.getFloat(),i.getFloat(),i.getFloat()),this.g=i.getFloat(),this.B=E(i.getFloat(),i.getFloat(),i.getFloat()),this.k=E(i.getFloat(),i.getFloat(),i.getFloat()),this.a=i.getFloat(),i.position=P;var da=i.getInt32();if(da>0){this.n=new Array(da);for(let H=0;H<da;++H)this.n[H]=i.getUint16()}i.position=T;var fa=i.getInt32();if(fa>0){this.O=new Array(fa);for(let H=0;H<fa;++H)this.O[H]=E(i.getFloat(),i.getFloat(),i.getFloat())}i.position=C;var pa=i.getInt32();if(pa>0){this.o=new Array(pa);for(let H=0;H<pa;++H)this.o[H]=E(i.getFloat(),i.getFloat(),i.getFloat())}i.position=N;var ga=i.getInt32();if(ga>0){this.t=new Array(ga);for(let H=0;H<ga;++H)this.t[H]=i.getInt16()}i.position=V;var ma=i.getInt32();if(ma>0){this.u=new Array(ma);for(let H=0;H<ma;++H)this.u[H]=new Il(i)}i.position=W;var ba=i.getInt32();if(ba>0){this.z=new Array(ba);for(let H=0;H<ba;++H)this.z[H]=i.getInt16()}i.position=J;var va=i.getInt32();if(va>0){this.D=new Array(va);for(let H=0;H<va;++H)this.D[H]=new Ol(i)}i.position=at;var _a=i.getInt32();if(_a>0){this.p=new Array(_a);for(let H=0;H<_a;++H)this.p[H]=new Rl(i)}i.position=St;var xa=i.getInt32();if(xa>0){this.d=new Array(xa);for(let H=0;H<xa;++H)this.d[H]=i.getInt16()}i.position=Ut;var ya=i.getInt32();if(ya>0){this.x=new Array(ya);for(let H=0;H<ya;++H)this.x[H]=new Lu(i)}i.position=vt;var Ta=i.getInt32();if(Ta>0){this.M=new Array(Ta);for(let H=0;H<Ta;++H)this.M[H]=new Pl(i)}i.position=le;var Ks=i.getInt32();if(Ks>0){this.J=new Array(Ks);for(let H=0;H<Ks;++H)this.J[H]=new Ul(i)}i.position=be;var Fh=i.getInt32();if(Fh>0){this.L=new Array(Fh);for(let H=0;H<Ks;++H)this.L[H]=i.getInt16()}i.position=ve;var wa=i.getInt32();if(wa>0){this.r=new Array(wa);for(let H=0;H<wa;++H)this.r[H]=new zu(i)}if(_e>0&&(i.position=_e,i.getUint32())){const H=i.position,ic=i.getInt32(),nc=i.getUint32(),rc=i.getInt32(),sc=i.getUint32(),oc=i.getInt32(),ac=i.getUint32(),hc=i.getInt32(),lc=i.getUint32();let uc=i.position;i.position=H+nc;for(let ii=0;ii<ic;ii++)this.Q.push(E(i.getFloat(),i.getFloat(),i.getFloat()));i.position=H+sc;for(let ii=0;ii<rc;ii++)this.A.push(E(i.getFloat(),i.getFloat(),i.getFloat()));i.position=H+ac;for(let ii=0;ii<oc;ii++)this.l.push(i.getUint16());i.position=H+lc;for(let ii=0;ii<hc;ii++)this.E.push(i.getUint16());i.position=uc}if(xe>0&&(i.position=xe,i.getUint32())){this.K=E(i.getFloat(),i.getFloat(),i.getFloat()),this.G=[];for(let H=0;H<5;H++)this.G.push(i.getInt32())}i.position=ee;var Aa=i.getInt32();if(Aa>0){this.b=new Array(Aa);for(let H=0;H<Aa;++H)this.b[H]=new Bu(i)}}}}const Gu=class{constructor(t){this.F=t,this.t=new Float32Array([1,1,1,1]),this.k=!1,this.A=!0,this.u=null,this.o=null,this.h=0,this.e=null,this.n=[],this.j=[],this.D=new Array,this.B=null,this.z=[],this.s=t.l,this.x=t.k,this.v=!1,this.l=!1,this.w=!1,this.C=yt(),this.p=M(),this.y=ki()}r(t){this.u=t;const e=t.c,i=this.F;this.o=e.m[this.F.f],this.h=this.o.d,Ua.c(this);let n=e.f[i.d];i.k==1&&n>-1&&e.C[n].c==1&&(this.s=-1e3,this.x=3);for(let r=0;r<this.x;r++){if(i.d>-1&&i.d<e.f.length){let o=e.f[i.d+r];o>-1&&o<e.C.length&&this.n.splice(r,0,t.aD[o])}if(i.m>-1&&i.m<e.N.length){let o=e.N[i.m+r];o>-1&&e.q&&o<e.q.length?this.j.splice(r,0,e.q[o]):this.j.splice(r,0,null)}if(i.c>-1&&i.c<e.d.length){let o=e.d[i.c+r];o>-1&&o<e.p.length?this.z.splice(r,0,e.p[o]):this.z.splice(r,0,null)}}this.D=new Array(this.j.length);for(let r=0;r<this.D.length;r++)this.D[r]=rt();e.D&&i.a>-1&&i.a<e.D.length&&(this.B=e.D[i.a])}b(){this.u.c;let t=mt(this.o.j[0],this.o.j[1],this.o.j[2],1),e=this.u.aJ[this.o.c].q,i=rt();st(i,i,this.u.aO.viewMatrix),st(i,i,this.u.O),st(i,i,e),ae(t,t,i),t[3]=0;let n=Ao(t);if((3&this.F.h)>0){let r=yt();n>0?Ft(r,t,1/n):Jt(r,t),Ft(r,r,L(E(i[8],i[9],i[10]))*this.o.h),1&this.F.h?Je(r,t,r):Nt(r,t,r),n=Kt(r)}return n}i(){this.u,this.u.aO.context;const t=this.u.r;if(this.C[0]=this.C[1]=this.C[2]=this.C[3]=1,this.B&&this.B.c(t,this.u.C,this.C),this.z[0]&&(this.C[3]*=this.z[0].c(t,this.u.C)),this.C[3]*=this.u.aq[3],!(this.C[3]<=.001)){for(let e=0;e<this.z.length;e++){const i=this.z[e];i&&(this.t[e]=i.c(t,this.u.C))}if(!this.k||this.u.B){const e=this.d();let i=!0;for(const n of e){const r=n.c;i=i&&r!=null}if(this.k=i,!i)return;this.g=this.a(!1,!1),this.f=this.a(!0,!1),this.E=this.a(!1,!0)}this.j.forEach((e,i)=>{if(!this.u.u&&($t(this.D[i]),this.j[i])){let n=!1,r=!1;this.j[i].b&&this.j[i].b.d(t.e.d)?(this.p=this.j[i].b.c(t,this.u.C),r=!0):Y(this.p,0,0,0),this.j[i].c&&this.j[i].c.d(t.e.d)?(this.y=this.j[i].c.c(t,this.u.C),n=!0):Da(this.y,0,0,0,1);let o,l=!1;if(this.j[i].a&&this.j[i].a.d(t.e.d)&&(o=this.j[i].a.c(t,this.u.C),l=!0),$t(this.D[i]),xt(this.D[i],this.D[i],E(.5,.5,0)),l&&At(this.D[i],this.D[i],o),n){let h=rt();zn(h,this.y,[0,0,0]),st(this.D[i],this.D[i],h)}r&&xt(this.D[i],this.D[i],this.p),xt(this.D[i],this.D[i],E(-.5,-.5,0))}}),this.k&&((this.C[3]<1?this.f:this.g).d=this.b())}}q(t,e){if(!this.g)return;const i=this.u.H.o();if(e)i.d(this.E);else{const n=this.g.f.b()<=Wn.GxBlend_AlphaKey,r=this.u.gradientEffect!=null,o=this.C[3]<1;t&&n&&(o||r)?(i.d(this.E),i.d(this.f)):(!t&&n||t&&!n)&&i.d(this.g)}}a(t,e){const i=this,n=t&&i.e.a<2?Wn.GxBlend_Alpha:i.e.a,r=[0,1,2,10,3,4,5,13],o=r[n],l=this.u.H,h=this.u,d=Object.assign(Object.assign({},this.u.R),this.u.ap);for(let b=0;b<this.j.length;b++)d["uTextureMatrix"+(b+1).toString()]=this.D[b];d.uColor=this.C,d.uTexSampleAlpha=this.t,d.uBlendMode=o,d.uHasSpecEmiss=h.az[0]&&h.az[1],d.uHasEmissiveGlowing=h.P,d.uUnlit=this.v?1:0,this.u.gradientEffect&&(d.u_mulLum_OpaqMat=[0,1,0,0]);let u=!this.u.aH;const g=l.d(this.u.I,new Ro(i.l,u,r[n],!0,!i.w,e?0:15),new B(this.s,i.d(),d,this.u.gradientEffect!=null&&n<=2));return l.n(new Uo(h.ai,2*i.o.f,i.o.b),g,this.F.e,this.F.j)}c(){return this.n}d(){const t=[],e=this.u;return this.n.forEach((i,n)=>{let r=null;i&&(this.s==-1e3?e.az?(r=e.az[n],r||(r={c:null,f:!1})):r={c:null,f:!1}:r=i.d.c==0?i.c:i.d.c>0&&this.u.G[i.d.c]?this.u.G[i.d.c]:{c:null,f:!1},r||(this.n[n].e||(WH.debug("can't find texture for material",n,"type",this.n[n].type,"index",this.n[n].f),this.n[n].e=!0),r={c:this.u.aO.greenPixelTexture})),t[n]=r}),t}get show(){return this.A}set show(t){this.A=t}get meshId(){return this.h}m(){this.u=null,this.o=null,this.e=null,this.n=null,this.j=null,this.B=null,this.z=null,this.C=null,this.D=null,this.p=null,this.y=null}};class qu{constructor(e,i){this.d=i,this.f=e,this.c=null,this.e=!1}a(){this.c&&this.c.b(),this.c=null}b(e){this.d.a!=0&&(this.c||(this.c=e.getTexture(this.d.a)))}get type(){return this.d.c}}const Th=function(t,e){const i=Math.abs(t),n=Math.abs(e);return Number((i-Math.floor(i/n)*n).toPrecision(8))*Math.sign(t)},wh="DressingRoom",Ys="Stand";class Wu{constructor(){this.b=null,this.a=-1,this.c=rt(),this.d=1}}class ti{constructor(e,i,n){this.aO=e,this.H=i,this.aA=n,this.ar=!1,this.C=[],this.aH=!1,this.aL=!0,this.x=!0,this.u=!1,this.f=!1,this.r=new ko,this.E=null,this.D=0,this.at=null,this.aC=null,this.G={},this.az=[],this.P=!1,this.B=!1,this.n=1,this.ad=M(),this.af=M(),this.i=null,this.W=null,this.aN=new Set,this.ai=null,this.O=rt(),this.e=rt(),this.aB=rt(),this.au=rt(),this.aq=mt(1,1,1,1),this.N=null,this.ap={},this.L=-1,this.y=!1,this.h=rt(),this.aa=M(),this.J=M(),this.ax=yt(),this.m=yt(),this.ag=!1,this.T=null,this.an=[],this.r.b=0,this.r.e.d=-1,this.as(n)}ao(e){this.an.push(e)}as(e){const i=this.aO.options.contentPath+"mo3/"+e+".mo3";$.ajax({url:i,type:"GET",dataType:"binary",responseType:"arraybuffer",processData:!1,renderer:this.aO,success:n=>{this.aj(n)},error:function(n,r,o){console.log(o)}})}aj(e){this.c=new Hu(e),this.ah()}d(e){this.n=e}ah(){const e=this.c,i=e.C.length,n=e.v.length,r=e.c.length,o=e.M.length,l=e.b.length;this.C=new Array(r);for(let h=0;h<r;++h)this.C[h]=0;if(n>0){this.aJ=new Array(n);for(let h=0;h<n;h++)this.aJ[h]=new ml(this,h,e.v[h]);this.F=new Array(n);for(let h=0;h<n;h++){this.F[h]=[];for(let d=0;d<n;d++)e.v[d].a==h&&this.F[h].push(d)}}this.aD=new Array;for(let h=0;h<i;h++)this.aD[h]=new qu(h,e.C[h]),this.aD[h].b(this.aO);this.Q=new Array(o);for(let h=0;h<o;h++)this.Q[h]=new El(this,e.M[h]),e.J&&e.J.length&&h<e.J.length&&this.Q[h].z(e.J[h]);this.K=new Array(l);for(let h=0;h<l;h++)this.K[h]=new Ml(this,e.b[h]);if(this.E&&this.X(this.E),e.F){const h=e.F.length;this.am=new Array(h);for(let d=0;d<h;++d)this.am[d]=new Gu(e.F[d]),this.am[d].r(this);this.a=this.am.concat()}this.c.e&&e.j&&(this.i=this.H.a(e.e),this.W=this.H.b(e.j.length),this.ai=this.H.f(this.i,this.W),this.W.b(new Uint16Array(e.j))),this.I=this.H.m(e.v.length,e.D.length,e.p.length,e.q.length),this.R={uInvTranspViewModelMat:this.au,uModelMatrix:this.O,uDiffuseColor:this.aq},this.w("Stand");for(let h of this.an)h();this.an=[],Y(this.J,this.n,this.n,this.n),$t(this.O),this.ag&&Ci(this.O,this.O,Math.PI/2),At(this.O,this.O,this.J),this.aO.doUpdateBounds=!0,this.ar=!0}j(){this.ag=!0}A(e){const i=this.c;return i&&i.y&&e>-1&&e<i.y.length?i.y[e].k:e==i.y.length?wh:""}al(){this.w(Ys)}get isMirrored(){return this.ab}set isMirrored(e){this.B=this.ab!=e,this.ab=e}S(e,i,n,r=1){e!=null||n!=null?(this.T||(this.T=new Wu),this.T.b=e,this.T.a=i,n?Ot(this.T.c,n):$t(this.T.c),this.T.d=r,this.aO.doUpdateBounds=!0):this.T=null}aM(){this.aO.context,this.c.e&&this.c.j&&this.L!=this.aO.currFrame&&(this.i&&this.i.dc(this.aJ,this.aN),this.I.a(this.aJ),this.L=this.aO.currFrame)}t(e,i,n){const r=[E(e[0],e[1],e[2]),E(e[0],e[1],i[2]),E(e[0],i[1],e[2]),E(e[0],i[1],i[2]),E(i[0],e[1],e[2]),E(i[0],e[1],i[2]),E(i[0],i[1],e[2]),E(i[0],i[1],i[2])].map(h=>{const d=M();return Fe(d,h,n),d}),o=E(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=E(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);return r.forEach(h=>{Gt(o,o,h),de(l,l,h)}),[o,l]}z(){var e,i,n,r,o,l;if(!this.am)return null;let h=this.ad,d=this.af;return Y(h,9999,9999,999),Y(d,-9999,-9999,-9999),Gt(h,h,(n=(i=(e=this.r)===null||e===void 0?void 0:e.e)===null||i===void 0?void 0:i.a)===null||n===void 0?void 0:n.a),de(d,d,(l=(o=(r=this.r)===null||r===void 0?void 0:r.e)===null||o===void 0?void 0:o.a)===null||l===void 0?void 0:l.e),this.t(h,d,this.O)}k(){const e=this.c;if(!this.ar)return;if(this.T){Y(this.J,this.n,this.n,this.n);const h=this.T.b,d=this.T;if(!h.ar)return;gt(this.J,this.J,d.d),i=this.O,n=this.J,i[0]=n[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=n[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,st(this.O,d.c,this.O),d.a>=0&&d.a<h.aJ.length&&st(this.O,h.aJ[d.a].q,this.O),st(this.O,h.O,this.O)}var i,n;st(this.e,this.aO.viewMatrix,this.O),it(this.aB,this.e),oe(this.au,this.aB),this.gradientEffect&&this.Y();let r=1e3*this.aO.delta;if(!this.u&&this.r.e.d>-1){let h=r;for(let d=0;d<this.C.length;d++)this.C[d]+=h,e.c[d]>0&&(this.C[d]%=e.c[d]);this.aG(this.r,h)}let o=this.am?this.am.length:0;this.aN.clear();for(let h=0;h<o;++h){let d=this.am[h];if(!d.show)continue;let u=d.o.b,g=d.o.f;for(let b=0;b<u;++b)this.aN.add(this.c.j[g+b])}let l=e.v.length;if(this.aJ){for(let h=0;h<l;++h)this.aJ[h].w=!1;for(let h=0;h<l;++h)this.aJ[h].r(r);this.aM()}if(this.am&&this.am.forEach(h=>h.i()),this.a&&this.a.sort(function(h,d){return h.F.j!=d.F.j?h.F.j-d.F.j:h.meshId-d.meshId}),this.B=!1,this.Q&&this.aL)for(let h=0;h<this.Q.length;++h)this.Q[h].W(this.r,this.aO.delta);if(this.K&&this.x)for(let h=0;h<this.K.length;++h)this.K[h].aq(this.r,this.aO.delta),this.K[h].w()}aF(e,i){this.G[e]=i,this.B=!0}s(e,i,n){this.az=[e,i,n],this.B=!0}aw(e){this.P=e}ae(e){this.f=!!e}ac(e){this.aL=!!e}av(e){this.x=!!e}M(e,i){const n=this;if(!n.ar)return;let r=100*i,o=r+Co[i]+e;o=n.am.some(h=>h.meshId==o)?o:100*i+1,n.g(r,r+99,!1),n.g(o,o,!0)}g(e,i,n){const r=this.c;if(!this.am||this.am.length==0)return!1;for(let o=0;o<this.am.length;++o){const l=this.am[o];l.meshId>=e&&l.meshId<=i&&(l.show=n)}if(r.L&&r.L.length>0)for(let o=0;o<r.L.length;++o){let l=r.L[o];l>=e&&l<=i&&(this.Q[o].ap=n)}return!0}l(e,i){if(!this.am)return;const n=i+1;let r=e>0?i+e:e==-2?i+0:n;r=this.am.some(l=>l.meshId==r)||e==-2?r:n,this.g(r,r,!0)}U(e){this.u=e}aE(e){this.c.y&&(this.aI(e,this.r),this.r.a=!1,this.r.e.c=!1,this.r.e.e=0)}aG(e,i){const n=this.c;if(e.e.e+=i,e.d.d<0&&!this.f&&!e.a)if(e.e.a.d>-1){let u=32767*Math.random(),g=0,b=e.e.d,_=n.y[b];for(g+=_.h;g<u&&_.d>-1;)b=_.d,_=n.y[b],g+=_.h;e.d.d=b,e.d.a=n.y[b],e.d.e=0}else{let u=n.y.find(g=>g.i==e.e.a.i&&g.g==0);u&&(e.d.d=u.f,e.d.a=u,e.d.e=0)}let r=e.e,o=e.d,l=r.a.b-r.e,h=0,d=null;if(o.d>-1&&(d=n.y[o.d],h=d.c),h>0&&l<h?(o.e=Th(h-l,d.b),e.b=l/h):e.b=1,e.c>0){let u=i/1e3;e.f.e+=i,e.c-=u/this.aO.crossFadeDuration}if(r.e>=r.a.b)if(o.d>-1&&!r.c){if(o.d>-1)for(;(32&n.y[o.d].l)==0&&(64&n.y[o.d].l)>0&&(o.d=n.y[o.d].f,o.a=n.y[o.d],!(o.d<0)););e.e=o,e.d=new Xn,e.b=1}else r.a.b>0&&(r.e=Th(r.e,r.a.b))}w(e,i=!0){this.aI(e,this.r,i)}aI(e,i,n=!0){const r=this.c;let o=!1,l=!1;const h=e==wh;h&&(e=Ys,this.ae(!0));for(let d=0;d<r.y.length;++d){const u=r.y[d];if(u.k&&u.k==e&&u.g==0){o=!0,n&&i.e!=null&&(i.f!=null&&(i.c=1),i.f=new Xn,i.f.d=i.e.d,i.f.a=i.e.a,i.f.e=i.e.e),l=i.e.d!=d,i.e.d=d,i.e.a=u,i.e.e=0,i.d=new Xn,i.b=0,i.a=h,WH.debug("Set animation to",u.i,u.k);break}}return e==Ys||o?l:this.aI(Ys,i)}ak(e){this.y=e}b(e){const i=this.c;let n=null;if(!i.z||!i.z.length)return null;if(e<i.z.length)n=i.u[i.z[e]];else for(let r=0;r<i.z.length;r++){const o=i.z[r];if(o!=-1){n=i.u[o];break}}return n}get gradientEffect(){return this.N}set gradientEffect(e){this.B=!0,this.N=e,this.v()}q(e){if(!(this.T&&!this.T.b.ar)){if(this.i&&this.a)if(this.gradientEffect){if(e)for(let i=0;i<this.a.length;++i)this.a[i].show&&this.a[i].q(!1,!0);for(let i=0;i<this.a.length;++i)this.a[i].show&&this.a[i].q(e,!1)}else for(let i=0;i<this.a.length;++i)this.a[i].show&&this.a[i].q(e,!1);if(this.Q&&this.aL)for(let i=0;i<this.Q.length;++i)this.Q[i].j(e);if(this.K&&this.x)for(let i=0;i<this.K.length;++i)this.K[i].X(e)}}aK(e){if(this.D==e)return;if(this.ar)for(let r=0;r<this.aJ.length;r++)this.aJ[r].a=null;if(this.D=e,e<=0)return;let i=this.aO.options.contentPath+"bone/"+e+".bone",n=this;$.ajax({url:i,type:"GET",dataType:"binary",responseType:"arraybuffer",processData:!1,renderer:this.aO,success:function(r){n.Z(r)},error:function(r,o,l){console.log(l)}})}Z(e){let i=new No(e);for(i.getInt32();i.position<i.buffer.byteLength;){let n=String.fromCharCode(i.getUint8(),i.getUint8(),i.getUint8(),i.getUint8()),r=i.getUint32();if(n=="BIDA"){let o=r/2;this.at=new Array(o);for(let l=0;l<o;l++)this.at[l]=i.getUint16()}if(n=="BOMT"){let o=r/64;this.aC=new Array(o);for(let l=0;l<o;l++){let h=se(i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat(),i.getFloat());this.aC[l]=h}}}this.ar&&this.ay()}ay(){if(!(this.D<=0)&&this.at&&this.at.length)for(let e=0;e<this.at.length;e++)this.aJ[this.at[e]].a=this.aC[e]}v(){if(!this.gradientEffect)return;const e=this.gradientEffect,i=this.ap;i.u_gradGradientColors_0=[...e.Colors0,0],i.u_gradGradientColors_1=[...e.Colors1,0],i.u_gradGradientColors_2=[...e.Colors2,e.Alpha[0]],i.u_gradEdgeColor=[...e.EdgeColor,e.Alpha[1]],i.u_gradBoundingBox=[this.ax[0],this.ax[1],this.ax[2],1/(this.af[2]-this.ad[2])],i.u_gradUpVec=[this.J[0],this.J[1],this.J[2],0],i.u_gradFlags=[(1&e.gradFlags)>0?1:0,.7,(4&e.gradFlags)>0?1:0,(8&e.gradFlags)>0?1:0]}Y(){if(!this.gradientEffect)return;this.gradientEffect;const e=this.ap;pe(this.ax,this.ad[2],this.ad[2],this.ad[2],1),ae(this.ax,this.ax,this.e),pe(this.m,0,0,1,0),ae(this.m,this.m,this.au),Y(this.J,this.m[0],this.m[1],this.m[2]),Mt(this.J,this.J),e.u_gradBoundingBox[0]=this.ax[0],e.u_gradBoundingBox[1]=this.ax[1],e.u_gradBoundingBox[2]=this.ax[2],e.u_gradBoundingBox[3]=1/(this.af[2]-this.ad[2]),e.u_gradUpVec[0]=this.J[0],e.u_gradUpVec[1]=this.J[1],e.u_gradUpVec[2]=this.J[2]}o(e){let i=bn();if(Is(i,e),this.Q)for(let n=0;n<this.Q.length;n++)this.Q[n].V(e,i);if(this.K)for(let n=0;n<this.K.length;n++)this.K[n].o(e)}p(){return this.T}X(e){if(this.Q)for(let i=0;i<this.Q.length;i++)this.Q[i].v(e);this.E=e}}class Ce{static a(e,i,n){const r=Qh[i];if(r){const o=n?4:0;return r.slice(2*e+o,2*e+o+2)}}static c(e,i,n,r){let o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];if(!e)return WH.debug("selectBestTexture:","textures are null"),null;for(let h=0;h<e.length;h++){let d=e[h],u=d.Gender,g=d.Class,b=d.Race,_=d.ExtraData,y=0;if(i>1||u!=i){if(u<2)continue;y=0}else y=2;let I=1;if(n>0&&g==n)I=0;else if(g>0)continue;let S=1;if(r>0&&b==r)S=0;else if(b>0)continue;o[_+3*(S+2*(y+I))]=d.FileDataId}for(let h=0;h<2;h++)for(let d=0;d<2;d++)for(let u=0;u<2;u++){let g=3*(h+2*(d+2*u));if(o[g]>0){let b;return b={b:o[g],c:o[g+1],a:o[g+2]},b}}const l=Ce.a(i,r,!0);return l&&l[0]!=0?(r=l[0],i=l[1],Ce.c(e,i,n,r)):null}static b(e,i,n,r,o){let l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(let d=0;d<e.length;d++){let u=e[d],g=u.Gender,b=u.Class,_=u.Race,y=u.ExtraData,I=0;if(n>1||g!=n){if(g<2)continue;I=0}else I=2;let S=1;if(r>0&&b==r)S=0;else if(b>0)continue;let k=1;if(o>0&&_==o)k=0;else if(_>0)continue;let U=1;if(i==-1||y!=i){if(y!=-1&&i!=-1)continue}else U=0;l[U+2*(k+2*(I+S))]=u.FileDataId}for(let d=0;d<2;d++)for(let u=0;u<2;u++)for(let g=0;g<2;g++)for(let b=0;b<2;b++){let _=b+2*(d+2*(u+2*g));if(l[_])return l[_]}const h=Ce.a(n,o,!1);return h&&h[0]!=0?(o=h[0],n=h[1],Ce.b(e,i,n,r,o)):0}}class sa{constructor(){this.c=!1,this.f=[]}get loaded(){let e=!!this.d&&this.d.ar;if(e&&this.f.length>0){for(let i of this.f)i();this.f=[]}return e}isLoaded(){return this.loaded}e(e){this.f.push(e)}h(){return this.d}g(e){e.c(this.d,this.c)}getNumAnimations(){var e;return!((e=this.d)===null||e===void 0)&&e.ar?this.d.c.y.length==0?0:this.d.c.y.length+1:0}getAnimation(e){var i;return!((i=this.d)===null||i===void 0)&&i.ar?this.d.A(e):""}resetAnimation(){var e;if(!((e=this.d)===null||e===void 0)&&e.ar)return this.d.al()}setAnimPaused(e){var i;if(!((i=this.d)===null||i===void 0)&&i.ar)return this.d.U(e)}setTPose(e){var i;if(!((i=this.d)===null||i===void 0)&&i.ar)return this.d.ak(e)}setAnimation(e,i){var n;!((n=this.d)===null||n===void 0)&&n.ar&&this.d.w(e,!!i)}setParticlesEnabled(e){var i;!((i=this.d)===null||i===void 0)&&i.ar&&this.d.ac(e)}setRibbonsEnabled(e){var i;!((i=this.d)===null||i===void 0)&&i.ar&&this.d.av(e)}getTexUnits(){var e;return!((e=this.d)===null||e===void 0)&&e.ar?this.d.am:null}setAnimNoSubAnim(e){this.d&&this.d.ae(e)}attachList(e){}setItems(e){}clearSlots(e){}setSheath(e,i){}setAppearance(e){}setShouldersOverride(e){}setCustomizationsLoadedCallback(e){}setModelLoadedCallback(e){throw new Error("Method not implemented.")}setAnimationOverride(e,i){throw new Error("Method not implemented.")}resetAnimationOverride(e){throw new Error("Method not implemented.")}getAnimationDuration(e){throw new Error("Method not implemented.")}getModelBounds(){throw new Error("Method not implemented.")}isRenderReady(){throw new Error("Method not implemented.")}}class Zs extends sa{constructor(e,i,n,r,o,l){super(),this.l=e,this.fe=i,this.k=n,this.j=r,this.hg=o,this.c=l}get fileDataId(){return this.d?this.d.aA:0}get modelInstance(){return this.d}i(e,i,n){this.d&&this.d.S(e,i,n)}dc(e,i){this.d&&this.d.M(e,i)}ba(e,i,n){this.d&&this.d.g(e,i,n)}setParticlesEnabled(e){this.d&&this.d.ac(e)}get winding(){return!!this.d&&this.d.aH}set winding(e){this.d&&(this.d.aH=e)}get isMirrored(){return!!this.d&&this.d.isMirrored}set isMirrored(e){this.d&&(this.d.isMirrored=e)}getBounds(){return this.modelInstance.ar?this.modelInstance.z():[null,null]}a(){this.d&&this.d.k()}b(e){this.d&&this.d.q(e)}}class Xr extends Zs{constructor(e,i,n,r){if(super(e,null,0,0,0,r),this.d=new ti(e,e.renderer,i),n)for(let o in n)n[o]!=0&&this.d.aF(+o,e.getTexture(n[o]))}}class Vu{constructor(){this.a=!1}}const Ah=class{constructor(t,e){this.f=t,this.n=[],this.m=!1,this.k=!1,this.c=e}e(t){for(let e=0;e<this.c.length;e++)this.n[e]&&this.n[e].b&&this.n[e].b.loaded&&this.n[e].b.h().w(t)}a(t){this.m=t}b(){if(this.f.loaded)for(let t=0;t<this.c.length;t++)switch(this.c[t].EffectType){case 1:this.g(t);break;case 2:this.h(t);break;case 6:case 7:case 11:case 12:case 13:break;case 16:this.i(t)}}g(t){let e=this.f.h();if(this.c[t].ProcEffectType==1){let i=this.c[t].Value[0];e.aq=mt((i>>16&255)/255,(i>>8&255)/255,(255&i)/255,e.aq[3])}else if(this.c[t].ProcEffectType==14){let i=Math.min(Math.max(this.c[t].Value[0],0),1);e.aq[3]=i}else if(this.c[t].ProcEffectType==22){let i=this.c[t].Value[3];e.aq=mt((i>>16&255)/255,(i>>8&255)/255,(255&i)/255,e.aq[3])}}h(t){if(!this.f||!this.f.loaded)return;let e=this.f.h();if(!this.n[t]){const k=new Vu;if(this.n[t]=k,this.c[t].ModelType==0){const U=new Xr(e.aO,this.c[t].Model,{2:this.c[t].Texture},!1);k.b=U}else this.c[t].ModelType==1||this.c[t].ModelType==2&&An.b(e.aO,jt.NPC,this.c[t].Model).then(U=>{k.b=U})}const i=this.n[t];if(!i.a){if(!i.b&&!i.c||i.b&&!i.b.loaded||i.c&&!i.c.n)return;let k=this.c[t].AttachmentID;this.c[t].Positioner>-1&&(k=this.c[t].Positioner),k<0&&(k=19);let U=e.b(k);const G=U?U.a:-1;let F=rt();if(U){let P=U.c;xt(F,F,E(P[0],P[1],P[2]))}if(xt(F,F,E(this.c[t].Offset[0],-this.c[t].Offset[1],this.c[t].Offset[2])),Ci(F,F,-this.c[t].Yaw),n=F,r=F,o=this.c[t].Pitch,l=Math.sin(o),h=Math.cos(o),d=r[0],u=r[1],g=r[2],b=r[3],_=r[8],y=r[9],I=r[10],S=r[11],r!==n&&(n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n[0]=d*h-_*l,n[1]=u*h-y*l,n[2]=g*h-I*l,n[3]=b*h-S*l,n[8]=d*l+_*h,n[9]=u*l+y*h,n[10]=g*l+I*h,n[11]=b*l+S*h,Oe(F,F,this.c[t].Roll),At(F,F,[this.c[t].Scale1,this.c[t].Scale1,this.c[t].Scale1]),At(F,F,[this.c[t].Scale2,this.c[t].Scale2,this.c[t].Scale2]),i.b){const P=i.b.h();P.U(this.m),this.c[t].ModelAlpha&&(P.aq[3]=this.c[t].ModelAlpha),P.S(this.f.h(),G,F)}this.n[t].a=!0}var n,r,o,l,h,d,u,g,b,_,y,I,S;this.n[t].b&&this.n[t].b.a(),this.n[t].c&&this.n[t].c.i()}i(t){const e=this.f.h();e.gradientEffect||(e.gradientEffect=this.c[t])}d(t){for(const e of this.n)e&&e.a&&(e.b&&e.b.b(t),e.c&&e.c.e(t))}j(){for(const t of this.n)t&&(t.a=!1,t.b&&t.b.loaded&&t.b.h().S(null,-1,null),t.c&&t.c&&t.c.d())}l(t){this.n.forEach(e=>{e.b&&e.b.g(t),e.c&&e.c.g(t)})}};class Yr extends sa{constructor(e,i){super(),this.o=e,this.B=i,this.u=!1,this.v=!1,this.dc=!1,this.C=-1,this.j=-1,this.n=[],this.s={},this.w=[],this.t=!1,this.A=null,this.fe=0,this.q(i)}q(e){if(!this.t){if(this.o.options,e.StateKit&&this.w.push(new Ah(this,e.StateKit.effects)),e.Creature&&(this.A=e.Creature.CreatureGeosetData,this.fe=e.Creature.CreatureGeosetDataID),e.Model&&(this.d=new ti(this.o,this.o.renderer,e.Model),this.d.j(),e.Creature&&e.Creature.ParticleColor&&this.d.X(e.Creature.ParticleColor),e.Scale&&this.d.d(e.Scale)),this.B.Creature&&this.B.Creature.Texture&&(this.z=this.x(-1,Ce.c(this.B.TextureFiles[this.B.Creature.Texture],3,0,0)),this.d.s(this.z.a,this.z.d,this.z.b)),e.Textures)for(let i in e.Textures)e.Textures[i]!=0&&this.d.aF(+i,this.o.getTexture(e.Textures[i]));this.dc=!0,this.l()}}x(e,i){let n=new ka;return i.b>0&&(n.a=this.o.getTexture(i.b)),i.c>0&&(n.d=this.o.getTexture(i.c)),i.a>0&&(n.b=this.o.getTexture(i.a)),n}l(){this.t||(this.dc=!0,this.z||(this.v=!0))}hg(e){this.p=null,e<=0||(this.u=!1,An.b(this.o,jt.NPC,e).then(i=>{i instanceof Yr&&(this.p=i)}))}i(){this.d,this.p}setAnimation(e,i=!0){this.p&&(this.p.setAnimation(e),e="Mount"),this.d?this.d.w(e,i):this.e(()=>{var n;(n=this.d)===null||n===void 0||n.w(e,i)})}y(){const e=this.d;if(e.g(0,0,!0),this.fe!=0&&(e.g(1,1699,!1),this.A))for(let i of this.A){let n=100*(i.GeosetIndex+1),r=n+i.GeosetValue;e.g(n,n+99,!1),e.g(r,r,!0)}}ba(){this.y()}k(){const e=this.d;e.ar&&this.dc&&e.am&&e.am.length!=0&&(this.ba(),this.dc=!1)}setParticlesEnabled(e){this.d&&this.d.ac(e)}getBounds(){if(this.d&&this.d.ar){const[e,i]=this.d.z();if(this.p&&this.p.loaded&&this.u){const[n,r]=this.p.getBounds();de(n,n,E(0,0,0)),Gt(e,e,n),de(i,i,r)}return[e,i]}return[null,null]}a(){if(!this.t&&this.loaded){if(!this.u&&this.d&&this.p&&this.p.loaded){const e=this.p.d.c,i=e.u[e.z[0]],n=rt();xt(n,n,i.c),this.d.S(this.p.d,i.a,n,1/this.p.d.n),this.d.w("Mount",!1),this.u=!0}this.r&&this.r.a(),this.p&&this.p.a(),this.w&&this.w.forEach(e=>e.b()),this.k(),this.d.k()}}b(e){this.d.q(e),this.p&&this.p.b(e),this.w&&this.w.forEach(i=>i.d(e))}g(e){super.g(e),this.p&&this.p.g(e),this.r&&this.r.g(e),this.w&&this.w.forEach(i=>i.l(e))}}function Eh(t){return new Promise((e,i)=>{$.getJSON(t).done(function(n){e(n)}).fail(function(n,r,o){let l=r+", "+o;console.log("Error loading metadata: "+l),i(r)})})}function oa(t,e,i){let n;return e==jt.HELM?$s(t,1,i):e==jt.SHOULDER?$s(t,3,i):e==jt.ITEM?$s(t,-1,i):(e==jt.NPC||e==jt.HUMANOIDNPC?n="meta/npc/":e==jt.OBJECT?n="meta/object/":e==jt.CHARACTER?n="meta/character/":e==jt.ITEMVISUAL&&(n="meta/itemvisual/"),Eh(t+n+i+".json"))}function $s(t,e,i){let n="meta/item/";return e!=1&&e!=3&&e!=4&&e!=5&&e!=6&&e!=7&&e!=8&&e!=9&&e!=10&&e!=16&&e!=19&&e!=20||(n="meta/armor/"+e+"/"),Eh(t+n+i+".json")}class Js{constructor(){this.e=null,this.d=1,this.c=0,this.b=-1,this.a=!1}}class Xu{constructor(e,i){this.b=e,this.a=i}}class Yu extends Js{constructor(){super(...arguments),this.ba=[]}}class Ch{constructor(e,i){this.a=e,this.b=i}}function Sh(t,e){return t==e||!!t&&!!e&&t.b==e.b&&(t.a==e.a||!!t.a&&!!e.a&&t.a.b==e.a.b&&t.a.a==e.a.a&&t.a.c==e.a.c)}class Zu{constructor(e,i){this.g=e,this.d=[],this.f=i,this.c={},this.a={}}e(){const e=[];for(let r of this.f.Options)for(let o of r.Choices)for(let l of o.Elements)l.SkinnedModel&&e.push(l.SkinnedModel.CollectionFileDataID);const i=new Set(e),n=this.g.o;if(n.renderer,i.size!=0)for(let r of i){const o=new Yu;o.e=new Xr(n,r,{},!0),this.g.ed[r]=o}}h(e){return Ce.c(this.f.TextureFiles[e],this.g.gf,this.g.CB,this.g.kj)}b(e){WH.debug("applyCustomization options",e),this.d=[],this.g.n=[];for(const o in this.g.ed)this.g.ed[o].ba=[];let i=0,n={},r={};for(let o=0;o<e.length;o++){let l=this.f.Options.find(h=>h.Id==e[o].optionId);if(WH.debug("option",l),l){let h=l.Choices.find(d=>d.Id==e[o].choiceId);if(WH.debug("choice",h),h){let d=h.Elements.filter(b=>b.BoneSet&&b.BoneSet.BoneFileDataID&&(b.VariationChoiceID==0||e.some(_=>_.choiceId==b.VariationChoiceID)));d.length>0&&(i=d[0].BoneSet.BoneFileDataID);let u=h.Elements.filter(b=>b.Material&&(b.VariationChoiceID==0||e.some(_=>_.choiceId==b.VariationChoiceID)));u.sort((b,_)=>_.VariationChoiceID-b.VariationChoiceID),u.forEach(b=>{WH.debug("element material",b);let _=this.h(b.Material.MaterialResourcesID);if(!_)return void WH.debug("element material: can't get texture files for material",b);let y=this.f.TextureLayers.find(S=>S.ChrModelTextureTargetID==b.Material.TextureTarget);if(!y)return void WH.debug("element material: can't get texture layer for material",b);const I=new Ch(_,y.TextureType);Sh(I,this.a[b.Material.TextureTarget])?(n[b.Material.TextureTarget]=this.c[b.Material.TextureTarget],r[b.Material.TextureTarget]=this.a[b.Material.TextureTarget]):(n[b.Material.TextureTarget]=this.g.x(y.TextureType,_),r[b.Material.TextureTarget]=I)}),h.Elements.filter(b=>b.Geoset&&(b.VariationChoiceID==0||e.some(_=>_.choiceId==b.VariationChoiceID))).sort((b,_)=>b.Geoset.GeosetType-_.Geoset.GeosetType||b.Geoset.GeosetID-_.Geoset.GeosetID).forEach(b=>{WH.debug("element geoset",b),this.d.push(100*b.Geoset.GeosetType+b.Geoset.GeosetID)}),h.Elements.filter(b=>b.SkinnedModel&&(b.VariationChoiceID==0||e.some(_=>_.choiceId==b.VariationChoiceID))).forEach(b=>{WH.debug("element skinnedmodel",b),b.ChrCustItemGeoModifyID;const _=this.g.ed[b.SkinnedModel.CollectionFileDataID];b.SkinnedModel.GeosetID<100&&_.ba.push(new Xu(100*b.SkinnedModel.GeosetType+b.SkinnedModel.GeosetID,(1&b.SkinnedModel.Flags)>0))});let g=h.Elements.find(b=>b.CondModelFileDataId!=0&&(b.VariationChoiceID==0||e.some(_=>_.choiceId==b.VariationChoiceID)));l.Id!=24&&l.Id!=353||(g&&!this.g.overrideModelFile?this.g.overrideModelFile=g.CondModelFileDataId:!g&&this.g.overrideModelFile&&(this.g.overrideModelFile=0)),h.Elements.filter(b=>b.ChrCustItemGeoModifyID&&(b.VariationChoiceID==0||e.some(_=>_.choiceId==b.VariationChoiceID))).forEach(b=>{WH.debug("element ChrCustItemGeoModify",b),this.g&&this.g.n.push(b.ChrCustItemGeoModifyID)})}}}if(!this.c[10]){let o=this.f.Options.find(l=>l.Id==this.f.HairStyleOptionId);if(o){let l=o.Choices[1];if(l){let h=l.Elements.filter(d=>d.Material&&d.Material.TextureTarget==10&&(d.VariationChoiceID==0||e.some(u=>u.choiceId==d.VariationChoiceID)));if(h.length>0){let d=this.h(h[0].Material.MaterialResourcesID);if(d){const u=new Ch(d,0);Sh(u,this.a[h[0].Material.TextureTarget])?(n[h[0].Material.TextureTarget]=this.c[h[0].Material.TextureTarget],r[h[0].Material.TextureTarget]=this.a[h[0].Material.TextureTarget]):(n[h[0].Material.TextureTarget]=this.g.x(6,d),r[h[0].Material.TextureTarget]=u)}}}}}this.c=n,this.a=r,this.g.h().aK(i),this.g.v=!0}j(){let e=[];for(let i=0;i<this.f.Options.length;i++){let n=this.f.Options[i];if(n){let r=n.Choices[0];r&&e.push({optionId:n.Id,choiceId:r.Id})}}this.b(e)}i(e){let i={options:e,sheathMain:-1,sheathOff:-1};for(let n of this.f.Options)i.options.some(r=>r.optionId==n.Id)||i.options.push({optionId:n.Id,choiceId:n.Choices[0].Id});return i}}class Mh{constructor(){this.c=null,this.a=1,this.b=!1}}const $u=class{constructor(t,e,i){this.e=t,this.f=e,this.k=[],this.g=!1,this.l=[],i&&this.d(i)}b(){}d(t){this.i=t,oa(this.e.l.options.contentPath,jt.ITEMVISUAL,t).then(e=>{this.a(e)})}a(t){if(this.k=new Array(7),t.ItemEffects)for(let i=0;i<t.ItemEffects.length;++i){let n=t.ItemEffects[i];if(n.SubClass==-1||this.f==n.SubClass){if(n.Model){const r=new Mh;this.k[n.Slot-1]=r,r.c=new ti(this.e.l,this.e.l.renderer,n.Model),r.a=n.Scale&&n.Scale!=1?n.Scale:1}if(n.kit){const r=new Ah(this.e,n.kit.effects);this.l.push(r)}}}for(var e=0;e<this.k.length;++e)t.Equipment[e]&&this.k[e]==null&&(this.k[e]=new Mh,this.k[e].c=new ti(this.e.l,this.e.l.renderer,t.Equipment[e]));this.g=!0}c(t){for(let e=0;e<this.k.length;e++){const i=this.k[e];i&&i.b&&i.c.q(t)}}h(t){for(let e=0;e<this.k.length;e++){const i=this.k[e];i&&i.b&&i.c&&i.c.ar&&t.c(i.c,!1)}}m(t,e,i){if(t.b||!i.loaded||!t.c||!t.c.ar)return;const n=i.modelInstance.c;let r=null;if(e<5){if(!n.u[e])return;r=n.u[e]}else r=i.modelInstance.b(19);let o=rt();xt(o,o,r.c),At(o,o,E(t.a,t.a,t.a)),t.c.S(i.modelInstance,r.a,o),t.b=!0}j(){if(this.e.loaded){for(const t of this.l)t&&t.b();for(let t=0;t<this.k.length;t++){const e=this.k[t];e&&(this.m(e,t,this.e),e.c.k())}}}};class kh{constructor(e,i,n){this.j=e,this.C=[],this.n=!1,this.L=null,this.A=[],this.a=rt(),WH.debug("Creating item",n),this.I=i,this.G=n,this.u=e.kj,this.K=e.gf,this.l=e.CB,this.m=Ca[i],this.J=Zh[i],this.k=null,this.f=null,this.c=null,this.y=0,this.v=0,this.n=!1,this.b=!1,this.F=0,this.s=3,this.D=0,n&&this.x()}p(){var e=this;if(e.C){for(let i=0;i<e.C.length;++i)e.C[i]&&(e.C[i].e=null,e.C[i]=null);e.C=null}if(e.k){for(let i=0;i<e.k.length;++i)e.k[i].texture&&e.k[i].texture.b(),e.k[i].texture=null,e.k[i]=null;e.k=null}if(e.f=null,e.c=null,e.A){for(let i=0;i<e.A.length;i++)e.A[i].b();e.A=null}e.n=!1,WH.debug("Destroyed item",this.G)}x(){let e=this,i=this.j.o.options;WH.debug("Loading item",this.G),$s(i.contentPath,this.I,this.G).then(n=>{this.o(n)}).catch(()=>{e.b=!0})}o(e){if(!this.j)return void WH.debug("Char model was destroyed before it was loaded",this.G);const i=this.j.o,n=(i.options,this.K),r=this.u,o=this.l;if(this.v=e.Item.Flags,this.y=e.Item.InventoryType,this.h=e.Item.ItemClass,this.t=e.Item.ItemSubClass,e.ComponentTextures){this.k=[];for(let u in e.ComponentTextures){const g=parseInt(u),b=Ce.c(e.TextureFiles[e.ComponentTextures[u]],n,o,r);if(b){let _;_={region:g,gender:this.K,file:b.b,texture:null},g!=12?_.texture=i.getTexture(b.b):this.I==16&&this.j.h().aF(2,i.getTexture(b.b)),this.k.push(_)}}}this.f=e.Item.GeosetGroup,this.c=e.Item.AttachGeosetGroup,this.D=e.Item.GeosetGroupOverride,this.I==1&&(n==0?this.w=e.Item.HideGeosetMale:this.q=e.Item.HideGeosetFemale);let l=0;if(this.I==3?l=2:Sa[this.I]!=jt.ARMOR&&(l=1),l>0&&e.ComponentModels)for(let u=0;u<l;++u){let g=An.c(i,e,Sa[this.I],this.u,this.K,this.l);if(this.I==3&&g.cba(u+1),g.modelInstance==null)continue;const b=new Js;b.e=g,b.c=u,e.Item&&e.Item.ParticleColor&&b.e.modelInstance.X(e.Item.ParticleColor),this.C.push(b)}if((this.I==6||this.I==16)&&e.ComponentModels){let u=0;if(this.I==16&&(u=1),e.ComponentModels[u]){const g=e.ComponentModels[u],b=Ce.b(e.ModelFiles[g],-1,n,o,r),_=new Js,y=u==0?e.Textures:e.Textures2;_.e=new Xr(i,b,y,!1),this.C=[_]}}const h=this.I;if((h==4||h==5||h==20||h==6||h==7||h==10||h==8||h==1||h==9||h==19||h==16)&&e.ComponentModels){let u=0;if(h!=1&&h!=6||(u=1),e.ComponentModels[u]){const g=e.ComponentModels[u];if(g&&e.ModelFiles&&e.ModelFiles[g]){const b=Ce.b(e.ModelFiles[g],-1,n,o,r);if(b){const _=u==0?e.Textures:e.Textures2;this.L=new Js,this.L.e=new Xr(i,b,_,!0),this.L.e.e(()=>{this.j.dc=!0})}}}}h==7&&this.f[2]>0&&(this.J+=2);const d=this.F!=0?this.F:e.Item.ItemVisual!=0?e.Item.ItemVisual:0;if(d!=0){const u=this.h==2?this.t:-1;for(let g=0;g<this.C.length;g++)this.A.push(new $u(this.C[g].e,u,d))}this.n=!0,WH.debug("Loaded item:","DisplayId",this.G,"InventoryType",this.y),this.j.dc=!0}H(e){for(let i=0;i<this.A.length;i++)this.A[i].b();this.A=[],this.F=e}r(e){this.s=e}z(e){if(this.I==3){const i=e.e.shoulderIndex;if(i==1&&(1&this.s)==0||i==2&&(2&this.s)==0)return!0}return!1}e(e){for(let i=0;i<this.A.length;++i)this.A[i]&&this.A[i].c(e);for(let i=0;i<this.C.length;++i){const n=this.C[i];if(n&&n.e){if(this.z(n))continue;n.e.b(e)}}}d(){if(this.C)for(let e=0;e<this.C.length;++e)this.C[e].a=!1,this.C[e].e&&this.C[e].e.i(null,-1,null);this.L&&(this.L.a=!1)}B(e,i,n){if(!e||!e.e||!e.e.modelInstance.ar)return;const r=e.c;if(r<n.length){let o=i.u[n[r]];if(e.a&&o.a==e.b)return;let l=!1,h=Yh[e.e.fileDataId],d=M(),u=rt();if($t(u),h&&(Y(d,1,1,-1),At(u,u,d),l=!0),this.I!=22&&this.I!=23&&this.m!=22||(256&this.v)==0||(Y(d,1,-1,1),At(u,u,d),l=!0,e.e.isMirrored=!0),e.e.winding=l,this.j.C==5&&this.I==26&&this.h==2&&this.t==18&&($t(u),Oe(u,u,-Math.PI/2)),xt(u,u,o.c),st(u,u,this.a),this.I==27){let g=e.e.fe.Scale;Y(d,g,g,g),At(u,u,d)}e.e.i(this.j.h(),o.a,u),e.a=!0,e.b=o.a}e.a=!0}E(e){Ot(this.a,e);for(let i=0;i<this.C.length;++i)this.C[i].a=!1}i(){if(!this.j.loaded)return;const e=this.j.h().c,i=this.j.on(this.m,this);for(let n=0;n<this.C.length;++n)this.B(this.C[n],e,i),this.A[n]&&this.A[n].j();this.L&&this.j.M(this.L);for(let n=0;n<this.C.length;++n){const r=this.C[n];if(r&&r.e){if(this.z(r))continue;r.e.a()}}}g(e){this.C.forEach(i=>{i.e.g(e)}),this.L&&this.L.e.g(e)}}class Zr extends Yr{constructor(e,i){super(e,i),this.yx=new Map,this.ut=[],this.ed={},this.J=null,e.options.charCustomization&&(this.I=e.options.charCustomization),this.N=new Array(52);for(let n=0;n<52;n++)this.N[n]=100*n+Co[n]}get overrideModelFile(){return this.L}set overrideModelFile(e){const i=this.L;this.L=e,i!=e&&(this.H(),this.F(),this.dc=!0)}H(){let e=this.L?this.L:this.G.Model;this.d=new ti(this.o,this.o.renderer,e),this.d.j(),this.d.aw(this.kj==27||this.kj==30),this.J=null,this.dc=!0}q(e){const i=this.o.options;this.kj=e.Character.Race,this.gf=e.Character.Gender,this.CB=i.cls?i.cls:0;const n=i&&i.items;oa(i.contentPath,jt.CHARACTER,e.Character.ChrModelId).then(r=>{var o,l;this.G=r,this.H(),(o=i.contentPath,l=e.Character.ChrModelId,new Promise((h,d)=>{const u=o+"meta/charactercustomization/"+l+".json";$.getJSON(u,function(g){h(g)})})).then(h=>{var d,u;if(WH.debug("Got customization data v2",h),this.E=new Zu(this,h),(d=this.K)===null||d===void 0||d.call(this,this.E.f),this.E.e(),this.I)this.setAppearance(this.I);else if(e.Character.Race>0&&(!((u=e?.Creature)===null||u===void 0)&&u.CreatureCustomizations)){let g=this.E.i(e.Creature.CreatureCustomizations);this.setAppearance(g)}else this.E.j();this.v&&this.l(),e.Equipment&&this.P(e.Equipment),n&&this.P(n)})}),this.v=!0}F(){for(const[e,i]of this.yx)i.d();for(const e in this.ed)this.ed[e].a=!1;for(const e of this.w)e.j()}ih(e,i,n){if(!this.yx||e==3&&this.ut&&this.ut[0])return;let r=new kh(this,e,i);n&&r.H(n);let o=r.m,l=$h[e];this.yx.get(o)&&l!=0?(r.m=l,this.yx.set(l,r)):this.yx.set(o,r)}D(e){var i=this.yx.get(e);i||(e=Ca[e],i=this.yx.get(e)),i&&(this.yx.delete(e),i.p())}on(e,i){const n=this.d.c,r=[],o={14:l=>[0],26:l=>l.h==2&&l.t==18?[1]:null};if(n.u&&n.z){const l={1:h=>[11],3:h=>[6,5],22:h=>{var d;return((d=o[h.I])===null||d===void 0?void 0:d.call(o,h))||[2]},21:h=>[1],17:h=>[1],15:h=>[2],25:h=>[1],13:h=>[1],14:h=>[0],23:h=>[2],6:h=>[53],26:h=>[1],16:h=>[57],27:h=>[55]};if(l[e]){const h=l[e](i);for(let d=0;d<h.length;++d){let u=h[d];(this.C>=0||this.j>=0||this.p)&&Ma[e]&&(u=Ma[e]),this.C>=0&&e==21&&Vn[this.C][e]&&(u=Vn[this.C][e]),this.j>=0&&e==22&&Vn[this.j][e]&&(u=Vn[this.j][e]),i.y==15&&this.j>=0&&e==22&&Vn[this.j][i.I]&&(u=Vn[this.j][i.I]),u>=n.z.length||n.z[u]==-1||r.push(n.z[u])}}}return r}P(e){if($.isArray(e))for(let i=0;i<e.length;++i)this.ih(e[i][0],e[i][1],e[i][2]);else for(let i in e)this.ih(parseInt(i),e[i]);this.dc=!0,this.Az()}wv(e,i,n){for(const r in this.ed)this.ed[r].e.ba(e,i,n)}ba(){var e;const i=this.d;for(let T=0;T<52;T++)this.N[T]=100*T+Co[T];for(const T of((e=this.E)===null||e===void 0?void 0:e.d)||[])T>=0&&(this.N[Math.floor(T/100)]=T);for(const T in this.ed){const C=this.ed[T].ba,N=this.ed[T].e;N.ba(0,ks,!1);for(const V of C)N.ba(V.b,V.b,!0),this.N[Math.floor(V.b/100)]=V.b}i.g(0,ks,!1),i.g(0,0,!0);for(let T=0;T<this.N.length;T++)i.g(this.N[T],this.N[T],!0);let n=this.yx.get(1),r=this.yx.get(3),o=this.yx.get(4),l=this.yx.get(5),h=this.yx.get(6),d=this.yx.get(7),u=this.yx.get(8),g=this.yx.get(9),b=this.yx.get(10),_=this.yx.get(19),y=this.yx.get(16),I=!1,S=!1;l&&l.f&&l.f[2]?S=!0:d&&d.f&&d.f[2]&&(I=!0);let k=S||I;if(this.yx.forEach(T=>{if(T&&T.n&&T.L){let C=T.L.e.modelInstance;if(!C.ar)return;C.g(0,ks,!1),T.I==1?(C.l(T.f[0],2700),C.l(T.f[1],2100)):T.I==3?C.l(T.f[0],2600):T.I==4?(C.l(T.f[0],800),C.l(T.f[1],1e3)):T.I==5||T.I==20?(b&&b.n&&b.f[0]?C.l(-2,800):C.l(T.f[0],800),C.l(T.f[1],1e3),k&&C.l(T.f[2],1300),C.l(T.f[3],2200),C.l(T.f[4],2800)):T.I==6?C.l(T.f[0],1800):T.I==7?(C.l(T.f[0],1100),C.l(T.f[1],900),k&&C.l(T.f[2],1300)):T.I==8?(C.l(T.f[0],500),C.l(T.f[1],2e3)):T.I==10?(T.f[0]==0&&l&&l.n&&l.f[0]?C.l(-2,400):C.l(T.f[0],400),C.l(T.f[1],2300)):T.I==16?C.l(T.f[0],1500):T.I==19?C.l(T.f[0],1200):T.I==9&&(b&&b.n&&b.f[0]||b?.L!=null||l&&l.n&&l.f[2]&&l.f[0]>0?C.l(-2,2300):C.l(T.f[0],2300))}}),this.ut.forEach(T=>{if(T&&T.L){const C=T.L.e.modelInstance;C.g(0,ks,!1),C.l(T.f[0],2600)}}),this.yx.forEach(T=>{if(T&&T.n&&T.C)for(let C of T.C){if(!C)continue;let N=C.e;T.I==1?(N.dc(T.c[0],27),N.dc(T.c[1],21)):T.I==3?N.dc(T.c[0],26):T.I==4?(N.dc(T.c[0],8),N.dc(T.c[1],10)):T.I==5||T.I==20?(N.dc(T.c[0],8),N.dc(T.c[1],10),N.dc(T.c[2],13),N.dc(T.c[3],22),N.dc(T.c[4],28)):T.I==6?N.dc(T.c[0],18):T.I==7?(N.dc(T.c[0],11),N.dc(T.c[1],9),N.dc(T.c[2],13)):T.I==8?(N.dc(T.c[0],5),N.dc(T.c[1],20)):T.I==10?(N.dc(T.c[0],4),N.dc(T.c[1],23)):T.I==16?N.dc(T.c[0],15):T.I==19?N.dc(T.c[0],12):T.I==9&&N.dc(T.c[0],23)}}),this.ut.forEach(T=>{if(T&&T.C)for(let C of T.C){let N=C.e;N.dc(T.c[0],26),T.D>0&&(N.ba(2600,2699,!1),N.dc(T.D,26))}}),n&&n.n){const T=n.L||n.C[0],C=this.kj,N=this.gf==0?n.w:n.q;if(T&&N){for(let V=0;V<N.length;V++)if(N[V].RaceId==C){const W=N[V].GeosetGroup;if(C==5&&(W==1||W==2))continue;if(W<52)if(W==0)i.g(1,99,!1);else{const J=100*W;i.g(J,J+99,!1)}}}}if(n&&n.C&&n.D>0)for(let T of n.C){let C=T.e;C.ba(2600,2799,!1),C.dc(n.D,27)}if(r&&r.C&&r.D>0)for(let T of r.C){let C=T.e;C.ba(2600,2699,!1),C.dc(r.D,26)}if(h&&h.C&&h.D>0)for(let T of h.C){let C=T.e;C.ba(1800,1899,!1),C.dc(h.D,18)}let U=0;if(_&&(U|=16),b&&b.n&&b.f&&b.f[0]){let T=401+b.f[0];i.g(401,499,!1),i.g(T,T,!0)}else if(l&&l.n&&l.f&&l.f[0]){let T=801+l.f[0];i.g(T,T,!0),b&&b.f&&b.f[0]==0&&(b.J=7,l.J=8,WH.debug("updating sorting for chest/gloves"))}if(!(l||h||g)&&o&&o.n&&o.f&&o.f[0]){let T=801+o.f[0];i.g(T,T,!0)}if(_&&_.n)(1048576&_.v)==0&&(i.g(2200,2299,!1),i.g(2202,2202,!0));else if(l&&l.n&&l.f&&l.f[3]){let T=2201+l.f[3];i.g(2200,2299,!1),i.g(T,T,!0)}let G,F=!1;if(h&&h.n&&h.f&&h.f[0]&&(F=(512&h.v)!=0),S){i.g(501,599,!1),i.g(902,999,!1),i.g(1100,1199,!1),i.g(1300,1399,!1);let T=1301+l.f[2];i.g(T,T,!0)}else if(I){i.g(501,599,!1),i.g(902,999,!1),i.g(1100,1199,!1),i.g(1300,1399,!1);let T=1301+d.f[2];i.g(T,T,!0)}else if(u&&u.n&&u.f&&u.f[0]){i.g(501,599,!1),i.g(901,901,!0);let T=501+u.f[0];i.g(T,T,!0)}else{let T;T=d&&d.n&&d.f&&d.f[1]?901+d.f[1]:901,i.g(T,T,!0)}G=u&&u.n&&u.f&&u.f[1]?2e3+u.f[1]:u&&u.n&&(1048576&u.v)==0?2002:2001,i.g(2001,2099,!1),i.g(G,G,!0);let P=!1;if(!k&&_&&_.n&&_.f&&_.f[0]){let T;P=!1,F?(P=!0,T=1203):(P=!0,T=1201+_.f[0]),i.g(T,T,!0)}else 16&U&&(i.g(1201,1201,!0),k||(i.g(1202,1202,!0),P=!0));if(!P&&!S){if(l&&l.n&&l.f&&l.f[1]){let T=1001+l.f[1];i.g(T,T,!0)}else if(o&&o.n&&o.f&&o.f[1]){let T=1001+o.f[1];i.g(T,T,!0)}}if(!S&&d&&d.n&&d.f&&d.f[0]){let T=d.f[0],C=1101+T,N=i.am.some(V=>V.meshId==C);T>2?(i.g(1300,1399,!1),N?i.g(C,C,!0):i.g(1301,1301,!0)):P||i.g(C,C,!0)}if(_&&_.n&&_.f&&_.f[0]&&this.n.length>0)for(let T of this.n){const C=Ea[T];if(C&&C.GeosetType==12&&C.Original==_.f[0]+1){i.g(1200,1299,!1);let N=1200+C.Override;i.g(N,N,!0);break}}if(y&&y.n&&y.f&&y.f[0]){i.g(1500,1599,!1);let T=1501+y.f[0];if(this.n.length>0)for(let C of this.n){const N=Ea[C];if(N&&N.GeosetType==15&&N.Original==y.f[0]+1){T=1500+N.Override;break}}i.g(T,T,!0)}if(h&&h.n&&h.f&&h.f[0]){i.g(1800,1899,!1);let T=1801+h.f[0];i.g(T,T,!0)}d||S||I||P||F?i.g(1400,1499,!1):i.g(1401,1401,!0)}setParticlesEnabled(e){super.setParticlesEnabled(e),this.yx.forEach(i=>{if(i.C)for(let n=0;n<i.C.length;++n)i.C[n]&&i.C[n].e.setParticlesEnabled(e)})}l(){}O(){if(!this.v)return;let e=!1;if(this.yx.forEach(g=>{if(g.n||g.b){if(g.k){for(let b=0;b<g.k.length;++b)if(g.k[b].texture&&!g.k[b].texture.k())return void(e=!0)}}else e=!0}),e||!this.E)return;const i=this.E.f.Materials,n=this.E.f.TextureLayers,r=this.E.f.TextureSections;let o=!0,l=!0;this.kj!=15&&this.kj!=21||(l=!1),this.yx.forEach(g=>{let b=g.m;b!=4&&b!=5&&b!=19||(o=!1,g.k==null&&(o=!0)),b==7&&(l=!1,g.k==null&&(l=!0))});let h=-1;if(this.kj==27)for(let g of n)g.BlendMode==9&&g.TextureType==1&&g.Layer>h&&(h=g.Layer);const d=(u=g=>g.TextureType,n.reduce((g,b)=>{var _;return(g[_=u(b)]||(g[_]=[])).push(b),g},{}));var u;for(const g in d){const b=d[g];for(const _ of b){const y=this.E.c[_.ChrModelTextureTargetID];if(y&&!y.e())return}}for(const g in d){const b=d[g],_=b[0].TextureType;if(!this.s[g]){const I=i.find(S=>S.TextureType==_);if(!I){WH.debug("unable to find material info",_);continue}this.s[g]=new el(this.o.context,I.Width,I.Height)}const y=this.s[g];y.b();for(const I of b){let S=-1;I.Layer==h&&(S=0);const k=this.E.c[I.ChrModelTextureTargetID];if(!k)continue;const U=I.TextureSection;if(U!=3&&U!=5||o&&U==3||l&&U==5){let G=0,F=0,P=1,T=1;if(U!=-1&&r){const C=r.find(N=>N.SectionType==U);if(!C){WH.debug("can't find texture section data",U);continue}G=C.X,F=C.Y,P=C.Width,T=C.Height}y.m(k,G,F,P,T,I.BlendMode,I.Layer,S)}}_==1&&this.kj!=52&&this.kj!=70&&this.qp(y),_!=26||this.kj!=52&&this.kj!=70||this.qp(y),y.l()}this.sr(this.d);for(let g in this.ed){const b=this.ed[g];b.e&&b.e.loaded&&this.sr(b.e.h())}this.v=!1}sr(e){if(this.s[1]){const i=this.s[1];e.s(i.k(0),i.k(1),i.k(2))}for(let i in this.s)this.s[i],e.aF(i,this.s[i].k(0))}qp(e){const i=[];this.yx.forEach(r=>{i.push(r)}),i.sort(function(r,o){return r.J-o.J});const n=this.E.f.TextureSections;for(let r=0;r<i.length;r++){const o=i[r];if(o.k)for(let l=0;l<o.k.length;l++){const h=o.k[l];if(h.gender==this.gf&&h.texture&&h.texture.k()&&h.region!=12){if((1&this.B.Character.ChrModelFlags)!=0&&h.region==7)continue;const d=n.find(g=>g.SectionType==h.region);if(!d){WH.debug("can't find texture section data",h.region);continue}const u=new ka;u.a=h.texture,e.m(u,d.X,d.Y,d.Width,d.Height,0,-1,-1)}}}}setAppearance(e){var i;this.I=e,this.C=e.sheathMain,this.j=e.sheathOff,(i=this.E)===null||i===void 0||i.b(e.options),this.v=!0,this.dc=!0,this.l(),this.Az()}setCustomizationsLoadedCallback(e){this.K=e}setItems(e){const i=this.o.options;WH.debug("setItems",e);const n=[];for(let r=0;r<e.length;r++)n.push([e[r].slot,e[r].display,e[r].visual]);n.forEach(r=>{const o=[parseInt(r[0]),parseInt(r[1])];i.items.push(o)}),this.P(n),this.v=!0}attachList(e){const i=this.o.options;WH.debug("attachList",e);const n=e.split(","),r=[];for(let o=0;o<n.length;o+=2)r.push([n[o],n[o+1]]);r.forEach(o=>{const l=[parseInt(o[0]),parseInt(o[1])];i.items.push(l)}),this.P(r),this.v=!0}clearSlots(e){const i=this.o.options;WH.debug("clearSlots",e);const n=e.split(",");for(let r=0;r<n.length;++r){this.D(parseInt(n[r]));const o=[];i.items.forEach(l=>{i.items[r].indexOf(parseInt(l))!=0&&o.push(l)}),i.items=o}this.Az(),this.v=!0}setShouldersOverride(e){if(WH.debug("setShouldersOverride",e),!e||e.length!=2)return;for(let n=0;n<2;n++){const r=this.ut[n];r&&r.p(),this.ut[n]=null}for(let n=0;n<2;n++)if(e[n]!=null){const r=new kh(this,3,e[n]);let o=0;o=n==0?1:2,r.r(o),this.ut[n]=r}const i=this.yx.get(3);if(i){let n=3;for(let r=0;r<2;r++)this.ut[r]&&(n&=~(1<<r));i.r(n)}this.ut&&(this.ut[0]||this.ut[1])&&this.D(3)}setSheath(e,i){this.C=e,this.j=i,this.Az()}Az(){if(!this.loaded)return;const e=this.d;let i=(this.j==-1||!this.j)&&this.yx.get(22)!=null,n=!(this.C!=-1&&this.C||this.yx.get(13)==null&&this.yx.get(21)==null);for(let r of Jh){let o=e.c.s[r];o>0&&o<e.aJ.length&&this.d.aJ[o].g(i?"HandsClosed":"")}for(let r of Kh){let o=e.c.s[r];o>0&&o<e.aJ.length&&e.aJ[o].g(n?"HandsClosed":"")}}M(e){const i=this.d;if(!i.ar)return;const n=e.e.modelInstance;if(!n||!n.ar)return;e.a||(n.S(i,-1,null),e.a=!0);let r=n.aJ;if(r){for(let o=0;o<r.length;o++){let l=r[o],h=this.J[l.i.c];if(typeof h!="number")continue;let d=r[o].q,u=i.aJ[h].q;r[o].l=!0,Ot(d,u)}n.k()}}ml(){const e=this.d;let i={};for(let n=0;n<e.aJ.length;n++)i[e.aJ[n].i.c]=n;this.J=i}a(){if(this.d&&this.d.ar){this.J||(this.ml(),this.Az()),super.a();for(const e in this.ed){const i=this.ed[e];this.M(i)}this.yx.forEach(e=>{if(e){if(e.h==2&&e.t==13&&(e.m==21&&this.C!=-1||e.m==22&&this.j!=-1))return;e.i()}}),this.ut.forEach(e=>{e&&e.C&&e.i()}),this.O()}}static cba(e,i){const n=e.e;if(!n.loaded)return;const r=n.modelInstance;!r||!r.ar||r.aJ&&r.q(i)}b(e){if(this.d&&this.d.ar){super.b(e);for(const i in this.ed){const n=this.ed[i];Zr.cba(n,e)}if(this.yx.forEach(i=>{if(i){if(i.h==2&&i.t==13&&(i.m==21&&this.C!=-1||i.m==22&&this.j!=-1))return;i.e(e)}}),this.ut.forEach(i=>{i&&i.C&&i.e(e)}),this.m)for(let i=0;i<this.m.length;i++){let n=this.m[i];n.ar&&n.q(e)}this.yx.forEach(i=>{i&&i.L&&i.L.e&&i.L.a&&Zr.cba(i.L,e)})}}g(e){super.g(e);for(const i in this.ed){const n=this.ed[i];n.a&&n.e&&n.e.loaded&&n.e.g(e)}if(this.yx.forEach(i=>{if(i){if(i.h==2&&i.t==13&&(i.m==21&&this.C!=-1||i.m==22&&this.j!=-1))return;i.g(e)}}),this.ut.forEach(i=>{i&&i.C&&i.g(e)}),this.m)for(let i=0;i<this.m.length;i++){let n=this.m[i];n.ar&&e.c(n,!1)}}}class Ju extends Zs{constructor(e,i,n,r,o,l){super(e,i,n,r,o,l),this.cba()}cba(){let e=this.k;const i=this.j,n=this.hg,r=this.fe;if(r.ComponentModels){let o=r.ComponentModels[0]||r.ComponentModels[1];o&&r.ModelFiles&&r.ModelFiles[o]&&(r.Item.InventoryType==27?this.d=new ti(this.l,this.l.renderer,r.ModelFiles[o][0].FileDataId):this.d=new ti(this.l,this.l.renderer,Ce.b(r.ModelFiles[o],-1,i,n,e)),this.d.j()),this.d&&r.Item.AttachGeosetGroup&&(this.d.M(r.Item.AttachGeosetGroup[0],27),this.d.M(r.Item.AttachGeosetGroup[1],21))}if(r.Textures)for(let o in r.Textures)r.Textures[o]!=0&&this.d.aF(parseInt(o),this.l.getTexture(r.Textures[o]))}}class Ku extends Zs{constructor(e,i,n,r,o,l){super(e,i,n,r,o,l),this.gf=0,this.ed()}get shoulderIndex(){return this.gf}cba(e){this.gf!=e&&(this.gf=e,this.ed())}ed(){this.d=null;let e=this.k;const i=this.j,n=this.hg,r=this.fe;if(r.ComponentModels){let o=r.ComponentModels[0],l=r.ComponentModels[1];if(!o||this.gf!=1&&this.gf!=0){if(l&&(this.gf==2||this.gf==0)&&(l&&r.ModelFiles[l]&&(this.d=new ti(this.l,this.l.renderer,Ce.b(r.ModelFiles[l],1,i,n,e)),this.d.j()),r.Textures2&&this.d))for(let h in r.Textures2)r.Textures2[h]!=0&&this.d.aF(+h,this.l.getTexture(r.Textures2[h]))}else if(o&&r.ModelFiles[o]&&(this.d=new ti(this.l,this.l.renderer,Ce.b(r.ModelFiles[o],0,i,n,e)),this.d.j()),this.d&&r.Textures)for(let h in r.Textures)r.Textures[h]!=0&&this.d.aF(+h,this.l.getTexture(r.Textures[h]))}this.d&&r.Item.AttachGeosetGroup&&this.d.M(r.Item.AttachGeosetGroup[0],26)}a(){this.d.k()}b(e){this.d.q(e)}}class Qu extends Zs{constructor(e,i,n,r,o,l){super(e,i,n,r,o,l),this.cba()}cba(){let e=this.k;const i=this.j,n=this.hg,r=this.fe;if(r.ComponentModels){let o=r.ComponentModels[0];o&&r.ModelFiles&&r.ModelFiles[o]&&(this.d=new ti(this.l,this.l.renderer,Ce.b(r.ModelFiles[o],-1,i,n,e)))}if(this.d&&r.Textures)for(let o in r.Textures)r.Textures[o]!=0&&(this.d.G[+o]=this.l.getTexture(r.Textures[o]))}}class tc extends sa{constructor(e,i){super(),this.ba=e,this.fe=i,this.dc()}dc(){this.d=new ti(this.ba,this.ba.renderer,this.fe.Model),this.d.d(1|this.fe.Scale)}a(){this.d&&this.d.k()}getBounds(){return this.d.ar?this.d.z():[null,null]}b(e){this.d&&this.d.q(e)}}class An{static a(e,i,n){if(i.Character||n==jt.CHARACTER)return new Zr(e,i);if(n==jt.NPC||n==jt.HUMANOIDNPC)return new Yr(e,i);if(n==jt.HELM||n==jt.SHOULDER||n==jt.ITEM)return An.c(e,i,n,1,0,0);if(n==jt.OBJECT)return new tc(e,i);throw"Couldn't create actor"}static c(e,i,n,r,o,l){if(n==jt.HELM)return new Ju(e,i,r,o,l,!1);if(n==jt.SHOULDER)return new Ku(e,i,r,o,l,!1);if(n==jt.ITEM)return new Qu(e,i,r,o,l,!1);throw"Couldn't create item actor"}static b(e,i,n){return i==jt.PATH?new Promise((r,o)=>{r(new Xr(e,n,{},!1))}):oa(e.options.contentPath,i,n).then(r=>An.a(e,r,i))}}const Dh=class{constructor(t){this.currFrame=0,this.clearColor=E(0,0,0),this.addedCss=!1,this.progressShown=!1,this.doUpdateBounds=!1,this.attributeState=new v,this.gxDevice=null,this.textureCache=new Map,this.crossFadeDuration=.3,this.onContextMenu=function(i){return!1};var e=this;e.viewer=t,e.options=t.options,e.downloads={},e.context=null,e.bgImgLoaded=!1,e.width=0,e.height=0,e.time=0,e.delta=0,e.actors=[],e.screenshotDataURL=null,e.makeDataURL=!1,e.screenshotCallback=null,e.azimuth=1.5*Math.PI,e.zenith=Math.PI/2,e.distance=15,e.fov=30,e.zoom={rateStep:.1,rateAccelerationDecay:.4,interpolationRate:.3,range:[.3,4],rateCurrent:0,target:1,current:1},e.zoom.range=e.zoom.range.map(function(i){return Math.log(i)/Math.log(1+e.zoom.rateStep)}),e.translation=E(0,0,0),e.translationFromModel=E(0,0,0),e.target=E(0,0,0),e.eye=E(0,0,0),e.up=E(0,0,1),e.lookDir=M(),e.fullscreen=!1,e.projMatrix=rt(),e.viewMatrix=rt(),e.panningMatrix=rt(),e.viewOffset=M(),this.addedCss||(this.addedCss=!0,$("head").append('<link rel="stylesheet" href="//wow.zamimg.com/modelviewer/viewer/viewer.css" type="text/css" />'))}updateProgress(){if(!this.stop){var t=this,e=0,i=0;for(var n in t.downloads)e+=t.downloads[n].total,i+=t.downloads[n].loaded;if(e<=0)t.progressShown&&(t.progressBg.hide(),t.progressBar.hide(),t.progressShown=!1);else{t.progressShown||(t.progressBg.show(),t.progressBar.show(),t.progressShown=!0);var r=i/e;t.progressBar.width(Math.round(t.width*r)+"px")}}}destroy(){var t=this;t.stop=!0,t.canvas&&(t.canvas.detach(),t.progressBg.detach(),t.progressBar.detach(),t.canvas=t.progressBg=t.progressBar=null),t.clearBackground(),t.actors=[]}method(t,e){if(t==="isBackgroundLoaded")return this.bgImgLoaded;if(t!=="setBackground"){if(this.actors.length>0&&this.actors[0]){const i=this.actors[0][t];return i?i.apply(this.actors[0],e):void WH.debug("Unknown viewer method",t,"args",e)}this.actorPromises.length>0&&this.actorPromises[0]&&(this.actorPromises[0]=this.actorPromises[0].then(i=>{const n=i[t];if(n)return n.apply(i,e),i;WH.debug("Unknown viewer method",t,"args",e)}))}else this.setBackground(e[0])}getTime(){return window.performance&&window.performance.now?window.performance.now():Date.now()}draw(t){var e,i=this,n=i.context;if(i.delta=.001*(t-i.time),i.time=t,i.currFrame++,this.doUpdateBounds&&i.actors.length>0){let[r,o]=[M(),M()];for(e=0;e<i.actors.length;++e){const[S,k]=i.actors[e].getBounds();S&&Gt(r,r,S),k&&de(o,o,k)}const l=M(),h=M();nt(l,o,r),bt(h,r,l,.5);let d=l[2],u=l[0],g=l[1];const b=this.width/this.height,_=2*Math.tan(this.fov/2*.0174532925),y=1.2*d/_,I=1.2*u/(_*b);this.distance=Math.max(Math.max(y,I),2*g),Y(this.translationFromModel,h[0],-h[2],0),this.doUpdateBounds=!1}for(i.updateCamera(),n.bindFramebuffer(n.FRAMEBUFFER,null),n.viewport(0,0,i.width,i.height),n.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],0),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),i.bgTexture&&i.program&&(n.useProgram(i.program),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,i.bgTexture),n.uniform1i(i.uTexture,0),n.uniform4f(i.uBGTransform,i.viewer.options.bgPosition[0]||0,i.viewer.options.bgPosition[1]||0,i.viewer.options.bgScale[0]||1,i.viewer.options.bgScale[1]||1),i.options.backgroundRotatation&&(n.uniform1f(i.uRotation,i.options.backgroundRotatation),n.uniform2f(i.uResolution,i.width,i.height)),n.bindBuffer(n.ARRAY_BUFFER,i.vb),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),n.enableVertexAttribArray(i.aPosition),n.vertexAttribPointer(i.aPosition,2,n.FLOAT,!1,16,0),n.enableVertexAttribArray(i.aTexCoord),n.vertexAttribPointer(i.aTexCoord,2,n.FLOAT,!1,16,8),n.depthMask(!1),n.disable(n.CULL_FACE),n.blendFunc(n.ONE,n.ZERO),n.drawArrays(n.TRIANGLE_STRIP,0,4),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.enable(n.CULL_FACE),n.depthMask(!0),n.disableVertexAttribArray(i.aPosition),n.disableVertexAttribArray(i.aTexCoord)),e=0;e<i.actors.length;++e)i.actors[e].a();for(n.viewport(0,0,i.width,i.height),this.gxDevice.b(),e=0;e<i.actors.length;++e)i.actors[e].b(!1);for(e=0;e<i.actors.length;++e)i.actors[e].b(!0);this.gxDevice.a()}setAdaptiveMode(t){this.addaptiveMode=t,t&&$(window).trigger("resize")}setTranslation(t,e,i){this.translation=E(t,e,i)}setBackground(t){var e=this;e.bgImgLoaded=!1,e.options.background=t,e.clearBackground(),e.loadBackground()}clearBackground(){var t=this;if(t.context){var e=t.context;t.bgTexture&&e.deleteTexture(t.bgTexture),t.bgTexture=null,t.program&&e.deleteProgram(t.program),t.program=null,t.vb&&e.deleteBuffer(t.vb),t.vs&&e.deleteShader(t.vs),t.fs&&e.deleteShader(t.fs),t.vb=t.vs=t.fs=null}t.bgImg&&(t.bgImg=null)}updateCamera(){var t=this;t.zoom.target+=t.zoom.rateCurrent,t.zoom.rateCurrent*=1-t.zoom.rateAccelerationDecay,t.zoom.target=-Math.max(Math.min(-t.zoom.target,t.zoom.range[1]),t.zoom.range[0]),t.zoom.current+=(t.zoom.target-t.zoom.current)*t.zoom.interpolationRate;var e=t.distance*Math.pow(t.zoom.rateStep+1,-t.zoom.current),i=t.azimuth,n=t.zenith;t.up[2]==1?(t.eye[0]=-e*Math.sin(n)*Math.cos(i)+t.target[0],t.eye[1]=-e*Math.sin(n)*Math.sin(i)+t.target[1],t.eye[2]=-e*Math.cos(n)+t.target[2]):(t.eye[0]=-e*Math.sin(n)*Math.cos(i)+t.target[0],t.eye[1]=-e*Math.cos(n)+t.target[1],t.eye[2]=-e*Math.sin(n)*Math.sin(i)+t.target[2]),nt(t.lookDir,t.target,t.eye),Mt(t.lookDir,t.lookDir),function(r,o,l,h){var d,u,g,b,_,y,I,S,k,U,G=o[0],F=o[1],P=o[2],T=h[0],C=h[1],N=h[2],V=l[0],W=l[1],J=l[2];Math.abs(G-V)<A&&Math.abs(F-W)<A&&Math.abs(P-J)<A?$t(r):(I=G-V,S=F-W,k=P-J,d=C*(k*=U=1/Math.hypot(I,S,k))-N*(S*=U),u=N*(I*=U)-T*k,g=T*S-C*I,(U=Math.hypot(d,u,g))?(d*=U=1/U,u*=U,g*=U):(d=0,u=0,g=0),b=S*g-k*u,_=k*d-I*g,y=I*u-S*d,(U=Math.hypot(b,_,y))?(b*=U=1/U,_*=U,y*=U):(b=0,_=0,y=0),r[0]=d,r[1]=b,r[2]=I,r[3]=0,r[4]=u,r[5]=_,r[6]=S,r[7]=0,r[8]=g,r[9]=y,r[10]=k,r[11]=0,r[12]=-(d*G+u*F+g*P),r[13]=-(b*G+_*F+y*P),r[14]=-(I*G+S*F+k*P),r[15]=1)}(t.viewMatrix,t.eye,t.target,t.up),$t(t.panningMatrix),t.up[2]==1?Y(t.viewOffset,t.translation[0],-t.translation[1],0):Y(t.viewOffset,t.translation[0],0,t.translation[1]),tt(t.viewOffset,t.viewOffset,this.translationFromModel),xt(t.panningMatrix,t.panningMatrix,t.viewOffset),st(t.viewMatrix,t.panningMatrix,t.viewMatrix)}init(){var t,e=this,i=e.context;if(this.blackPixelTexture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.blackPixelTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array([0,0,0,255])),i.bindTexture(i.TEXTURE_2D,null),this.greenPixelTexture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.greenPixelTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array([0,255,0,255])),i.bindTexture(i.TEXTURE_2D,null),$e(e.projMatrix,.0174532925*e.fov,e.viewer.aspect,.1,500),e.updateCamera(),i.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],0),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.enable(i.BLEND),e.options.models||e.options.items){e.actorPromises=[];var n=[].concat(e.options.models);if(n.length>0){const r=e.options.mount,o=e.options.shouldersOverride;for(t=0;t<n.length;++t){const l=An.b(this,n[t].type,n[t].id).then(h=>(r&&r.id&&h instanceof Yr&&h.hg(r.id),h instanceof Zr&&h.setShouldersOverride(o),e.actors.push(h),h)).then(h=>h);e.actorPromises.push(l)}}}(function r(){if(!e.stop&&(window.requestAnimationFrame(r),e.gxDevice)){var o=e.getTime();if(e.makeDataURL!==!1){if(e.canvas[0].toDataURL){var l=e.clearColor,h=e.bgTexture;e.options.transparent&&(e.bgTexture=null,e.clearColor=E(0,0,0)),e.draw(o);var d=e.width*e.height*4,u=new Uint8Array(d);i.readPixels(0,0,e.width,e.height,i.RGBA,i.UNSIGNED_BYTE,u);let C=null;e.options.transparent?(e.clearColor=E(1,1,1),e.draw(o),C=new Uint8Array(d),i.readPixels(0,0,e.width,e.height,i.RGBA,i.UNSIGNED_BYTE,C)):C=u;for(var g=new Uint8Array(d),b=0,_=e.height-1;_>=0;_--)for(var y=0;y<e.width;y++){var I=4*(_*e.width+y),S=255-(C[b+0]-u[b+0]),k=u[b+0],U=u[b+1],G=u[b+2];u[b+3],g[I+0]=k,g[I+1]=U,g[I+2]=G,g[I+3]=S,b+=4}var F=document.createElement("canvas"),P=F.getContext("2d");F.width=e.width,F.height=e.height;var T=P.createImageData(e.width,e.height);T.data.set(g),P.putImageData(T,0,0),e.screenshotDataURL=F.toDataURL.apply(F,e.makeDataURL),e.screenshotCallback&&(e.screenshotCallback(),e.screenshotCallback=null),e.clearColor=l,e.bgTexture=h}e.makeDataURL=!1}e.draw(o)}})()}onDoubleClick(t){Le.isFullscreen()?Le.exitFullscreen():Le.requestFullscreen(this.canvas[0])}onFullscreen(t){let e=this;if(e.viewer.container)if(!e.fullscreen&&Le.isFullscreen()||this.addaptiveMode){if(e.restoreWidth=e.width,e.restoreHeight=e.height,e.fullscreen=!0,Le.isFullscreen()){var i=$(window);let r=window.screen.width||i.width(),o=window.screen.height||i.height();this.onResize(r,o,r/o)}else if(this.addaptiveMode){var n=e.viewer.container;this.onResize(n.width(),n.height(),n.width()/n.height())}}else e.fullscreen&&!Le.isFullscreen()&&(e.fullscreen=!1,this.onResize(e.restoreWidth,e.restoreHeight,e.viewer.aspect))}onResize(t,e,i){this.resize(t,e),$e(this.projMatrix,.0174532925*this.fov,i,.1,5e3)}onMouseDown(t){let e=this;t.which==3||t.ctrlKey?e.rightMouseDown=!0:e.mouseDown=!0,t.type=="touchstart"?(e.mouseX=t.originalEvent.touches[0].clientX,e.mouseY=t.originalEvent.touches[0].clientY):(e.mouseX=t.clientX,e.mouseY=t.clientY),$("body").addClass("unselectable"),t.preventDefault()}onMouseWheel(t){if(!this.options.wheelEventValidation||this.options.wheelEventValidation.call(this,t))return this.zoom.rateCurrent+=t.originalEvent.wheelDelta>0?1:-1,t.preventDefault(),!1}onMouseUp(t){let e=this;(e.mouseDown||e.rightMouseDown)&&($("body").removeClass("unselectable"),e.mouseDown=!1,e.rightMouseDown=!1)}onMouseMove(t){let e=this;if((e.mouseDown||e.rightMouseDown)&&e.mouseX!==void 0){var i,n;t.type=="touchmove"?(i=t.originalEvent.touches[0].clientX,n=t.originalEvent.touches[0].clientY):(i=t.clientX,n=t.clientY);var r=(i-e.mouseX)/e.width*Math.PI*2,o=(n-e.mouseY)/e.width*Math.PI*2;if(e.mouseDown){e.up[2]==1?e.azimuth-=r:e.azimuth+=r,e.zenith+=o;for(var l=2*Math.PI;e.azimuth<0;)e.azimuth+=l;for(;e.azimuth>l;)e.azimuth-=l;e.zenith<1e-4&&(e.zenith=1e-4),e.zenith>=Math.PI&&(e.zenith=Math.PI-1e-4)}else e.translation[0]+=r,e.translation[1]+=o;e.mouseX=i,e.mouseY=n,t.stopPropagation()}}resize(t,e){var i=this;if(i.width!==t||i.height!==e){if(i.fullscreen||i.viewer.container.css({height:e+"px",position:"relative"}),i.width=t,i.height=e,i.canvas)i.canvas.attr({width:t,height:e}),i.canvas.css({width:t+"px",height:e+"px"}),i.context.viewport(0,0,i.width,i.height);else{if(i.canvas=$("<canvas/>"),i.canvas.attr({width:t,height:e}),i.viewer.container.append(i.canvas),i.context=i.canvas[0].getContext("webgl",{alpha:!0,premultipliedAlpha:!1})||i.canvas[0].getContext("experimental-webgl",{alpha:!0,premultipliedAlpha:!1}),i.progressBg=$("<div/>",{css:{display:"none",position:"absolute",bottom:0,left:0,right:0,height:"10px",backgroundColor:"#000"}}),i.progressBar=$("<div/>",{css:{display:"none",position:"absolute",bottom:0,left:0,width:0,height:"10px",backgroundColor:"#ccc"}}),i.viewer.container.append(i.progressBg),i.viewer.container.append(i.progressBar),!i.context)return alert("No WebGL support, sorry! You should totally use Chrome."),i.canvas.detach(),void(i.canvas=null);const n=[.35,.35,.35,1],r=[1,1,1,1],o=[.35,.35,.35,1],l=M(),h=M(),d=M();Mt(l,[5,-3,3]),Mt(h,[5,5,5]),Mt(d,[-5,-5,-5]);const u={uCameraPos:i.eye,uViewMatrix:i.viewMatrix,uProjMatrix:i.projMatrix,uAmbientColor:n,uPrimaryColor:r,uSecondaryColor:o,uLightDir1:l,uLightDir2:h,uLightDir3:d};this.gxDevice=new Vh(i.context,u),this.renderer=this.gxDevice.c(),i.canvas.on("mousedown touchstart",i.onMouseDown.bind(i)).on("wheel",i.onMouseWheel.bind(i)).on("dblclick",i.onDoubleClick.bind(i)).on("contextmenu",i.onContextMenu.bind(i));let g=0,b=0,_=0;i.canvas.on("touchend",function(y){const I=y.originalEvent;if(!I||I.changedTouches.length!==1)return;const S=I.changedTouches[0],k=new Date().getTime(),U=k-g,G=S.clientX-b,F=S.clientY-_,P=Math.sqrt(G*G+F*F);g=k,b=S.clientX,_=S.clientY,U<300&&P<30&&(y.preventDefault(),i.onDoubleClick.call(i,I))}),$(window).on("resize",i.onFullscreen.bind(i)),$(document).on("mouseup touchend",i.onMouseUp.bind(i)).on("mousemove touchmove",i.onMouseMove.bind(i)),i.onFullscreen(null)}i.options.background&&i.loadBackground()}}loadBackground(){var t=this,e=t.context;const i=function(){t.vb=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t.vb),e.bufferData(e.ARRAY_BUFFER,new Float32Array(16),e.DYNAMIC_DRAW);var r,o=t.compileShader(e.VERTEX_SHADER,"    attribute vec2 aPosition;    attribute vec2 aTexCoord;        varying vec2 vTexCoord;        void main(void) {        vTexCoord = aTexCoord;        gl_Position = vec4(aPosition, 0, 1);    }    ");r=t.options.backgroundRotatation?t.compileShader(e.FRAGMENT_SHADER,"	precision mediump float;    varying vec2 vTexCoord;    uniform sampler2D uTexture;    uniform vec2 uResolution;    uniform vec4 uBGTransform;    uniform float uRotation;    mat3 getTransform(vec2 pos, vec2 scale, float rotation, vec2 center) {        float c = cos(rotation);        float s = sin(rotation);        return mat3(            scale.x * c, scale.x * s, - scale.x * ( c * center.x + s * center.y ) + center.x + pos.x,            -scale.y * s, scale.y * c, - scale.y * ( - s * center.x + c * center.y ) + center.y + pos.y,            0.0, 0.0, 1.0        );    }    void main(void) {        vec2 uv = gl_FragCoord.xy / uResolution.xy;        mat3 transform = getTransform(uBGTransform.xy, uBGTransform.zw, uRotation, vec2(0.5));        uv = (vec3(uv, 1.0) * transform).xy;        gl_FragColor = texture2D(uTexture, uv);	}"):t.compileShader(e.FRAGMENT_SHADER,"    precision mediump float;    varying vec2 vTexCoord;        uniform sampler2D uTexture;    uniform vec4 uBGTransform;        void main(void) {        gl_FragColor = texture2D(uTexture, vTexCoord.xy * uBGTransform.zw + uBGTransform.xy);    }    ");var l=e.createProgram();e.attachShader(l,o),e.attachShader(l,r),e.linkProgram(l),e.getProgramParameter(l,e.LINK_STATUS)?(t.vs=o,t.fs=r,t.program=l,t.uTexture=e.getUniformLocation(l,"uTexture"),t.aPosition=e.getAttribLocation(l,"aPosition"),t.aTexCoord=e.getAttribLocation(l,"aTexCoord"),t.uBGTransform=e.getUniformLocation(l,"uBGTransform"),t.uRotation=e.getUniformLocation(l,"uRotation"),t.uResolution=e.getUniformLocation(l,"uResolution")):console.error("Error linking shaders")},n=function(){var r=t.width/t.bgImg.width,o=t.height/t.bgImg.height;const l=[-1,-1,0,o,1,-1,r,o,-1,1,0,0,1,1,r,0];e.bindBuffer(e.ARRAY_BUFFER,t.vb),e.bufferSubData(e.ARRAY_BUFFER,0,new Float32Array(l))};t.bgImg?t.bgImg.loaded&&(t.vb||i(),n()):(t.bgImg=new Image,t.bgImg.crossOrigin="",t.bgImg.onload=function(){var r;(r=t.bgImg)===null||r===void 0||(r.loaded=!0),t.bgImg&&(t.bgTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,t.bgTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.bgImg),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),t.vb||i(),n(),t.bgImgLoaded=!0)},t.bgImg.onerror=function(){t.bgImg=null},t.bgImg.src=t.options.contentPath+t.options.background,t.viewer.options.bgPosition=t.options.bgPosition||[0,0],t.viewer.options.bgScale=t.options.bgScale||[1,1])}compileShader(t,e){var i=this.context,n=i.createShader(t);if(i.shaderSource(n,e),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw"Shader compile error: "+i.getShaderInfoLog(n);return n}getTexture(t){if(this.textureCache.has(t)){var e=this.textureCache.get(t);if(e.l||e.c)return e}const i=new Xh(this,t);return this.textureCache.set(t,i),i}},ec=Object.assign(Le,{Tools:D,WebGL:Dh,WEBGL:1,WOW:2,FLASH:2,Wow:{Types:jt}});window.ZamModelViewer=ec})();
